{"version":3,"file":"environment-provider-eeae9a72.js","sources":["../../packages/providers/src/environment-provider.tsx"],"sourcesContent":["import { useSafeLayoutEffect } from '@yamada-ui/utils'\nimport {\n  FC,\n  ReactNode,\n  createContext,\n  useContext,\n  useMemo,\n  useReducer,\n  useRef,\n} from 'react'\n\nexport type Environment = {\n  getWindow: () => Window\n  getDocument: () => Document\n}\n\nconst environment: Environment = {\n  getDocument: () => document,\n  getWindow: () => window,\n}\n\nconst EnvironmentContext = createContext<Environment>(environment)\n\nexport type EnvironmentProviderProps = {\n  children: ReactNode\n  disabled?: boolean\n  environment?: Environment\n}\n\nexport const EnvironmentProvider: FC<EnvironmentProviderProps> = ({\n  children,\n  environment,\n  disabled,\n}) => {\n  const ref = useRef<HTMLSpanElement>(null)\n\n  const context = useMemo<Environment>(() => {\n    if (environment) return environment\n\n    return {\n      getDocument: () => ref.current?.ownerDocument ?? document,\n      getWindow: () => ref.current?.ownerDocument.defaultView ?? window,\n    }\n  }, [environment])\n\n  const enabled = !disabled || !environment\n\n  return (\n    <EnvironmentContext.Provider value={context}>\n      {children}\n\n      {enabled ? <span id='__ui_dev' hidden ref={ref} /> : null}\n    </EnvironmentContext.Provider>\n  )\n}\n\nEnvironmentProvider.displayName = 'EnvironmentProvider'\n\nexport const useEnvironment = ({ isDefer }: { isDefer?: boolean } = {}) => {\n  const [, forceUpdate] = useReducer((c) => c + 1, 0)\n\n  useSafeLayoutEffect(() => {\n    if (!isDefer) return\n\n    forceUpdate()\n  }, [isDefer])\n\n  return useContext(EnvironmentContext)\n}\n"],"names":["environment","EnvironmentContext","createContext","EnvironmentProvider","children","disabled","ref","useRef","context","useMemo","_a","enabled","jsxs","useEnvironment","isDefer","forceUpdate","useReducer","c","useSafeLayoutEffect","useContext"],"mappings":"uIAgBA,MAAMA,EAA2B,CAC/B,YAAa,IAAM,SACnB,UAAW,IAAM,MACnB,EAEMC,EAAqBC,EAAAA,cAA2BF,CAAW,EAQpDG,EAAoD,CAAC,CAChE,SAAAC,EACA,YAAAJ,EACA,SAAAK,CACF,IAAM,CACE,MAAAC,EAAMC,SAAwB,IAAI,EAElCC,EAAUC,EAAAA,QAAqB,IAC/BT,GAEG,CACL,YAAa,IAAM,OAAA,QAAAU,EAAAJ,EAAI,UAAJ,YAAAI,EAAa,gBAAiB,UACjD,UAAW,IAAA,OAAM,QAAAA,EAAAJ,EAAI,UAAJ,YAAAI,EAAa,cAAc,cAAe,OAAA,EAE5D,CAACV,CAAW,CAAC,EAEVW,EAAU,CAACN,GAAY,CAACL,EAE9B,OACGY,EAAAX,EAAmB,SAAnB,CAA4B,MAAOO,EACjC,SAAA,CAAAJ,EAEAO,IAAW,OAAK,CAAA,GAAG,WAAW,OAAM,GAAC,IAAAL,CAAU,CAAA,EAAK,IACvD,CAAA,CAAA,CAEJ,EAEAH,EAAoB,YAAc,sBAE3B,MAAMU,EAAiB,CAAC,CAAE,QAAAC,CAAQ,EAA2B,KAAO,CACnE,KAAA,CAAG,CAAAC,CAAW,EAAIC,aAAYC,GAAMA,EAAI,EAAG,CAAC,EAElD,OAAAC,EAAoB,IAAM,CACnBJ,GAEOC,GAAA,EACX,CAACD,CAAO,CAAC,EAELK,EAAAA,WAAWlB,CAAkB,CACtC"}