import{j as k}from"./jsx-runtime-Nms4Y4qS.js";import{u as De}from"./index-CXXWvYyT.js";import{r as n}from"./index-BwDkhjyp.js";import{c as Oe,a as Re}from"./icon-DBsGF4uC.js";import{f as X}from"./forward-ref-BmTAT9U5.js";import{l as Te,T as Ee,a0 as ke,a1 as Se,R as Ae,s as K,ad as Le,U as Ne,q as He,f as Me,S as Be,a as ce,h as Q,d as ae,y as ye,ah as Ue,V as le,t as Ve,b as W,c as $,j as Ge}from"./factory-CtEVzbYf.js";import{b as Ke}from"./popover-content-KEWUzlYu.js";import{u as We}from"./index-fvg_gLDB.js";import{c as $e}from"./index-DsEil29M.js";import{u as qe}from"./index-CFefAklC.js";import{u as ze}from"./index-ChJj91-k.js";import{u as Ye,f as Je}from"./form-control-v7wnzt3v.js";const Qe=t=>{var a;return Ue(t)&&!!((a=t==null?void 0:t.getAttribute("role"))!=null&&a.startsWith("select-item"))},{DescendantsContextProvider:ht,useDescendantsContext:Ie,useDescendants:Xe,useDescendant:Ze}=$e(),[gt,H]=Te({strict:!1,name:"SelectContext"}),vt=({placeholder:t,closeOnBlur:a=!0,closeOnEsc:c=!0,closeOnSelect:r=!0,placeholderInOptions:i=!0,omitSelectedValues:o=!1,maxSelectValues:p,isEmpty:d,placement:b="bottom-start",duration:g=.2,isOpen:v,defaultIsOpen:_,onOpen:F,onClose:j,optionProps:C,...u})=>{u=Ye(u);const{"aria-readonly":S,...O}=Ee(u,Je),[q,Z]=ke(Ae(u,["value","defaultValue","onChange","aria-readonly"]),Se),l=Xe(),[I,h]=n.useState(-1),[ee,M]=n.useState(!1),V=n.useRef(null),te=n.useRef(null),ie=n.useRef(null),L=n.useRef(new Set([])),[y,z]=We({value:u.value,defaultValue:u.defaultValue,onChange:u.onChange}),[w,G]=n.useState(void 0),B=I>-1,x=K(y),E=(x?!y.length:!y)&&!(t&&i),N=l.values(({node:e})=>x&&y.includes(e.dataset.value??"")).map(({index:e})=>e),A=l.enabledValues(({index:e})=>!N.includes(e)),se=n.useCallback(()=>{const e=setTimeout(()=>{const s=l.enabledFirstValue();if(s)if(!x||!o)h(s.index);else if(N.includes(s.index)){const m=A[0];h(m.index)}else h(s.index)});L.current.add(e)},[l,A,x,o,N]),ne=n.useCallback(()=>{const e=setTimeout(()=>{const s=l.enabledLastValue();if(s)if(!x||!o)h(s.index);else if(N.includes(s.index)){const m=A.reverse()[0];h(m.index)}else h(s.index)});L.current.add(e)},[l,A,x,o,N]),re=n.useCallback(()=>{const e=setTimeout(()=>{const m=l.enabledValues().find(({node:P})=>x?y.includes(P.dataset.value??""):P.dataset.value===y);m&&h(m.index)});L.current.add(e)},[l,x,y]),Y=n.useCallback(()=>{const e=setTimeout(()=>{const s=l.enabledNextValue(I);if(s)if(!x||!o)h(s.index);else if(N.includes(s.index)){const m=A.find(({index:P})=>s.index<P)??A[0];h(m.index)}else h(s.index)});L.current.add(e)},[l,A,I,x,o,N,h]),ue=n.useCallback(()=>{const e=setTimeout(()=>{const s=l.enabledPrevValue(I);if(s)if(!x||!o)h(s.index);else if(N.includes(s.index)){const m=A.reverse().find(({index:P})=>P<s.index)??A[0];h(m.index)}else h(s.index)});L.current.add(e)},[l,A,I,x,o,N,h]),U=E||o?se:re,be=E||o?ne:re,de=n.useCallback((e,s=!0)=>{const m=l.values();if(!m.length)return;const P=m.filter(({node:D})=>D.dataset.value===e).map(({node:D,index:J})=>{if(!(t&&i)||J!==0){const oe=Array.from(D.children).find(xe=>xe.getAttribute("data-label")!==null);return(oe==null?void 0:oe.innerHTML)??""}else return});G(D=>x?(P.forEach(J=>{K(D)&&D.includes(J??"")?s&&(D=K(D)?D.filter(xe=>xe!==J):void 0):D=[...K(D)?D:[],J]}),D):P[0])},[l,x,t,i]),fe=n.useCallback(e=>{z(s=>K(s)?s.includes(e)?s.filter(P=>P!==e):[...s,e]:e),de(e)},[de,z]),Pe=n.useCallback(e=>{e.stopPropagation(),z([]),G(void 0)},[G,z]),{isOpen:f,onOpen:Ce,onClose:R}=qe({isOpen:v,defaultIsOpen:_,onOpen:F,onClose:j}),T=n.useCallback(()=>{O.disabled||O.readOnly||d||ee||Ce()},[O,d,ee,Ce]),pe=n.useCallback(()=>{let e=l.value(I);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const s=e.node.dataset.value??"";fe(s),r&&R(),o&&Y()},[r,l,I,o,fe,R,Y]),he=n.useCallback(()=>{f||(T(),U())},[f,U,T]),ge=n.useCallback(()=>{f||(T(),U())},[f,U,T]),ve=n.useCallback(e=>{const s=Le(e);Ne(V.current,s)||a&&f&&R()},[a,f,R]),_e=n.useCallback(e=>{if(e.key===" "&&(e.key=e.code),O.disabled||O.readOnly)return;const m={ArrowDown:B?()=>Y():f?void 0:le(T,U),ArrowUp:B?()=>ue():f?void 0:le(T,be),Space:B?pe:f?void 0:le(T,U),Enter:B?pe:f?void 0:le(T,U),Home:f?se:void 0,End:f?ne:void 0,Escape:c?R:void 0}[e.key];m&&(e.preventDefault(),e.stopPropagation(),m())},[O.disabled,O.readOnly,B,f,T,U,be,pe,se,ne,c,R,Y,ue]);ze({ref:V,handler:R,enabled:f&&a}),n.useEffect(()=>{if(!x||!o&&He(p))return;const e=y.length>0&&y.length===l.count(),s=y.length===p;e||s?(R(),M(!0)):M(!1)},[o,y,l,x,R,p]),Me(()=>{f||h(-1)},[f]),Be(()=>{L.current.forEach(e=>clearTimeout(e)),L.current.clear()});const Fe=n.useCallback(e=>({matchWidth:!0,...u,...e,isOpen:f,onOpen:T,onClose:R,placement:b,duration:g,trigger:"never",closeOnButton:!1,closeOnBlur:a}),[g,a,R,T,b,u,f]),je=n.useCallback((e={},s=null)=>({ref:ce(V,s),...q,...e,...O,onClick:Q(e.onClick,u.onClick,he),onBlur:Q(e.onBlur,u.onBlur,ve)}),[q,O,ve,he,u]),we=n.useCallback((e={},s=null)=>{var m,P;return{"aria-label":e["aria-label"]??t??`Select ${x?"one or more options.":"an option."}`,role:"combobox",ref:ce(te,s),tabIndex:0,...Z,...e,"data-active":ae(f),"data-placeholder":ae(x?!(w!=null&&w.length):w===void 0),"aria-controls":(m=ie.current)==null?void 0:m.id,"aria-activedescendant":(P=l.value(I))==null?void 0:P.node.id,"aria-expanded":f,onFocus:Q(e.onFocus,u.onFocus,ge),onKeyDown:Q(e.onKeyDown,u.onKeyDown,_e)}},[l,Z,I,f,x,w,t,u,ge,_e]);return{descendants:l,value:y,label:w,focusedIndex:I,placeholder:t,placeholderInOptions:i,omitSelectedValues:o,closeOnSelect:r,isOpen:f,containerRef:V,fieldRef:te,listRef:ie,optionProps:C,formControlProps:O,onChangeLabel:de,onChange:fe,onClear:Pe,onOpen:T,onClose:R,onFocusFirst:se,onFocusLast:ne,onFocusSelected:re,onFocusNext:Y,onFocusPrev:ue,setFocusedIndex:h,getPopoverProps:Fe,getContainerProps:je,getFieldProps:we}},et=()=>{const{listRef:t,focusedIndex:a}=H(),c=Ie(),r=n.useRef(-1),i=c.value(a);n.useEffect(()=>{if(!t.current||!i||r.current===i.index)return;const d=t.current,b=i.node,g=d.clientHeight,v=d.scrollTop,_=v+g,F=b.clientHeight,j=b.offsetTop,C=j+F,u=v<=j&&C<=_,S=r.current<i.index;u||(C<=g?t.current.scrollTo({top:0}):S?t.current.scrollTo({top:C-g}):t.current.scrollTo({top:j+1})),r.current=i.index},[t,i]);const o=n.useId();return{getListProps:n.useCallback((d={},b=null)=>({id:o,as:"ul",ref:ce(t,b),role:"listbox",tabIndex:-1,...d}),[o,t])}},tt=({label:t,...a})=>{const{value:c,omitSelectedValues:r}=H(),i=K(c),o=Ie(),p=o.values(),b=(i&&r?o.values(({node:C})=>c.includes(C.dataset.value??"")):[]).map(({index:C})=>C),v=!p.filter(({node:C,index:u})=>{var S;return((S=C.parentElement)==null?void 0:S.dataset.label)===t&&!b.includes(u)}).length,_=ke(a,Se),F=n.useCallback((C={},u=null)=>{const S={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};return{ref:u,...C,..._[0],style:v?S:void 0}},[_,v]),j=n.useCallback((C={},u=null)=>({"aria-label":C["aria-label"]??t,ref:u,role:"group",...C,..._[1],"data-label":t}),[_,t]);return{label:t,getContainerProps:F,getGroupProps:j}},st=(t,a)=>{const{fieldRef:c,value:r,placeholder:i,placeholderInOptions:o,omitSelectedValues:p,closeOnSelect:d,focusedIndex:b,optionProps:g,onChange:v,onChangeLabel:_,onFocusNext:F,onClose:j,setFocusedIndex:C}=H();let{icon:u,isDisabled:S,isFocusable:O,closeOnSelect:q,children:Z,value:l,...I}={...g,...a};const h=!!S&&!O,ee=n.useRef(null),{index:M,register:V,descendants:te}=Ze({disabled:h}),L=te.values().slice(0,M),y=K(r),w=!(y?!1:L.some(({node:E})=>E.dataset.value===(l??"")))&&(y?r.includes(l??""):(l??"")===r),G=M===b;i&&M>0&&o&&!l&&console.warn(`${y?"MultiSelect":"Select"}: If placeholders are present, All options must be set value. If want to set an empty value, either don't set the placeholder or set 'placeholderInOptions' to false.`);const B=n.useCallback(E=>{if(E.preventDefault(),E.stopPropagation(),S){c.current&&c.current.focus();return}if(!Qe(E.currentTarget)){c.current&&c.current.focus();return}C(M),v(l??""),c.current&&c.current.focus(),(q??d)&&j(),p&&F()},[S,C,M,v,l,c,q,d,j,p,F]);n.useEffect(()=>{w&&_(l??"",!1)},[l,w,_]);const x=n.useCallback((E={})=>{const me={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};return{role:"option",ref:ce(ee,t,V),...I,...E,tabIndex:-1,style:p&&w?me:void 0,"data-value":l??"","data-focus":ae(G),"data-disabled":ae(S),"aria-checked":ye(w),"aria-disabled":ye(S),onClick:Q(I.onClick,E.onClick,B)}},[l,I,S,G,w,p,B,t,V]);return{isSelected:w,isFocused:G,customIcon:u,children:Z,getOptionProps:x}},nt=X(({className:t,children:a,__css:c,...r},i)=>{const{styles:o}=H(),p={position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",cursor:"pointer",...o.icon,...c},b=Ve(a).map(g=>n.cloneElement(g,{focusable:!1,"aria-hidden":!0,style:{maxWidth:"1em",maxHeight:"1em",color:"currentColor"}}));return k.jsx(W.div,{ref:i,className:$("ui-select__icon",t),__css:p,...r,children:Ge(a)?b:k.jsx(Oe,{})})}),_t=({className:t,children:a,...c})=>{const r=n.useRef(null),{styles:i}=H(),o=c.disabled,p=De({ref:r,isDisabled:o,...c});return k.jsx(nt,{"aria-label":"Clear value",className:$("ui-select__clear-icon",t),__css:i.clearIcon,...p,children:a??k.jsx(Re,{w:"0.5em",h:"0.5em"})})},yt=X(({className:t,w:a,width:c,minW:r,minWidth:i,...o},p)=>{var v,_,F,j;const{styles:d}=H(),{getListProps:b}=et();a=a??c??((v=d.list)==null?void 0:v.w)??((_=d.list)==null?void 0:_.width),r=r??i??((F=d.list)==null?void 0:F.minW)??((j=d.list)==null?void 0:j.minWidth);const g={...d.list};return k.jsx(Ke,{className:$("ui-select__list",t),w:a,minW:r,__css:g,...b(o,p)})}),kt=X(({className:t,color:a,h:c,height:r,minH:i,minHeight:o,children:p,...d},b)=>{const{styles:g}=H(),{label:v,getContainerProps:_,getGroupProps:F}=tt(d);return c??(c=r),i??(i=o),k.jsxs(W.li,{className:$("ui-select__item","ui-select__item--group",t),__css:{w:"100%",h:"fit-content",color:a},..._(),children:[k.jsx(W.span,{className:"ui-select__item__group-label",__css:g.groupLabel,lineClamp:1,children:v}),k.jsx(W.ul,{...F({},b),className:"ui-select__item__group",__css:{h:c,minH:i,...g.group},children:p})]})}),St=X(({id:t,className:a,icon:c,...r},i)=>{const{styles:o}=H(),{isSelected:p,customIcon:d,children:b,getOptionProps:g}=st(i,r);t??(t=n.useId()),c??(c=d);const v={textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,gap:"0.75rem",...o.item};return k.jsxs(W.li,{id:t,className:$("ui-select__item",a),__css:v,...g(),children:[c!==null?k.jsx(ot,{opacity:p?1:0,children:c||k.jsx(lt,{})}):null,k.jsx(W.span,{style:{flex:1},"data-label":!0,children:b})]})}),ot=X(({className:t,...a},c)=>{const{styles:r}=H(),i={flexShrink:0,display:"inline-flex",justifyContent:"center",alignItems:"center",fontSize:"0.85em",...r.itemIcon};return k.jsx(W.span,{ref:c,className:$("ui-select__item__icon",t),__css:i,...a})}),lt=()=>k.jsx("svg",{viewBox:"0 0 14 14",width:"1em",height:"1em",children:k.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})});export{St as O,ht as S,kt as a,gt as b,nt as c,yt as d,H as e,_t as f,vt as u};
