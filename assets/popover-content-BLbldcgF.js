import{r as l}from"./index-BwDkhjyp.js";import{j as B}from"./jsx-runtime-Nms4Y4qS.js";import{b as ie}from"./index-D68hVCYc.js";import{u as ue,a as le}from"./index-BRM0DfdX.js";import{u as ce,a as ae,b as fe}from"./index-C3UkXdfd.js";import{u as me,p as pe}from"./index-BOMWt9aZ.js";import{l as de,a as X,h as u,B as ve,a9 as A,U as R,c as Q,t as ge,w as Pe,b as Ce,V as he}from"./factory-CZghEhwx.js";import{a as ye}from"./use-component-style-CVJyvgnb.js";import{o as Be}from"./theme-provider-DVx9I-yC.js";import{M as xe}from"./motion-CvUiUCCo.js";import{s as _}from"./slide-fade-D2OzokzD.js";import{s as be}from"./scale-fade-Cz1crDyK.js";import{C as Re}from"./close-button-BWHSBN7V.js";import{f as W}from"./forward-ref-BmTAT9U5.js";const Xe=[...pe,"isOpen","defaultIsOpen","onOpen","onClose","initialFocusRef","restoreFocus","autoFocus","closeOnBlur","closeOnEsc","closeOnButton","trigger","openDelay","closeDelay","isLazy","lazyBehavior","animation","duration"],[Te,Y]=de({strict:!1,name:"PopoverContext"}),Ye=p=>{const[a,r]=ye("Popover",p),{children:v,initialFocusRef:g,restoreFocus:P=!0,autoFocus:T=!0,closeOnBlur:f=!0,closeOnEsc:k=!0,closeOnButton:D=!0,trigger:c="click",openDelay:O=200,closeDelay:x=200,isLazy:L,lazyBehavior:V="unmount",animation:z="scale",duration:M,relatedRef:C,...S}=Be(r),{isOpen:t,onOpen:b,onClose:s,onToggle:I}=ue(r),F=l.useRef(null),e=l.useRef(null),m=l.useRef(null),{present:Z,onAnimationComplete:$}=ie({isOpen:t,ref:m}),h=l.useRef(void 0),K=l.useRef(void 0),w=l.useRef(!1),N=l.useRef(!1);t&&(N.current=!0);const{referenceRef:j,getPopperProps:ee,forceUpdate:H,transformOrigin:U}=me({...S,enabled:t});l.useEffect(()=>()=>{h.current&&clearTimeout(h.current),K.current&&clearTimeout(K.current)},[]),ce({enabled:t,ref:e}),ae(m,{focusRef:e,visible:t,shouldFocus:P&&(c==="click"||c==="contextmenu")}),fe(m,{focusRef:g,visible:t,shouldFocus:T&&(c==="click"||c==="contextmenu")});const q=le({wasSelected:N.current,enabled:L,mode:V,isSelected:Z}),oe=l.useCallback((o={},E=null)=>{const i={...o,style:{...o.style,transformOrigin:U},ref:X(m,E),children:q?o.children:null,tabIndex:-1,onKeyDown:u(o.onKeyDown,n=>{k&&n.key==="Escape"&&s()}),onBlur:u(o.onBlur,n=>{const d=A(n),y=R(m.current,d),re=R(e.current,d),se=C!=null&&C.current?R(C.current,d):!1;t&&f&&(!y&&!re&&!se)&&s()})};return c==="hover"&&(i.onMouseEnter=u(o.onMouseEnter,()=>{w.current=!0}),i.onMouseLeave=u(o.onMouseLeave,n=>{n.nativeEvent.relatedTarget!==null&&(w.current=!1,f&&setTimeout(s,x))})),i},[x,f,k,t,s,q,U,c,C]),G=l.useCallback(o=>{F.current==null&&j(o)},[j]),te=l.useCallback((o={},E=null)=>{const i={...o,ref:X(e,E,G)};return c==="click"&&(i.onClick=u(o.onClick,I),i.onBlur=u(o.onBlur,n=>{const d=A(n),y=!R(m.current,d);t&&f&&y&&s()})),c==="contextmenu"&&(i.onContextMenu=u(o.onContextMenu,n=>{n.preventDefault(),b()}),i.onBlur=u(o.onBlur,n=>{const d=A(n),y=!R(m.current,d);t&&f&&y&&s()})),c==="hover"&&(i.onFocus=u(o.onFocus,()=>{h.current===void 0&&b()}),i.onBlur=u(o.onBlur,n=>{const d=A(n),y=!R(m.current,d);t&&f&&y&&s()}),i.onKeyDown=u(o.onKeyDown,n=>{n.key==="Escape"&&s()}),i.onMouseEnter=u(o.onMouseEnter,()=>{w.current=!0,h.current=window.setTimeout(b,O)}),i.onMouseLeave=u(o.onMouseLeave,()=>{w.current=!1,h.current&&(clearTimeout(h.current),h.current=void 0),K.current=window.setTimeout(()=>{w.current||s()},x)})),i},[x,f,t,G,s,b,I,O,c]),ne=l.useCallback((o={},E=null)=>({...o,ref:X(E,F,j)}),[F,j]);return B.jsx(Te,{value:{isOpen:t,onClose:s,closeOnButton:D,onAnimationComplete:$,forceUpdate:H,getTriggerProps:te,getAnchorProps:ne,getPopperProps:ee,getPopoverProps:oe,animation:z,duration:M,styles:a},children:ve(v,{isOpen:t,onClose:s,forceUpdate:H})})},Ne=({children:p})=>{const a=l.Children.only(p),{getTriggerProps:r}=Y();return l.cloneElement(a,r(a.props,a.ref))},J=W(({onClick:p,...a},r)=>{const{styles:v,onClose:g}=Y(),P={position:"absolute",...v.closeButton};return B.jsx(Re,{ref:r,className:Q("ui-popover__close-button"),__css:P,onClick:u(p,T=>{T.stopPropagation(),g==null||g()}),size:"sm",...a})}),Oe=(p="scale",a)=>{const r={reverse:!0,duration:a,enter:{visibility:"visible"},transitionEnd:{exit:{visibility:"hidden"}}};switch(p){case"scale":return{...be,custom:{...r,scale:.95}};case"top":return{..._,custom:{...r,offsetX:0,offsetY:-16}};case"right":return{..._,custom:{...r,offsetX:16,offsetY:0}};case"left":return{..._,custom:{...r,offsetX:-16,offsetY:0}};case"bottom":return{..._,custom:{...r,offsetX:0,offsetY:16}}}},He=W(({className:p,children:a,w:r,width:v,minW:g,minWidth:P,z:T,zIndex:f,__css:k,...D},c)=>{const{isOpen:O,closeOnButton:x,getPopperProps:L,getPopoverProps:V,onAnimationComplete:z,animation:M,duration:C,styles:S}=Y(),t=ge(a),[b,...s]=Pe(t,J),F={...D,children:B.jsxs(B.Fragment,{children:[b??(x?B.jsx(J,{}):null),s]})},e=k??S.container??{},m={position:"relative",w:"100%",display:"flex",flexDirection:"column",outline:0,...e};return v??(v=r),v??(v=(e==null?void 0:e.width)??(e==null?void 0:e.w)),P??(P=g),P??(P=(e==null?void 0:e.minWidth)??(e==null?void 0:e.minW)),f??(f=T),f??(f=(e==null?void 0:e.zIndex)??(e==null?void 0:e.z)),B.jsx(Ce.div,{...L({style:{visibility:O?"visible":"hidden"}}),className:"ui-popover",width:v,minWidth:P,zIndex:f,children:B.jsx(xe,{as:"section",className:Q("ui-popover__content",p),...M!=="none"?Oe(M,C):{},...V(F,c),initial:"exit",animate:O?"enter":"exit",exit:"exit",onAnimationComplete:he(z,D.onAnimationComplete),__css:m})})});export{Ye as P,Ne as a,He as b,J as c,Xe as p,Y as u};
