{"version":3,"file":"tooltip-5941e4cc.js","sources":["../../packages/components/tooltip/src/tooltip.tsx"],"sourcesContent":["import {\n  ui,\n  forwardRef,\n  omitThemeProps,\n  CSSUIObject,\n  HTMLUIProps,\n  ThemeProps,\n  useComponentStyle,\n  CSSUIProps,\n} from \"@yamada-ui/core\"\nimport {\n  motion,\n  HTMLMotionProps,\n  AnimatePresence,\n  MotionTransitionProperties,\n} from \"@yamada-ui/motion\"\nimport { Portal, PortalProps } from \"@yamada-ui/portal\"\nimport { scaleFadeProps, slideFadeProps } from \"@yamada-ui/transitions\"\nimport { useDisclosure } from \"@yamada-ui/use-disclosure\"\nimport { useEventListener } from \"@yamada-ui/use-event-listener\"\nimport { UsePopperProps, usePopper } from \"@yamada-ui/use-popper\"\nimport {\n  cx,\n  handlerAll,\n  PropGetter,\n  mergeRefs,\n  getOwnerWindow,\n  getOwnerDocument,\n  omitObject,\n} from \"@yamada-ui/utils\"\nimport {\n  Children,\n  ReactNode,\n  cloneElement,\n  useCallback,\n  useEffect,\n  useRef,\n} from \"react\"\n\ntype TooltipOptions = {\n  /**\n   * The label of the tooltip.\n   */\n  label?: ReactNode\n  /**\n   * If `true`, the tooltip will be shown.\n   */\n  isOpen?: boolean\n  /**\n   * If `true`, the tooltip will be initially shown.\n   */\n  defaultIsOpen?: boolean\n  /**\n   * Callback to run when the tooltip shows.\n   */\n  onOpen?: () => void\n  /**\n   * Callback to run when the tooltip hides.\n   */\n  onClose?: () => void\n  /**\n   * If `true`, the tooltip will be disabled.\n   *\n   * @default false\n   */\n  isDisabled?: boolean\n  /**\n   * The delay before showing the tooltip.\n   *\n   * @default 0\n   */\n  openDelay?: number\n  /**\n   * The delay before hiding the tooltip.\n   *\n   * @default 0\n   */\n  closeDelay?: number\n  /**\n   * If `true`, the tooltip will hide on click.\n   *\n   * @default true\n   */\n  closeOnClick?: boolean\n  /**\n   * If `true`, the tooltip will hide on scroll.\n   *\n   * @default false\n   */\n  closeOnScroll?: boolean\n  /**\n   * If `true`, the tooltip will hide while the mouse is down.\n   *\n   * @default false\n   */\n  closeOnMouseDown?: boolean\n  /**\n   * If `true`, the tooltip will hide while the pointer is down.\n   *\n   * @default false\n   */\n  closeOnPointerDown?: boolean\n  /**\n   * If `true`, the tooltip will hide on pressing Esc key.\n   *\n   * @default true\n   */\n  closeOnEsc?: boolean\n  /**\n   * The animation of the tooltip.\n   *\n   * @default 'scale'\n   */\n  animation?: \"scale\" | \"top\" | \"right\" | \"left\" | \"bottom\" | \"none\"\n  /**\n   * The animation duration.\n   */\n  duration?: MotionTransitionProperties[\"duration\"]\n  /**\n   * Props for portal component.\n   */\n  portalProps?: Pick<PortalProps, \"appendToParentPortal\" | \"containerRef\">\n  /**\n   * If `true`, the element will be transported to the end of document.body.\n   */\n  withPortal?: boolean\n}\n\nexport type TooltipProps = HTMLUIProps<\"div\"> &\n  ThemeProps<\"Tooltip\"> &\n  Omit<HTMLMotionProps<\"div\">, \"color\" | \"style\" | \"variants\" | \"transition\"> &\n  Pick<UsePopperProps, \"modifiers\" | \"gutter\" | \"offset\" | \"placement\"> &\n  TooltipOptions\n\nconst getTooltipProps = (\n  animation: TooltipProps[\"animation\"] = \"scale\",\n  duration?: TooltipProps[\"duration\"],\n) => {\n  const custom = {\n    reverse: true,\n    duration,\n    enter: { visibility: \"visible\" },\n    transitionEnd: { exit: { visibility: \"hidden\" } },\n  }\n\n  switch (animation) {\n    case \"scale\":\n      return {\n        ...scaleFadeProps,\n        custom: { ...custom, scale: 0.95 },\n      }\n    case \"top\":\n      return {\n        ...slideFadeProps,\n        custom: { ...custom, offsetY: -16 },\n      }\n    case \"right\":\n      return {\n        ...slideFadeProps,\n        custom: { ...custom, offsetX: 16 },\n      }\n    case \"left\":\n      return {\n        ...slideFadeProps,\n        custom: { ...custom, offsetX: -16 },\n      }\n    case \"bottom\":\n      return {\n        ...slideFadeProps,\n        custom: { ...custom, offsetY: 16 },\n      }\n  }\n}\n\nexport const Tooltip = forwardRef<TooltipProps, \"div\">(\n  (\n    { closeOnPointerDown, zIndex, portalProps, withPortal = true, ...props },\n    ref,\n  ) => {\n    const [styles, mergedProps] = useComponentStyle(\"Tooltip\", props)\n    const {\n      className,\n      children,\n      label,\n      placement,\n      modifiers,\n      gutter,\n      offset,\n      openDelay = 0,\n      closeDelay = 0,\n      isDisabled,\n      closeOnClick = true,\n      closeOnScroll,\n      closeOnMouseDown,\n      closeOnEsc = true,\n      animation,\n      duration,\n      ...rest\n    } = omitThemeProps(mergedProps)\n\n    closeOnPointerDown = closeOnMouseDown\n\n    const { isOpen, onOpen, onClose } = useDisclosure(rest)\n\n    const triggerRef = useRef<HTMLElement>(null)\n\n    const openTimeout = useRef<number>()\n    const closeTimeout = useRef<number>()\n\n    const { referenceRef, getPopperProps, transformOrigin } = usePopper({\n      enabled: isOpen,\n      placement,\n      modifiers,\n      gutter,\n      offset,\n    })\n\n    const closeNow = useCallback(() => {\n      if (closeTimeout.current) {\n        clearTimeout(closeTimeout.current)\n\n        closeTimeout.current = undefined\n      }\n\n      onClose()\n    }, [onClose])\n\n    const openWithDelay = useCallback(() => {\n      if (!isDisabled && !openTimeout.current) {\n        closeNow()\n\n        const win = getOwnerWindow(triggerRef.current)\n\n        openTimeout.current = win.setTimeout(onOpen, openDelay)\n      }\n    }, [isDisabled, openDelay, closeNow, onOpen])\n\n    const closeWithDelay = useCallback(() => {\n      if (openTimeout.current) {\n        clearTimeout(openTimeout.current)\n\n        openTimeout.current = undefined\n      }\n\n      const win = getOwnerWindow(triggerRef.current)\n\n      closeTimeout.current = win.setTimeout(closeNow, closeDelay)\n    }, [closeDelay, closeNow])\n\n    const onClick = useCallback(\n      () => (isOpen && closeOnClick ? closeWithDelay() : undefined),\n      [isOpen, closeOnClick, closeWithDelay],\n    )\n\n    const onPointerDown = useCallback(\n      () => (isOpen && closeOnPointerDown ? closeWithDelay() : undefined),\n      [isOpen, closeOnPointerDown, closeWithDelay],\n    )\n\n    const onKeyDown = useCallback(\n      (ev: KeyboardEvent) =>\n        isOpen && ev.key === \"Escape\" ? closeWithDelay() : undefined,\n      [isOpen, closeWithDelay],\n    )\n\n    useEventListener(\n      () => getOwnerDocument(triggerRef.current),\n      \"keydown\",\n      (ev) => (closeOnEsc ? onKeyDown(ev) : undefined),\n    )\n\n    useEventListener(\n      () => getOwnerDocument(triggerRef.current),\n      \"scroll\",\n      () => (isOpen && closeOnScroll ? closeNow() : undefined),\n    )\n\n    useEventListener(() => triggerRef.current, \"pointerleave\", closeWithDelay)\n\n    useEffect(\n      () => () => {\n        clearTimeout(openTimeout.current)\n        clearTimeout(closeTimeout.current)\n      },\n      [],\n    )\n\n    const getTriggerProps: PropGetter = useCallback(\n      (props = {}, ref = null) => ({\n        ...props,\n        ref: mergeRefs(triggerRef, ref, referenceRef),\n        onPointerEnter: handlerAll(props.onPointerEnter, (e) =>\n          e.pointerType !== \"touch\" ? openWithDelay() : undefined,\n        ),\n        onClick: handlerAll(props.onClick, onClick),\n        onPointerDown: handlerAll(props.onPointerDown, onPointerDown),\n        onFocus: handlerAll(props.onFocus, openWithDelay),\n        onBlur: handlerAll(props.onBlur, closeWithDelay),\n      }),\n\n      [referenceRef, onClick, onPointerDown, openWithDelay, closeWithDelay],\n    )\n\n    const child = Children.only(children) as React.ReactElement & {\n      ref?: React.Ref<any>\n    }\n    const trigger = cloneElement(child, getTriggerProps(child.props, child.ref))\n\n    const css: CSSUIObject = {\n      position: \"relative\",\n      ...omitObject(styles, [\"zIndex\"]),\n    }\n\n    if (!label) return <>{children}</>\n\n    return (\n      <>\n        {trigger}\n\n        <AnimatePresence>\n          {isOpen ? (\n            <Portal isDisabled={!withPortal} {...portalProps}>\n              <ui.div\n                {...getPopperProps()}\n                zIndex={(zIndex ?? styles.zIndex) as CSSUIProps[\"zIndex\"]}\n                pointerEvents=\"none\"\n              >\n                <ui.div\n                  as={motion.div}\n                  ref={ref}\n                  className={cx(\"ui-tooltip\", className)}\n                  style={{ transformOrigin }}\n                  {...(animation !== \"none\"\n                    ? getTooltipProps(animation, duration)\n                    : {})}\n                  initial=\"exit\"\n                  animate={isOpen ? \"enter\" : \"exit\"}\n                  exit=\"exit\"\n                  __css={css}\n                  {...omitObject(rest, [\n                    \"isOpen\",\n                    \"defaultIsOpen\",\n                    \"onOpen\",\n                    \"onClose\",\n                  ])}\n                >\n                  {label}\n                </ui.div>\n              </ui.div>\n            </Portal>\n          ) : null}\n        </AnimatePresence>\n      </>\n    )\n  },\n)\n"],"names":["getTooltipProps","animation","duration","custom","scaleFadeProps","slideFadeProps","Tooltip","forwardRef","closeOnPointerDown","zIndex","portalProps","withPortal","props","ref","styles","mergedProps","useComponentStyle","className","children","label","placement","modifiers","gutter","offset","openDelay","closeDelay","isDisabled","closeOnClick","closeOnScroll","closeOnMouseDown","closeOnEsc","rest","omitThemeProps","isOpen","onOpen","onClose","useDisclosure","triggerRef","useRef","openTimeout","closeTimeout","referenceRef","getPopperProps","transformOrigin","usePopper","closeNow","useCallback","openWithDelay","win","getOwnerWindow","closeWithDelay","onClick","onPointerDown","onKeyDown","ev","useEventListener","getOwnerDocument","useEffect","getTriggerProps","mergeRefs","handlerAll","e","child","Children","trigger","cloneElement","css","omitObject","jsxs","Fragment","jsx","AnimatePresence","Portal","ui","motion","cx"],"mappings":"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"}