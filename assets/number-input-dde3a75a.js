import{j as w,a as Ie}from"./jsx-runtime-29545a09.js";import{r as s}from"./index-76fb7be0.js";import{t as Ee,a as Ne,c as Ae}from"./number-cdadea8f.js";import{c as O,v as S,h as Me,f as Te,z as Y,y as Oe,w as $,o as Ve,d as W,e as V}from"./factory-5f559ecf.js";import{a as Fe}from"./index-55be9bf6.js";import{u as Le}from"./index-b5b63d97.js";import{u as je,f as J}from"./form-control-de73da49.js";import{c as De}from"./icon-96427744.js";import{a as Ke,o as Ue}from"./theme-ee3e3fce.js";import{f as F}from"./forward-ref-8b7d2a6f.js";import{a as Be}from"./use-component-style-5e7d3fa1.js";const ze=({min:t=Number.MIN_SAFE_INTEGER,max:r=Number.MAX_SAFE_INTEGER,keepWithinRange:c=!0,...n}={})=>{const i=O(n.onChange),[a,d]=s.useState(()=>n.defaultValue==null?"":Q(n.defaultValue,n.step??1,n.precision)??""),l=typeof n.value<"u",u=l?n.value:a,D=Pe(k(u),n.step??1),g=n.precision??D,C=s.useCallback(p=>{p!==u&&(l||d(p.toString()),i(p.toString(),k(p)))},[i,l,u]),b=s.useCallback(p=>{let f=p;return c&&(f=Ae(f,t,r)),Ee(f,g)},[g,c,r,t]),I=s.useCallback((p=n.step??1)=>{let f;u===""?f=k(p):f=k(u)+p,f=b(f),C(f)},[b,n.step,C,u]),M=s.useCallback((p=n.step??1)=>{let f;u===""?f=k(-p):f=k(u)-p,f=b(f),C(f)},[b,n.step,C,u]),_=s.useCallback(()=>{let p;a==null?p="":p=Q(a,n.step??1,n.precision)??t,C(p)},[a,n.precision,n.step,C,t]),o=s.useCallback(p=>{const f=Q(p,n.step??1,g)??t;C(f)},[g,n.step,C,t]),x=k(u);return{isOut:x<t||r<x,isMax:x===r,isMin:x===t,precision:g,value:u,valueAsNumber:x,update:C,reset:_,increment:I,decrement:M,clamp:b,cast:o,setValue:d}},k=t=>parseFloat(t.toString().replace(/[^\w.-]+/g,"")),Pe=(t,r)=>Math.max(Ne(r),Ne(t)),Q=(t,r,c)=>(t=k(t),Number.isNaN(t)?void 0:Ee(t,c??Pe(t,r))),Ge=t=>/^[Ee0-9+\-.]$/.test(t),qe=({key:t,ctrlKey:r,altKey:c,metaKey:n},i)=>{if(t==null)return!0;const a=r||c||n;return!(t.length===1)||a?!0:i(t)},he=({ctrlKey:t,shiftKey:r,metaKey:c})=>{let n=1;return(c||t)&&(n=.1),r&&(n=10),n},We=(t={})=>{const{id:r,name:c,inputMode:n="decimal",pattern:i="[0-9]*(.[0-9]+)?",required:a,disabled:d,readOnly:l,focusInputOnChange:u=!0,clampValueOnBlur:D=!0,keepWithinRange:g=!0,allowMouseWheel:C,min:b=Number.MIN_SAFE_INTEGER,max:I=Number.MAX_SAFE_INTEGER,precision:M,"aria-invalid":_,...o}=je(t),x=a,Z=l,ee=d,[te,p]=s.useState(!1),f=!(l||d),P=s.useRef(null),L=s.useRef(null),ne=s.useRef(null),se=s.useRef(null),re=O(S(o.onFocus,e=>{var m;p(!0),L.current&&(e.target.selectionStart=L.current.start??((m=e.currentTarget.value)==null?void 0:m.length),e.currentTarget.selectionEnd=L.current.end??e.currentTarget.selectionStart)})),oe=O(S(o.onBlur,()=>{p(!1),D&&ke()})),R=O(o.onInvalid),j=O(o.isValidCharacter??Ge),{isMin:ce,isMax:ae,isOut:ue,value:N,valueAsNumber:E,setValue:X,update:T,cast:ie,...K}=ze({min:b,max:I,precision:M,keepWithinRange:g,...o}),U=s.useCallback(e=>e.split("").filter(j).join(""),[j]),B=s.useCallback(e=>{var m;return((m=o.parse)==null?void 0:m.call(o,e))??e},[o]),A=s.useCallback(e=>{var m;return(((m=o.format)==null?void 0:m.call(o,e))??e).toString()},[o]),z=s.useCallback((e=o.step??1)=>{f&&K.increment(e)},[f,K,o.step]),G=s.useCallback((e=o.step??1)=>{f&&K.decrement(e)},[f,K,o.step]),ke=s.useCallback(()=>{let e=N;if(N==="")return;/^[eE]/.test(N.toString())?X(""):(E<b&&(e=b),E>I&&(e=I),ie(e))},[ie,I,b,X,N,E]),le=s.useCallback(e=>{if(e.nativeEvent.isComposing)return;const v=B(e.currentTarget.value);T(U(v)),L.current={start:e.currentTarget.selectionStart,end:e.currentTarget.selectionEnd}},[B,T,U]),fe=s.useCallback(e=>{if(e.nativeEvent.isComposing)return;qe(e,j)||e.preventDefault();const m=he(e)*(o.step??1),h={ArrowUp:()=>z(m),ArrowDown:()=>G(m),Home:()=>T(b),End:()=>T(I)}[e.key];h&&(e.preventDefault(),h(e))},[G,z,j,I,b,o.step,T]),{up:me,down:de,stop:y,isSpinning:pe}=Xe(z,G);we(ne,["disabled"],pe,y),we(se,["disabled"],pe,y);const q=s.useCallback(()=>{u&&requestAnimationFrame(()=>{var e;(e=P.current)==null||e.focus()})},[u]),be=s.useCallback(e=>{e.preventDefault(),me(),q()},[q,me]),Ce=s.useCallback(e=>{e.preventDefault(),de(),q()},[q,de]);Me(()=>{(E>I||E<b)&&(R==null||R("rangeOverflow",A(N),E))},[E,N,A,R]),Te(()=>{if(!P.current||!(P.current.value!=N))return;const m=B(P.current.value);X(U(m))},[B,U]),Fe(()=>P.current,"wheel",e=>{var Se;const v=(((Se=P.current)==null?void 0:Se.ownerDocument)??document).activeElement===P.current;if(!C||!v)return;e.preventDefault();const h=he(e)*(o.step??1),ge=Math.sign(e.deltaY);ge===-1?z(h):ge===1&&G(h)},{passive:!1});const xe=s.useCallback((e={},m=null)=>({id:r,name:c,type:"text",inputMode:n,pattern:i,required:a,disabled:d,readOnly:l,...Y(o,J),...Oe(e,["defaultValue"]),ref:$(P,m),value:A(N),"aria-invalid":Ke(_??ue),autoComplete:"off",autoCorrect:"off",onChange:S(e.onChange,le),onKeyDown:S(e.onKeyDown,fe),onFocus:S(e.onFocus,re),onBlur:S(e.onBlur,oe)}),[r,c,n,i,a,d,l,o,A,N,_,ue,le,fe,re,oe]),Re=s.useCallback((e={},m=null)=>{const v=e.disabled||g&&ae;return{required:a,readOnly:l,disabled:v,...Y(o,J),...e,ref:$(m,ne),role:"button",tabIndex:-1,cursor:l?"not-allowed":e.cursor,onPointerDown:S(e.onPointerDown,h=>{h.button===0&&!v&&be(h)}),onPointerLeave:S(e.onPointerLeave,y),onPointerUp:S(e.onPointerUp,y)}},[g,ae,a,l,o,y,be]),_e=s.useCallback((e={},m=null)=>{const v=e.disabled||g&&ce;return{required:a,readOnly:l,disabled:v,...Y(o,J),...e,ref:$(m,se),role:"button",tabIndex:-1,cursor:l?"not-allowed":e.cursor,onPointerDown:S(e.onPointerDown,h=>{h.button===0&&!v&&Ce(h)}),onPointerLeave:S(e.onPointerLeave,y),onPointerUp:S(e.onPointerUp,y)}},[g,ce,a,l,o,y,Ce]);return{value:A(N),valueAsNumber:E,isFocused:te,isRequired:x,isReadOnly:Z,isDisabled:ee,getInputProps:xe,getIncrementProps:Re,getDecrementProps:_e}},He=50,ve=300,Xe=(t,r)=>{const[c,n]=s.useState(!1),[i,a]=s.useState(null),[d,l]=s.useState(!0),u=s.useRef(null),D=()=>clearTimeout(u.current);Le(()=>{i==="increment"&&t(),i==="decrement"&&r()},c?He:null);const g=s.useCallback(()=>{d&&t(),u.current=setTimeout(()=>{l(!1),n(!0),a("increment")},ve)},[t,d]),C=s.useCallback(()=>{d&&r(),u.current=setTimeout(()=>{l(!1),n(!0),a("decrement")},ve)},[r,d]),b=s.useCallback(()=>{l(!0),n(!1),D()},[]);return s.useEffect(()=>()=>D(),[]),{up:g,down:C,stop:b,isSpinning:c}},we=(t,r,c,n)=>{s.useEffect(()=>{if(!t.current||!c)return;const i=t.current.ownerDocument.defaultView??window,a=new i.MutationObserver(d=>{for(const{type:l,attributeName:u}of d)l==="attributes"&&u&&r.includes(u)&&n()});return a.observe(t.current,{attributes:!0,attributeFilter:r}),()=>a.disconnect()})},[Ye,H]=Ve({strict:!1,name:"NumberInputContext"}),ft=F((t,r)=>{const[c,n]=Be("NumberInput",t),{className:i,isStepper:a=!0,containerProps:d,addonProps:l,incrementProps:u,decrementProps:D,onChange:g,...C}=Ue(n),{getInputProps:b,getIncrementProps:I,getDecrementProps:M}=We({onChange:g,...C}),_={position:"relative",zIndex:0,...c.container};return w(Ye,{value:{getInputProps:b,getIncrementProps:I,getDecrementProps:M,styles:c},children:Ie(W.div,{className:V("ui-number-input",i),__css:_,...d,children:[w($e,{...b(C,r)}),a?Ie(Je,{...l,children:[w(Qe,{...u}),w(Ze,{...D})]}):null]})})}),$e=F(({className:t,...r},c)=>{const{styles:n}=H(),i={width:"100%",...n.field};return w(W.input,{ref:c,className:V("ui-number-input-field",t),__css:i,...r})}),Je=F(({className:t,...r},c)=>{const{styles:n}=H(),i={display:"flex",flexDirection:"column",position:"absolute",top:"0",insetEnd:"0px",margin:"1px",height:"calc(100% - 2px)",zIndex:1,...n.addon};return w(W.div,{ref:c,className:V("ui-number-input-addon",t),"aria-hidden":!0,__css:i,...r})}),ye=W("div",{baseStyle:{display:"flex",justifyContent:"center",alignItems:"center",flex:1,transitionProperty:"common",transitionDuration:"normal",userSelect:"none",cursor:"pointer",lineHeight:"normal"}}),Qe=F(({className:t,children:r,...c},n)=>{const{getIncrementProps:i,styles:a}=H(),d={...a.stepper};return w(ye,{className:V("ui-number-input-stepper",t),...i(c,n),__css:d,children:r??w(De,{__css:{transform:"rotate(180deg)"}})})}),Ze=F(({className:t,children:r,...c},n)=>{const{getDecrementProps:i,styles:a}=H(),d={...a.stepper};return w(ye,{className:V("ui-number-input-stepper",t),...i(c,n),__css:d,children:r??w(De,{})})});export{ft as N,We as u};
//# sourceMappingURL=number-input-dde3a75a.js.map
