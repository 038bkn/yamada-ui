import{j as S}from"./jsx-runtime-CKrituN3.js";import{u as Oe}from"./index-B9eChsAc.js";import{r as n}from"./index-CBqU2yxZ.js";import{c as je,a as Ee}from"./icon-CdBlBeK_.js";import{f as J}from"./forward-ref-DuAegr0M.js";import{r as Re,R as Te,Z as ke,_ as ye,E as Pe,o as U,a3 as Ae,S as Le,n as Ne,e as He,Q as Me,a as ce,h as $,A as q,B as _e,ah as Be,a5 as le,x as Ge,u as V,c as W,g as Ke}from"./factory-Of2RQyuI.js";import{b as Ue}from"./popover-content-BY63LIme.js";import{u as Ve}from"./index-IsI1GLa-.js";import{c as We}from"./index-CUCV58-v.js";import{u as ze}from"./index-BRsDc6fp.js";import{u as Qe}from"./index-CccpWeiG.js";import{u as Ye,g as Ze}from"./form-control-CxhYt3bq.js";const $e=s=>{var o;return Be(s)&&!!((o=s==null?void 0:s.getAttribute("role"))!=null&&o.startsWith("select-item"))},{DescendantsContextProvider:bt,useDescendantsContext:Se,useDescendants:qe,useDescendant:Je}=We(),[ht,N]=Re({strict:!1,name:"SelectContext"}),vt=({placeholder:s,closeOnBlur:o=!0,closeOnEsc:c=!0,closeOnSelect:i=!0,placeholderInOptions:a=!0,omitSelectedValues:l=!1,maxSelectValues:r,isEmpty:d,placement:h="bottom-start",duration:v=.2,isOpen:I,defaultIsOpen:g,onOpen:y,onClose:F,optionProps:_,...u})=>{u=Ye(u);const f=Te(u,Ze({omit:["aria-readonly"]})),[X,z]=ke(Pe(u,["value","defaultValue","onChange","aria-readonly"]),ye),x=qe(),[m,b]=n.useState(-1),[ee,H]=n.useState(!1),G=n.useRef(null),te=n.useRef(null),pe=n.useRef(null),A=n.useRef(new Set([])),[k,Q]=Ve({value:u.value,defaultValue:u.defaultValue,onChange:u.onChange}),[w,K]=n.useState(void 0),M=m>-1,C=U(k),E=(C?!k.length:!k)&&!(s&&a),L=x.values(({node:e})=>C&&k.includes(e.dataset.value??"")).map(({index:e})=>e),T=x.enabledValues(({index:e})=>!L.includes(e)),se=n.useCallback(()=>{const e=setTimeout(()=>{const t=x.enabledFirstValue();if(t)if(!C||!l)b(t.index);else if(L.includes(t.index)){const P=T[0];b(P.index)}else b(t.index)});A.current.add(e)},[x,T,C,l,L]),ne=n.useCallback(()=>{const e=setTimeout(()=>{const t=x.enabledLastValue();if(t)if(!C||!l)b(t.index);else if(L.includes(t.index)){const P=T.reverse()[0];b(P.index)}else b(t.index)});A.current.add(e)},[x,T,C,l,L]),ae=n.useCallback(()=>{const e=setTimeout(()=>{const P=x.enabledValues().find(({node:R})=>C?k.includes(R.dataset.value??""):R.dataset.value===k);P&&b(P.index)});A.current.add(e)},[x,C,k]),Y=n.useCallback(()=>{const e=setTimeout(()=>{const t=x.enabledNextValue(m);if(t)if(!C||!l)b(t.index);else if(L.includes(t.index)){const P=T.find(({index:R})=>t.index<R)??T[0];b(P.index)}else b(t.index)});A.current.add(e)},[x,T,m,C,l,L,b]),ie=n.useCallback(()=>{const e=setTimeout(()=>{const t=x.enabledPrevValue(m);if(t)if(!C||!l)b(t.index);else if(L.includes(t.index)){const P=T.reverse().find(({index:R})=>R<t.index)??T[0];b(P.index)}else b(t.index)});A.current.add(e)},[x,T,m,C,l,L,b]),B=E||l?se:ae,me=E||l?ne:ae,re=n.useCallback((e,t=!0)=>{const R=x.values().filter(({node:D})=>D.dataset.value===e).map(({node:D,index:Z})=>{if(!(s&&a)||Z!==0){const oe=Array.from(D.children).find(fe=>fe.getAttribute("data-label")!==null);return(oe==null?void 0:oe.innerHTML)??""}else return});K(D=>C?(R.forEach(Z=>{U(D)&&D.includes(Z??"")?t&&(D=U(D)?D.filter(fe=>fe!==Z):void 0):D=[...U(D)?D:[],Z]}),D):R[0])},[x,C,s,a]),ue=n.useCallback(e=>{Q(t=>U(t)?t.includes(e)?t.filter(R=>R!==e):[...t,e]:e),re(e)},[re,Q]),Ie=n.useCallback(e=>{e.stopPropagation(),Q([]),K(void 0)},[K,Q]),{isOpen:p,onOpen:Ce,onClose:O}=ze({isOpen:I,defaultIsOpen:g,onOpen:y,onClose:F}),j=n.useCallback(()=>{f.disabled||f.readOnly||d||ee||Ce()},[f,d,ee,Ce]),de=n.useCallback(()=>{let e=x.value(m);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const t=e.node.dataset.value??"";ue(t),i&&O(),l&&Y()},[i,x,m,l,ue,O,Y]),be=n.useCallback(()=>{p||(j(),B())},[p,B,j]),he=n.useCallback(()=>{p||(j(),B())},[p,B,j]),ve=n.useCallback(e=>{const t=Ae(e);Le(G.current,t)||o&&p&&O()},[o,p,O]),ge=n.useCallback(e=>{if(e.key===" "&&(e.key=e.code),f.disabled||f.readOnly)return;const P={ArrowDown:M?()=>Y():p?void 0:le(j,B),ArrowUp:M?()=>ie():p?void 0:le(j,me),Space:M?de:p?void 0:le(j,B),Enter:M?de:p?void 0:le(j,B),Home:p?se:void 0,End:p?ne:void 0,Escape:c?O:void 0}[e.key];P&&(e.preventDefault(),e.stopPropagation(),P())},[f.disabled,f.readOnly,M,p,j,B,me,de,se,ne,c,O,Y,ie]);Qe({ref:G,handler:O,enabled:p&&o}),n.useEffect(()=>{if(!C||!l&&Ne(r))return;const e=k.length>0&&k.length===x.count(),t=k.length===r;e||t?(O(),H(!0)):H(!1)},[l,k,x,C,O,r]),He(()=>{p||b(-1)},[p]),Me(()=>{A.current.forEach(e=>clearTimeout(e)),A.current.clear()});const Fe=n.useCallback(e=>({matchWidth:!0,...u,...e,isOpen:p,onOpen:j,onClose:O,placement:h,duration:v,trigger:"never",closeOnButton:!1,closeOnBlur:o}),[v,o,O,j,h,u,p]),we=n.useCallback((e={},t=null)=>({ref:ce(G,t),...X,...e,...f,onClick:$(e.onClick,u.onClick,be),onBlur:$(e.onBlur,u.onBlur,ve)}),[X,f,ve,be,u]),De=n.useCallback((e={},t=null)=>({ref:ce(te,t),tabIndex:0,...z,...e,"data-active":q(p),"data-placeholder":q(C?!(w!=null&&w.length):w===void 0),"aria-expanded":q(p),onFocus:$(e.onFocus,u.onFocus,he),onKeyDown:$(e.onKeyDown,u.onKeyDown,ge)}),[z,p,C,w,u,he,ge]);return{descendants:x,value:k,label:w,focusedIndex:m,placeholder:s,placeholderInOptions:a,omitSelectedValues:l,closeOnSelect:i,isOpen:p,containerRef:G,fieldRef:te,listRef:pe,optionProps:_,formControlProps:f,onChangeLabel:re,onChange:ue,onClear:Ie,onOpen:j,onClose:O,onFocusFirst:se,onFocusLast:ne,onFocusSelected:ae,onFocusNext:Y,onFocusPrev:ie,setFocusedIndex:b,getPopoverProps:Fe,getContainerProps:we,getFieldProps:De}},Xe=()=>{const{listRef:s,focusedIndex:o}=N(),c=Se(),i=n.useRef(-1),a=c.value(o);return n.useEffect(()=>{if(!s.current||!a||i.current===a.index)return;const r=s.current,d=a.node,h=r.clientHeight,v=r.scrollTop,I=v+h,g=d.clientHeight,y=d.offsetTop,F=y+g,_=v<=y&&F<=I,u=i.current<a.index;_||(F<=h?s.current.scrollTo({top:0}):u?s.current.scrollTo({top:F-h}):s.current.scrollTo({top:y+1})),i.current=a.index},[s,a]),{getListProps:n.useCallback((r={},d=null)=>({as:"ul",ref:ce(s,d),role:"select",tabIndex:-1,...r}),[s])}},et=({label:s,...o})=>{const{value:c,omitSelectedValues:i}=N(),a=U(c),l=Se(),r=l.values(),h=(a&&i?l.values(({node:_})=>c.includes(_.dataset.value??"")):[]).map(({index:_})=>_),I=!r.filter(({node:_,index:u})=>{var f;return((f=_.parentElement)==null?void 0:f.dataset.label)===s&&!h.includes(u)}).length,g=ke(o,ye),y=n.useCallback((_={},u=null)=>{const f={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};return{ref:u,..._,...g[0],style:I?f:void 0}},[g,I]),F=n.useCallback((_={},u=null)=>({ref:u,..._,...g[1],"data-label":s}),[g,s]);return{label:s,getContainerProps:y,getGroupProps:F}},tt=(s,o)=>{const{fieldRef:c,value:i,placeholder:a,placeholderInOptions:l,omitSelectedValues:r,closeOnSelect:d,focusedIndex:h,optionProps:v,onChange:I,onChangeLabel:g,onFocusNext:y,onClose:F,setFocusedIndex:_}=N();let{icon:u,isDisabled:f,isFocusable:X,closeOnSelect:z,children:x,...m}={...v,...o};const b=!!f&&!X,ee=n.useRef(null),{index:H,register:G,descendants:te}=Je({disabled:b}),A=te.values().slice(0,H),k=U(i),w=!(k?!1:A.some(({node:E})=>E.dataset.value===(m.value??"")))&&(k?i.includes(m.value??""):(m.value??"")===i),K=H===h;a&&H>0&&l&&!m.value&&console.warn(`${k?"MultiSelect":"Select"}: If placeholders are present, All options must be set value. If want to set an empty value, either don't set the placeholder or set 'placeholderInOptions' to false.`);const M=n.useCallback(E=>{if(E.preventDefault(),E.stopPropagation(),f){c.current&&c.current.focus();return}if(!$e(E.currentTarget)){c.current&&c.current.focus();return}_(H),I(m.value??""),c.current&&c.current.focus(),(z??d)&&F(),r&&y()},[f,_,H,I,m.value,c,z,d,F,r,y]);n.useEffect(()=>{w&&g(m.value??"",!1)},[m,w,g]);const C=n.useCallback((E={})=>{const xe={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};return{ref:ce(ee,s,G),...Pe(m,["value"]),...E,role:"select-item",tabIndex:-1,style:r&&w?xe:void 0,"data-value":m.value??"","data-focus":q(K),"data-disabled":q(f),"aria-checked":_e(w),"aria-disabled":_e(f),onClick:$(m.onClick,E.onClick,M)}},[m,f,K,w,r,M,s,G]);return{isSelected:w,isFocused:K,customIcon:u,children:x,getOptionProps:C}},st=J(({className:s,children:o,__css:c,...i},a)=>{const{styles:l}=N(),r={position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",cursor:"pointer",...l.icon,...c},h=Ge(o).map(v=>n.cloneElement(v,{focusable:!1,"aria-hidden":!0,style:{maxWidth:"1em",maxHeight:"1em",color:"currentColor"}}));return S.jsx(V.div,{ref:a,className:W("ui-select__icon",s),__css:r,...i,children:Ke(o)?h:S.jsx(je,{})})}),gt=({className:s,children:o,...c})=>{const i=n.useRef(null),{styles:a}=N(),l=c.disabled,r=Oe({ref:i,isDisabled:l,...c});return S.jsx(st,{"aria-label":"Clear value",className:W("ui-select__clear-icon",s),__css:a.clearIcon,...r,children:o??S.jsx(Ee,{w:"0.5em",h:"0.5em"})})},_t=J(({className:s,w:o,width:c,minW:i,minWidth:a,...l},r)=>{var I,g,y,F;const{styles:d}=N(),{getListProps:h}=Xe();o=o??c??((I=d.list)==null?void 0:I.w)??((g=d.list)==null?void 0:g.width),i=i??a??((y=d.list)==null?void 0:y.minW)??((F=d.list)==null?void 0:F.minWidth);const v={...d.list};return S.jsx(Ue,{className:W("ui-select__list",s),w:o,minW:i,__css:v,...h(l,r)})}),kt=J(({className:s,color:o,h:c,height:i,minH:a,minHeight:l,children:r,...d},h)=>{const{styles:v}=N(),{label:I,getContainerProps:g,getGroupProps:y}=et(d);return c??(c=i),a??(a=l),S.jsxs(V.li,{className:W("ui-select__item","ui-select__item--group",s),__css:{w:"100%",h:"fit-content",color:o},...g(),children:[S.jsx(V.span,{className:"ui-select__item__group-label",__css:v.groupLabel,lineClamp:1,children:I}),S.jsx(V.ul,{...y({},h),className:"ui-select__item__group",__css:{h:c,minH:a,...v.group},children:r})]})}),yt=J(({className:s,icon:o,...c},i)=>{const{styles:a}=N(),{isSelected:l,customIcon:r,children:d,getOptionProps:h}=tt(i,c);o??(o=r);const v={textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,gap:"0.75rem",...a.item};return S.jsxs(V.li,{className:W("ui-select__item",s),__css:v,...h(),children:[o!==null?S.jsx(nt,{opacity:l?1:0,children:o||S.jsx(ot,{})}):null,S.jsx(V.span,{style:{flex:1},"data-label":!0,children:d})]})}),nt=J(({className:s,...o},c)=>{const{styles:i}=N(),a={flexShrink:0,display:"inline-flex",justifyContent:"center",alignItems:"center",fontSize:"0.85em",...i.itemIcon};return S.jsx(V.span,{ref:c,className:W("ui-select__item__icon",s),__css:a,...o})}),ot=()=>S.jsx("svg",{viewBox:"0 0 14 14",width:"1em",height:"1em",children:S.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})});export{yt as O,bt as S,kt as a,ht as b,st as c,_t as d,N as e,gt as f,vt as u};
