import{j as h,a as L}from"./jsx-runtime-5BUNAZ9W.js";import{u as _e}from"./index-rCbW54RG.js";import{r as f}from"./index-4g5l5LRQ.js";import{b as be,c as ve,g as se,a6 as ne,e as ee,Q as ye,h as x,o as Pe,a as O,u as E,s as we,B as xe}from"./factory-PArTdL2L.js";import{u as ke,f as Ee}from"./form-control-6MywZV1a.js";import{d as De,h as Z,c as ae,f as Re,r as Ne,p as Me,g as Te,i as Ve,o as Oe}from"./theme-provider-GeG-940j.js";import{I as Ae}from"./icon-button-4HAH6E8Y.js";import{b as He}from"./icon-39Pfil-I.js";import{f as A}from"./forward-ref-A-8Arhkk.js";import{A as je}from"./alpha-slider-Rt4jXHUa.js";import{H as Le}from"./hue-slider-DwnybIYJ.js";import{C as ue}from"./color-swatch-4lKuwAUq.js";import{I as Be}from"./input-LF0QaIkp.js";import{S as Fe}from"./saturation-slider-coeZPAA8.js";import{u as We}from"./use-component-style-WCoXUinJ.js";const Ie=()=>{const[o,i]=f.useState(!1);be(()=>{i(typeof window<"u"&&"EyeDropper"in window)},[]);const n=f.useCallback((l={})=>o?new window.EyeDropper().open(l):Promise.resolve(void 0),[o]);return{supported:o,onOpen:n}},le=(o,i)=>{let[n,l,c,u]=Me(o,i)??[0,0,1,1];return u>1&&(u=1),{h:n,s:l,l:c,a:u}},ce=(o,i)=>{let[n,l,c,u]=Te(o,i)??[255,255,255,1];return n>255&&(n=255),l>255&&(l=255),c>255&&(c=255),u>1&&(u=1),{r:n,g:l,b:c,a:u}},oe=(o,i)=>{const[n,l,c,u]=Ve(o,i);return{h:n,s:l,v:c,a:u}},[$e,B]=ve({name:"ColorSelectorContext",errorMessage:`useColorSelectorContext returned is 'undefined'. Seems you forgot to wrap the components in "<ColorSelector />"`}),ze=({isInvalid:o,...i})=>{let{id:n,name:l,value:c,defaultValue:u,fallbackValue:r,onChange:C,onChangeStart:S,onChangeEnd:y,format:g,required:p,disabled:a,readOnly:d,onSwatchClick:D,...F}=ke({isInvalid:o,...i});const G=se(S),q=se(y),{supported:J,onOpen:Q}=Ie(),[W,U]=_e({value:c,defaultValue:u??r,onChange:C}),_=W??"#ffffff",I=f.useRef(void 0),b=f.useRef(g??De(_)),$=f.useRef(!1),[T,z]=f.useState(oe(_,r)),{h:k,s:R,v:N,a:V}=T,H=b.current.endsWith("a"),K=!(a||d),ie=f.useMemo(()=>{if(_.startsWith("hsl")){const{h:e,s,l:t,a:m}=le(_,r);let v=[{label:"H",space:"h",value:Math.round(e),min:0,max:360},{label:"S(%)",space:"s",value:Math.round(s*100),min:0,max:100},{label:"L(%)",space:"l",value:Math.round(t*100),min:0,max:100}];return H&&(v=[...v,{label:"A(%)",space:"a",value:Math.round(m*100),min:0,max:100}]),v}else{const{r:e,g:s,b:t,a:m}=ce(_,r);let v=[{label:"R",space:"r",value:Math.round(e),min:0,max:255},{label:"G",space:"g",value:Math.round(s),min:0,max:255},{label:"B",space:"b",value:Math.round(t),min:0,max:255}];return H&&(v=[...v,{label:"A(%)",space:"a",value:Math.round(m*100),min:0,max:100}]),v}},[_,H,r]),P=f.useCallback(e=>{ne(e)?z(oe(e,r)):z(s=>({...s,...e}))},[r]),j=f.useCallback(e=>{window.clearTimeout(I.current),$.current=!0;const{h:s,s:t,v:m,a:v}={...T,...e},M=Z([s,t,m,v],r)(b.current);M&&G(M)},[b,G,r,T]),w=f.useCallback(e=>{window.clearTimeout(I.current),I.current=window.setTimeout(()=>{$.current=!1},200);let s;if(ne(e))s=ae(e,r)(b.current);else{const{h:t,s:m,v,a:M}={...T,...e};s=Z([t,m,v,M],r)(b.current)}s&&q(s)},[b,q,r,T]),re=f.useCallback((e,s)=>{let t=Math.floor(parseFloat(e.target.value));isNaN(t)&&(t=0),["s","l","a"].includes(s)&&(t=t/100);let m;if(_.startsWith("hsl")){const{h:v,s:M,l:X,a:Y}=Object.assign(le(_,r),{[s]:t});m=Re([v,M,X,Y],r)(b.current)}else{const{r:v,g:M,b:X,a:Y}=Object.assign(ce(_,r),{[s]:t});m=Ne([v,M,X,Y],r)(b.current)}m&&(P(m),w(m))},[_,P,w,b,r]),te=f.useCallback(async()=>{try{const{sRGBHex:e}=await Q()??{};if(!e)return;P(e),w(e)}catch{}},[Q,P,w]);ee(()=>{const e=Z([k,R,N,V],r)(b.current);e&&U(e)},[k,R,N,V]),ee(()=>{$.current||c&&z(oe(c,r))},[c]),ee(()=>{if(!g||!W)return;b.current=g;const e=ae(W,r)(g);e&&U(e)},[g]);const he=(e={},s=null)=>({...e,ref:s,...Pe(F,["aria-readonly"])}),pe=f.useCallback((e={},s=null)=>({...ye(F,Ee),...e,id:n,ref:s,type:"hidden",name:l,value:_,required:p,disabled:a,readOnly:d}),[a,n,l,d,p,F,_]),de=f.useCallback((e={},s=null)=>({required:p,disabled:a,readOnly:d,isInvalid:o,...e,ref:s,value:[k,R,N],onChange:x(e.onChange,([,t,m])=>P({s:t,v:m})),onChangeStart:x(e.onChangeStart,([,t,m])=>j({s:t,v:m})),onChangeEnd:x(e.onChangeEnd,([,t,m])=>w({s:t,v:m}))}),[p,a,d,o,k,R,N,P,j,w]),me=f.useCallback((e={},s=null)=>({required:p,disabled:a,readOnly:d,isInvalid:o,...e,ref:s,value:k,onChange:x(e.onChange,t=>P({h:t})),onChangeStart:x(e.onChangeStart,t=>j({h:t})),onChangeEnd:x(e.onChangeEnd,t=>w({h:t}))}),[p,a,d,o,k,P,j,w]),fe=f.useCallback((e={},s=null)=>({required:p,disabled:a,readOnly:d,isInvalid:o,...e,ref:s,value:V,color:Z([k,R,N,V],r)(b.current),onChange:x(e.onChange,t=>P({a:t})),onChangeStart:x(e.onChangeStart,t=>j({a:t})),onChangeEnd:x(e.onChangeEnd,t=>w({a:t}))}),[r,p,a,d,o,b,k,R,N,V,P,j,w]),Ce=f.useCallback(({space:e,...s},t=null)=>({required:p,disabled:a,readOnly:d,isInvalid:o,...s,ref:t,type:"number",step:1,onChange:x(s.onChange,m=>re(m,e))}),[p,a,d,o,re]),ge=f.useCallback((e={},s=null)=>({disabled:a,"aria-label":"Pick a color",...e,ref:s,onClick:x(e.onClick,te)}),[a,te]),Se=f.useCallback(({color:e,...s}={},t=null)=>({"aria-label":`select ${e} as the color`,disabled:a,readOnly:d,...s,ref:t,color:e,onClick:x(s.onClick,()=>{e&&(D==null||D(e),P(e),w(e))})}),[a,d,D,P,w]);return{value:_,onChange:P,eyeDropperSupported:J,withAlpha:H,isInteractive:K,disabled:a,readOnly:d,channels:ie,getContainerProps:he,getInputProps:pe,getSaturationSliderProps:de,getHueSliderProps:me,getAlphaSliderProps:fe,getEyeDropperProps:ge,getChannelProps:Ce,getSwatchProps:Se}},Ge=A(({className:o,...i},n)=>{const{getEyeDropperProps:l,readOnly:c,size:u,styles:r}=B(),C={h:"auto",minW:"auto",pointerEvents:c?"none":void 0,...r.eyeDropper};return h(Ae,{className:O("ui-color-selector__eye-dropper",o),variant:"outline",size:u,__css:C,...l(i,n),children:h(qe,{className:"ui-color-selector__eye-dropper__icon"})})}),qe=({...o})=>L(He,{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...o,children:[h("path",{d:"m2 22 1-1h3l9-9"}),h("path",{d:"M3 21v-3l9-9"}),h("path",{d:"m15 6 3.4-3.4a2.1 2.1 0 1 1 3 3L18 9l.4.4a2.1 2.1 0 1 1-3 3l-3.8-3.8a2.1 2.1 0 1 1 3-3l.4.4Z"})]}),Qe=A(({className:o,hueSliderRef:i,hueSliderProps:n,alphaSliderRef:l,alphaSliderProps:c,...u},r)=>{let{size:C,withAlpha:S,getHueSliderProps:y,getAlphaSliderProps:g,styles:p}=B();C==="full"&&(C="lg");const a={display:"flex",flexDirection:"column",...p.sliders};return L(E.div,{ref:r,className:O("ui-color-selector__sliders",o),__css:a,...u,children:[h(Le,{size:C,className:"ui-color-selector__hue-slider",__css:{...p.hueSlider},...y(n,i)}),S?h(je,{size:C,className:"ui-color-selector__alpha-slider",__css:{...p.alphaSlider},...g(c,l)}):null]})}),Ue=A(({className:o,withEyeDropper:i=!0,withResult:n,eyeDropperRef:l,eyeDropperProps:c,hueSliderRef:u,hueSliderProps:r,alphaSliderRef:C,alphaSliderProps:S,...y},g)=>{const{value:p,eyeDropperSupported:a,styles:d}=B(),D={display:"flex",w:"100%",...d.body};return L(E.div,{ref:g,className:O("ui-color-selector__body",o),__css:D,...y,children:[h(Qe,{hueSliderRef:u,hueSliderProps:r,alphaSliderRef:C,alphaSliderProps:S}),i&&a?h(Ge,{ref:l,...c}):null,n?h(ue,{className:"ui-color-selector__result",color:p,__css:{...d.result}}):null]})}),Ze=A(({className:o,channelProps:i,...n},l)=>{const{withAlpha:c,channels:u,getChannelProps:r,styles:C}=B(),S={display:"grid",gridTemplateColumns:`repeat(${c?"4":"3"}, 1fr)`,...C.channels};return h(E.div,{ref:l,className:O("ui-color-selector__channels",o),__css:S,...n,children:u.map(({label:y,space:g,value:p,min:a,max:d})=>h(Je,{channelLabel:y,...r({...i,space:g,value:p,min:a,max:d})},y))})}),Je=A(({className:o,channelLabel:i,...n},l)=>{const c=f.useId();let{size:u,disabled:r,readOnly:C,styles:S}=B();u==="full"&&(u="lg");const y={...S.channel};return L(E.div,{className:O("ui-color-selector__channel",o),children:[i?h(E.label,{htmlFor:c,style:{cursor:r?"not-allowed":void 0},__css:{display:"block",pointerEvents:C?"none":void 0,...S.channelLabel},children:i}):null,h(Be,{ref:l,id:c,size:u,__css:y,...n})]})}),Ke=A(({className:o,swatchesLabel:i,swatches:n,swatchesContainerProps:l,swatchProps:c,swatchesColumns:u,...r},C)=>{const{getSwatchProps:S,readOnly:y,styles:g}=B(),p={display:"grid",gridTemplateColumns:we(u,a=>a!=null?`repeat(${a}, minmax(0, 1fr))`:void 0),...g.swatches};return n!=null&&n.length?L(E.div,{...l,children:[i?h(E.p,{className:"ui-color-selector__swatches__label",__css:{...g.swatchesLabel},children:i}):null,h(E.div,{ref:C,className:O("ui-color-selector__swatches",o),__css:p,...r,children:n.map(a=>h(ue,{as:"button",__css:{boxSize:"100%",pointerEvents:y?"none":void 0,...g.swatch},...S({color:a,...c})},a))})]}):null}),mo=A(({size:o,...i},n)=>{const[l,c]=We("ColorSelector",{size:o,...i}),{className:u,children:r,withResult:C=!0,withPicker:S=!0,withChannel:y=!0,swatches:g,swatchesColumns:p=7,inputProps:a,withEyeDropper:d,eyeDropperRef:D,eyeDropperProps:F,saturationSliderRef:G,saturationSliderProps:q,hueSliderRef:J,hueSliderProps:Q,alphaSliderRef:W,alphaSliderProps:U,swatchesLabel:_,swatchProps:I,swatchesProps:b,channelsProps:$,channelProps:T,...z}=Oe(c),{value:k,getContainerProps:R,getInputProps:N,getSaturationSliderProps:V,...H}=ze(z),K={display:"flex",flexDirection:"column",...l.container};return h($e,{value:{styles:l,size:o,value:k,...H},children:L(E.div,{ref:n,className:O("ui-color-selector",u),__css:K,...R(),children:[h(E.input,{...N(a,n)}),S?h(Fe,{size:o,className:"ui-color-selector__saturation-slider",__css:{...l.saturationSlider},...V(q,G)}):null,S?h(Ue,{withResult:C,withEyeDropper:d,eyeDropperRef:D,eyeDropperProps:F,hueSliderRef:J,hueSliderProps:Q,alphaSliderRef:W,alphaSliderProps:U}):null,S&&y?h(Ze,{channelProps:T,...$}):null,h(Ke,{swatchesLabel:_,swatches:g,swatchesColumns:p,swatchProps:I,...b}),xe(r,{value:k})]})})});export{mo as C,qe as E,Ie as u};
