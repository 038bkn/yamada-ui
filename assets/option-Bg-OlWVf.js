import{j as y}from"./jsx-runtime-X2b_N9AH.js";import{u as De}from"./index-BPIwBPQe.js";import{r as n}from"./index-uCp2LrAq.js";import{c as Oe,a as Re}from"./icon-C4f_KbJN.js";import{f as Z}from"./forward-ref-Dr5Hqd9a.js";import{l as Te,S as Ee,$ as ye,a0 as ke,Q as Pe,s as G,aa as Ae,T as Le,q as Ne,f as He,R as Me,a as ce,h as J,d as X,y as _e,ae as Be,U as le,t as Ue,b as K,c as $,j as Ge}from"./factory-eGqOwxJN.js";import{b as Ke}from"./popover-content-HNceUCzk.js";import{u as Ve}from"./index-DgTF2YmQ.js";import{c as We}from"./index-CyJdPjCP.js";import{u as $e}from"./index-1abRQEVN.js";import{u as qe}from"./index-1St3wXnV.js";import{u as ze,f as Qe}from"./form-control-DwXP3uMc.js";const Ye=s=>{var l;return Be(s)&&!!((l=s==null?void 0:s.getAttribute("role"))!=null&&l.startsWith("select-item"))},{DescendantsContextProvider:ht,useDescendantsContext:Se,useDescendants:Je,useDescendant:Xe}=We(),[vt,H]=Te({strict:!1,name:"SelectContext"}),gt=({placeholder:s,closeOnBlur:l=!0,closeOnEsc:a=!0,closeOnSelect:r=!0,placeholderInOptions:i=!0,omitSelectedValues:c=!1,maxSelectValues:d,isEmpty:p,placement:C="bottom-start",duration:b=.2,isOpen:k,defaultIsOpen:h,onOpen:g,onClose:P,optionProps:v,...f})=>{f=ze(f);const{"aria-readonly":F,...j}=Ee(f,Qe),[q,ee]=ye(Pe(f,["value","defaultValue","onChange","aria-readonly"]),ke),o=Je(),[E,m]=n.useState(-1),[M,z]=n.useState(!1),V=n.useRef(null),ae=n.useRef(null),ie=n.useRef(null),O=n.useRef(new Set([])),[S,R]=Ve({value:f.value,defaultValue:f.defaultValue,onChange:f.onChange}),[A,W]=n.useState(void 0),U=E>-1,u=G(S),te=(u?!S.length:!S)&&!(s&&i),N=o.values(({node:e})=>u&&S.includes(e.dataset.value??"")).map(({index:e})=>e),L=o.enabledValues(({index:e})=>!N.includes(e)),se=n.useCallback(()=>{const e=setTimeout(()=>{const t=o.enabledFirstValue();if(t)if(!u||!c)m(t.index);else if(N.includes(t.index)){const _=L[0];m(_.index)}else m(t.index)});O.current.add(e)},[o,L,u,c,N]),ne=n.useCallback(()=>{const e=setTimeout(()=>{const t=o.enabledLastValue();if(t)if(!u||!c)m(t.index);else if(N.includes(t.index)){const _=L.reverse()[0];m(_.index)}else m(t.index)});O.current.add(e)},[o,L,u,c,N]),re=n.useCallback(()=>{const e=setTimeout(()=>{const _=o.enabledValues().find(({node:T})=>u?S.includes(T.dataset.value??""):T.dataset.value===S);_&&m(_.index)});O.current.add(e)},[o,u,S]),Q=n.useCallback(()=>{const e=setTimeout(()=>{const t=o.enabledNextValue(E);if(t)if(!u||!c)m(t.index);else if(N.includes(t.index)){const _=L.find(({index:T})=>t.index<T)??L[0];m(_.index)}else m(t.index)});O.current.add(e)},[o,L,E,u,c,N,m]),ue=n.useCallback(()=>{const e=setTimeout(()=>{const t=o.enabledPrevValue(E);if(t)if(!u||!c)m(t.index);else if(N.includes(t.index)){const _=L.reverse().find(({index:T})=>T<t.index)??L[0];m(_.index)}else m(t.index)});O.current.add(e)},[o,L,E,u,c,N,m]),B=te||c?se:re,me=te||c?ne:re,de=n.useCallback((e,t=!0)=>{const T=o.values().filter(({node:I})=>I.dataset.value===e).map(({node:I,index:Y})=>{if(!(s&&i)||Y!==0){const oe=Array.from(I.children).find(xe=>xe.getAttribute("data-label")!==null);return(oe==null?void 0:oe.innerHTML)??""}else return});W(I=>u?(T.forEach(Y=>{G(I)&&I.includes(Y??"")?t&&(I=G(I)?I.filter(xe=>xe!==Y):void 0):I=[...G(I)?I:[],Y]}),I):T[0])},[o,u,s,i]),fe=n.useCallback(e=>{R(t=>G(t)?t.includes(e)?t.filter(T=>T!==e):[...t,e]:e),de(e)},[de,R]),Ie=n.useCallback(e=>{e.stopPropagation(),R([]),W(void 0)},[W,R]),{isOpen:x,onOpen:Ce,onClose:w}=$e({isOpen:k,defaultIsOpen:h,onOpen:g,onClose:P}),D=n.useCallback(()=>{j.disabled||j.readOnly||p||M||Ce()},[j,p,M,Ce]),pe=n.useCallback(()=>{let e=o.value(E);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const t=e.node.dataset.value??"";fe(t),r&&w(),c&&Q()},[r,o,E,c,fe,w,Q]),be=n.useCallback(()=>{x||(D(),B())},[x,B,D]),he=n.useCallback(()=>{x||(D(),B())},[x,B,D]),ve=n.useCallback(e=>{const t=Ae(e);Le(V.current,t)||l&&x&&w()},[l,x,w]),ge=n.useCallback(e=>{if(e.key===" "&&(e.key=e.code),j.disabled||j.readOnly)return;const _={ArrowDown:U?()=>Q():x?void 0:le(D,B),ArrowUp:U?()=>ue():x?void 0:le(D,me),Space:U?pe:x?void 0:le(D,B),Enter:U?pe:x?void 0:le(D,B),Home:x?se:void 0,End:x?ne:void 0,Escape:a?w:void 0}[e.key];_&&(e.preventDefault(),e.stopPropagation(),_())},[j.disabled,j.readOnly,U,x,D,B,me,pe,se,ne,a,w,Q,ue]);qe({ref:V,handler:w,enabled:x&&l}),n.useEffect(()=>{if(!u||!c&&Ne(d))return;const e=S.length>0&&S.length===o.count(),t=S.length===d;e||t?(w(),z(!0)):z(!1)},[c,S,o,u,w,d]),He(()=>{x||m(-1)},[x]),Me(()=>{O.current.forEach(e=>clearTimeout(e)),O.current.clear()});const Fe=n.useCallback(e=>({matchWidth:!0,...f,...e,isOpen:x,onOpen:D,onClose:w,placement:C,duration:b,trigger:"never",closeOnButton:!1,closeOnBlur:l}),[b,l,w,D,C,f,x]),je=n.useCallback((e={},t=null)=>({ref:ce(V,t),...q,...e,...j,onClick:J(e.onClick,f.onClick,be),onBlur:J(e.onBlur,f.onBlur,ve)}),[q,j,ve,be,f]),we=n.useCallback((e={},t=null)=>({ref:ce(ae,t),tabIndex:0,...ee,...e,"data-active":X(x),"data-placeholder":X(u?!(A!=null&&A.length):A===void 0),"aria-expanded":X(x),onFocus:J(e.onFocus,f.onFocus,he),onKeyDown:J(e.onKeyDown,f.onKeyDown,ge)}),[ee,x,u,A,f,he,ge]);return{descendants:o,value:S,label:A,focusedIndex:E,placeholder:s,placeholderInOptions:i,omitSelectedValues:c,closeOnSelect:r,isOpen:x,containerRef:V,fieldRef:ae,listRef:ie,optionProps:v,formControlProps:j,onChangeLabel:de,onChange:fe,onClear:Ie,onOpen:D,onClose:w,onFocusFirst:se,onFocusLast:ne,onFocusSelected:re,onFocusNext:Q,onFocusPrev:ue,setFocusedIndex:m,getPopoverProps:Fe,getContainerProps:je,getFieldProps:we}},Ze=()=>{const{listRef:s,focusedIndex:l}=H(),a=Se(),r=n.useRef(-1),i=a.value(l);return n.useEffect(()=>{if(!s.current||!i||r.current===i.index)return;const d=s.current,p=i.node,C=d.clientHeight,b=d.scrollTop,k=b+C,h=p.clientHeight,g=p.offsetTop,P=g+h,v=b<=g&&P<=k,f=r.current<i.index;v||(P<=C?s.current.scrollTo({top:0}):f?s.current.scrollTo({top:P-C}):s.current.scrollTo({top:g+1})),r.current=i.index},[s,i]),{getListProps:n.useCallback((d={},p=null)=>({as:"ul",ref:ce(s,p),role:"select",tabIndex:-1,...d}),[s])}},et=({label:s,...l})=>{const{value:a,omitSelectedValues:r}=H(),i=G(a),c=Se(),d=c.values(),C=(i&&r?c.values(({node:v})=>a.includes(v.dataset.value??"")):[]).map(({index:v})=>v),k=!d.filter(({node:v,index:f})=>{var F;return((F=v.parentElement)==null?void 0:F.dataset.label)===s&&!C.includes(f)}).length,h=ye(l,ke),g=n.useCallback((v={},f=null)=>{const F={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};return{ref:f,...v,...h[0],style:k?F:void 0}},[h,k]),P=n.useCallback((v={},f=null)=>({ref:f,...v,...h[1],"data-label":s}),[h,s]);return{label:s,getContainerProps:g,getGroupProps:P}},tt=(s,l)=>{const{fieldRef:a,value:r,placeholder:i,placeholderInOptions:c,omitSelectedValues:d,closeOnSelect:p,focusedIndex:C,optionProps:b,onChange:k,onChangeLabel:h,onFocusNext:g,onClose:P,setFocusedIndex:v}=H();let{icon:f,isDisabled:F,isFocusable:j,closeOnSelect:q,children:ee,...o}={...b,...l};const E=!!F&&!j,m=n.useRef(null),{index:M,register:z,descendants:V}=Xe({disabled:E}),ie=V.values().slice(0,M),O=G(r),R=!(O?!1:ie.some(({node:u})=>u.dataset.value===(o.value??"")))&&(O?r.includes(o.value??""):(o.value??"")===r),A=M===C;i&&M>0&&c&&!o.value&&console.warn(`${O?"MultiSelect":"Select"}: If placeholders are present, All options must be set value. If want to set an empty value, either don't set the placeholder or set 'placeholderInOptions' to false.`);const W=n.useCallback(u=>{if(u.preventDefault(),u.stopPropagation(),F){a.current&&a.current.focus();return}if(!Ye(u.currentTarget)){a.current&&a.current.focus();return}v(M),k(o.value??""),a.current&&a.current.focus(),(q??p)&&P(),d&&g()},[F,v,M,k,o.value,a,q,p,P,d,g]);n.useEffect(()=>{R&&h(o.value??"",!1)},[o,R,h]);const U=n.useCallback((u={})=>{const te={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};return{ref:ce(m,s,z),...Pe(o,["value"]),...u,role:"select-item",tabIndex:-1,style:d&&R?te:void 0,"data-value":o.value??"","data-focus":X(A),"data-disabled":X(F),"aria-checked":_e(R),"aria-disabled":_e(F),onClick:J(o.onClick,u.onClick,W)}},[o,F,A,R,d,W,s,z]);return{isSelected:R,isFocused:A,customIcon:f,children:ee,getOptionProps:U}},st=Z(({className:s,children:l,__css:a,...r},i)=>{const{styles:c}=H(),d={position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",cursor:"pointer",...c.icon,...a},C=Ue(l).map(b=>n.cloneElement(b,{focusable:!1,"aria-hidden":!0,style:{maxWidth:"1em",maxHeight:"1em",color:"currentColor"}}));return y.jsx(K.div,{ref:i,className:$("ui-select__icon",s),__css:d,...r,children:Ge(l)?C:y.jsx(Oe,{})})}),_t=({className:s,children:l,...a})=>{const r=n.useRef(null),{styles:i}=H(),c=a.disabled,d=De({ref:r,isDisabled:c,...a});return y.jsx(st,{"aria-label":"Clear value",className:$("ui-select__clear-icon",s),__css:i.clearIcon,...d,children:l??y.jsx(Re,{w:"0.5em",h:"0.5em"})})},yt=Z(({className:s,w:l,width:a,minW:r,minWidth:i,...c},d)=>{var k,h,g,P;const{styles:p}=H(),{getListProps:C}=Ze();l=l??a??((k=p.list)==null?void 0:k.w)??((h=p.list)==null?void 0:h.width),r=r??i??((g=p.list)==null?void 0:g.minW)??((P=p.list)==null?void 0:P.minWidth);const b={...p.list};return y.jsx(Ke,{className:$("ui-select__list",s),w:l,minW:r,__css:b,...C(c,d)})}),kt=Z(({className:s,color:l,h:a,height:r,minH:i,minHeight:c,children:d,...p},C)=>{const{styles:b}=H(),{label:k,getContainerProps:h,getGroupProps:g}=et(p);return a??(a=r),i??(i=c),y.jsxs(K.li,{className:$("ui-select__item","ui-select__item--group",s),__css:{w:"100%",h:"fit-content",color:l},...h(),children:[y.jsx(K.span,{className:"ui-select__item__group-label",__css:b.groupLabel,lineClamp:1,children:k}),y.jsx(K.ul,{...g({},C),className:"ui-select__item__group",__css:{h:a,minH:i,...b.group},children:d})]})}),Pt=Z(({className:s,icon:l,...a},r)=>{const{styles:i}=H(),{isSelected:c,customIcon:d,children:p,getOptionProps:C}=tt(r,a);l??(l=d);const b={textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,gap:"0.75rem",...i.item};return y.jsxs(K.li,{className:$("ui-select__item",s),__css:b,...C(),children:[l!==null?y.jsx(nt,{opacity:c?1:0,children:l||y.jsx(ot,{})}):null,y.jsx(K.span,{style:{flex:1},"data-label":!0,children:p})]})}),nt=Z(({className:s,...l},a)=>{const{styles:r}=H(),i={flexShrink:0,display:"inline-flex",justifyContent:"center",alignItems:"center",fontSize:"0.85em",...r.itemIcon};return y.jsx(K.span,{ref:a,className:$("ui-select__item__icon",s),__css:i,...l})}),ot=()=>y.jsx("svg",{viewBox:"0 0 14 14",width:"1em",height:"1em",children:y.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})});export{Pt as O,ht as S,kt as a,vt as b,st as c,yt as d,H as e,_t as f,gt as u};
