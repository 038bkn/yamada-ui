import{j as D,a as Ce}from"./jsx-runtime-TtYKBvr-.js";import{u as Ie}from"./index-ykno15jz.js";import{r as s}from"./index-IybTgENJ.js";import{c as Fe,a as we}from"./icon-yFQ9IdhB.js";import{f as q}from"./forward-ref-6T0UNPU-.js";import{c as De,O as Oe,Z as be,_ as he,f as M,a2 as Ee,N as Re,i as Te,y as Le,a5 as Ae,v as se,h as Z,o as ve,H as $,G as xe,a6 as Ne,X as te,p as je,u as G,a as V,R as Be}from"./factory-K2EgzEzN.js";import{b as He}from"./popover-content-zpC-7DDL.js";import{u as Me}from"./index-y9z28jgy.js";import{c as Ge}from"./index-43vpOPk2.js";import{u as Ke}from"./index-WyTAf6m6.js";import{u as Ue,f as Ve}from"./form-control-LOzWsmTb.js";const We=l=>{var c;return Ne(l)&&!!((c=l==null?void 0:l.getAttribute("role"))!=null&&c.startsWith("select-item"))},{DescendantsContextProvider:ft,useDescendantsContext:ge,useDescendants:ze,useDescendant:Xe}=Ge(),[pt,j]=De({strict:!1,name:"SelectContext"}),mt=({defaultIsOpen:l,placeholder:c,closeOnBlur:a=!0,closeOnEsc:u=!0,closeOnSelect:r=!0,placeholderInOptions:m=!0,omitSelectedValues:n=!1,maxSelectedValues:d,isEmpty:v,placement:g="bottom-start",duration:y=.2,optionProps:k,...o})=>{o=Ue(o);const f=Oe(o,Ve),C=be(o,he),i=ze(),[x,b]=s.useState(-1),[W,J]=s.useState(!1),_=s.useRef(null),Q=s.useRef(null),ne=s.useRef(null),I=s.useRef(new Set([])),[S,K]=Me({value:o.value,defaultValue:o.defaultValue,onChange:o.onChange}),[H,z]=s.useState(void 0),A=x>-1,h=M(S),N=(h?!S.length:!S)&&!(c&&m),O=i.values(({node:e})=>h&&S.includes(e.dataset.value??"")).map(({index:e})=>e),E=i.enabledValues(({index:e})=>!O.includes(e)),F=s.useCallback(()=>{const e=setTimeout(()=>{const t=i.enabledFirstValue();if(t)if(!h||!n)b(t.index);else if(O.includes(t.index)){const P=E[0];b(P.index)}else b(t.index)});I.current.add(e)},[i,E,h,n,O]),U=s.useCallback(()=>{const e=setTimeout(()=>{const t=i.enabledLastValue();if(t)if(!h||!n)b(t.index);else if(O.includes(t.index)){const P=E.reverse()[0];b(P.index)}else b(t.index)});I.current.add(e)},[i,E,h,n,O]),oe=s.useCallback(()=>{const e=setTimeout(()=>{const P=i.enabledValues().find(({node:L})=>h?S.includes(L.dataset.value??""):L.dataset.value===S);P&&b(P.index)});I.current.add(e)},[i,h,S]),X=s.useCallback(()=>{const e=setTimeout(()=>{const t=i.enabledNextValue(x);if(t)if(!h||!n)b(t.index);else if(O.includes(t.index)){const P=E.find(({index:L})=>t.index<L)??E[0];b(P.index)}else b(t.index)});I.current.add(e)},[i,E,x,h,n,O,b]),le=s.useCallback(()=>{const e=setTimeout(()=>{const t=i.enabledPrevValue(x);if(t)if(!h||!n)b(t.index);else if(O.includes(t.index)){const P=E.reverse().find(({index:L})=>L<t.index)??E[0];b(P.index)}else b(t.index)});I.current.add(e)},[i,E,x,h,n,O,b]),B=N||n?F:oe,re=N||n?U:oe,ce=s.useCallback((e,t=!0)=>{const L=i.values().filter(({node:w})=>w.dataset.value===e).map(({node:w,index:Y})=>!(c&&m)||Y!==0?w.textContent??"":void 0);z(w=>h?(L.forEach(Y=>{M(w)&&w.includes(Y??"")?t&&(w=M(w)?w.filter(Pe=>Pe!==Y):void 0):w=[...M(w)?w:[],Y]}),w):L[0])},[i,h,c,m]),ae=s.useCallback(e=>{K(t=>M(t)?t.includes(e)?t.filter(L=>L!==e):[...t,e]:e),ce(e)},[ce,K]),_e=s.useCallback(e=>{e.stopPropagation(),K([]),z(void 0)},[z,K]),[p,ue]=s.useState(l??!1),R=s.useCallback(()=>{var e;f.disabled||f.readOnly||v||W||(ue(!0),(e=o.onOpen)==null||e.call(o))},[f,v,W,o]),T=s.useCallback(()=>{var e;ue(!1),(e=o.onClose)==null||e.call(o)},[o]),ie=s.useCallback(()=>{let e=i.value(x);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const t=e.node.dataset.value??"";ae(t),r&&T(),n&&X()},[r,i,x,n,ae,T,X]),de=s.useCallback(()=>{p||(R(),B())},[p,B,R]),fe=s.useCallback(()=>{p||(R(),B())},[p,B,R]),pe=s.useCallback(e=>{const t=Ee(e);Re(_.current,t)||a&&p&&T()},[a,p,T]),me=s.useCallback(e=>{if(e.key===" "&&(e.key=e.code),f.disabled||f.readOnly)return;const P={ArrowDown:A?()=>X():p?void 0:te(R,B),ArrowUp:A?()=>le():p?void 0:te(R,re),Space:A?ie:p?void 0:te(R,B),Enter:A?ie:p?void 0:te(R,B),Home:p?F:void 0,End:p?U:void 0,Escape:u?T:void 0}[e.key];P&&(e.preventDefault(),e.stopPropagation(),P())},[f.disabled,f.readOnly,A,p,R,B,re,ie,F,U,u,T,X,le]);Ke({ref:_,handler:T,enabled:a}),s.useEffect(()=>{if(!h||!n&&Te(d))return;const e=S.length>0&&S.length===i.count(),t=S.length===d;e||t?(T(),J(!0)):J(!1)},[n,S,i,h,T,d]),Le(()=>{p||b(-1)},[p]),Ae(()=>{I.current.forEach(e=>clearTimeout(e)),I.current.clear()});const ke=s.useCallback(e=>({matchWidth:!0,...o,...e,isOpen:p,onOpen:R,onClose:T,placement:g,duration:y,trigger:"never",closeOnButton:!1}),[y,T,R,g,o,p]),ye=s.useCallback((e={},t=null)=>({ref:se(_,t),...C[0],...e,...f,onClick:Z(e.onClick,o.onClick,de),onBlur:Z(e.onBlur,o.onBlur,pe)}),[C,f,pe,de,o]),Se=s.useCallback((e={},t=null)=>({ref:se(Q,t),tabIndex:0,...ve(C[1],["value","defaultValue","onChange"]),...e,"data-active":$(p),"data-placeholder":$(h?!(H!=null&&H.length):H===void 0),"aria-expanded":$(p),onFocus:Z(e.onFocus,o.onFocus,fe),onKeyDown:Z(e.onKeyDown,o.onKeyDown,me)}),[C,p,h,H,o,fe,me]);return{descendants:i,value:S,label:H,focusedIndex:x,placeholder:c,placeholderInOptions:m,omitSelectedValues:n,closeOnSelect:r,isOpen:p,containerRef:_,fieldRef:Q,listRef:ne,optionProps:k,formControlProps:f,onChangeLabel:ce,onChange:ae,onClear:_e,onOpen:R,onClose:T,onFocusFirst:F,onFocusLast:U,onFocusSelected:oe,onFocusNext:X,onFocusPrev:le,setFocusedIndex:b,getPopoverProps:ke,getContainerProps:ye,getFieldProps:Se}},Ye=()=>{const{listRef:l,focusedIndex:c}=j(),a=ge(),u=s.useRef(-1),r=a.value(c);return s.useEffect(()=>{if(!l.current||!r||u.current===r.index)return;const n=l.current,d=r.node,v=n.clientHeight,g=n.scrollTop,y=g+v,k=d.clientHeight,o=d.offsetTop,f=o+k,C=g<=o&&f<=y,i=u.current<r.index;C||(f<=v?l.current.scrollTo({top:0}):i?l.current.scrollTo({top:f-v}):l.current.scrollTo({top:o+1})),u.current=r.index},[l,r]),{getListProps:s.useCallback((n={},d=null)=>({as:"ul",ref:se(l,d),role:"select",tabIndex:-1,...n}),[l])}},Ze=({label:l,...c})=>{const{value:a,omitSelectedValues:u}=j(),r=M(a),m=ge(),n=m.values(),v=(r&&u?m.values(({node:C})=>a.includes(C.dataset.value??"")):[]).map(({index:C})=>C),y=!n.filter(({node:C,index:i})=>{var x;return((x=C.parentElement)==null?void 0:x.dataset.label)===l&&!v.includes(i)}).length,k=be(c,he),o=s.useCallback((C={},i=null)=>{const x={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};return{ref:i,...C,...k[0],style:y?x:void 0}},[k,y]),f=s.useCallback((C={},i=null)=>({ref:i,...C,...k[1],"data-label":l}),[k,l]);return{label:l,getContainerProps:o,getGroupProps:f}},$e=(l,c)=>{const{fieldRef:a,value:u,placeholder:r,placeholderInOptions:m,omitSelectedValues:n,closeOnSelect:d,focusedIndex:v,optionProps:g,onChange:y,onChangeLabel:k,onFocusNext:o,onClose:f,setFocusedIndex:C}=j();let{icon:i,isDisabled:x,isFocusable:b,closeOnSelect:W,children:J,..._}={...g,...c};const Q=!!x&&!b,ne=s.useRef(null),{index:I,register:S,descendants:K}=Xe({disabled:Q}),z=K.values().slice(0,I),A=M(u),N=!(A?!1:z.some(({node:F})=>F.dataset.value===(_.value??"")))&&(A?u.includes(_.value??""):(_.value??"")===u),ee=I===v;r&&I>0&&m&&!_.value&&console.warn(`${A?"MultiSelect":"Select"}: If placeholders are present, All options must be set value. If want to set an empty value, either don't set the placeholder or set 'placeholderInOptions' to false.`);const O=s.useCallback(F=>{if(F.preventDefault(),F.stopPropagation(),x){a.current&&a.current.focus();return}if(!We(F.currentTarget)){a.current&&a.current.focus();return}C(I),y(_.value??""),a.current&&a.current.focus(),(W??d)&&f(),n&&o()},[x,C,I,y,_.value,a,W,d,f,n,o]);s.useEffect(()=>{N&&k(_.value??"",!1)},[_,N,k]);const E=s.useCallback((F={})=>{const U={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};return{ref:se(ne,l,S),...ve(_,["value"]),...F,role:"select-item",tabIndex:-1,style:n&&N?U:void 0,"data-value":_.value??"","data-focus":$(ee),"data-disabled":$(x),"aria-checked":xe(N),"aria-disabled":xe(x),onClick:Z(_.onClick,F.onClick,O)}},[_,x,ee,N,n,O,l,S]);return{isSelected:N,isFocused:ee,customIcon:i,children:J,getOptionProps:E}},qe=q(({className:l,children:c,__css:a,...u},r)=>{const{styles:m}=j(),n={position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",cursor:"pointer",...m.icon,...a},v=je(c).map(g=>s.cloneElement(g,{focusable:!1,"aria-hidden":!0,style:{maxWidth:"1em",maxHeight:"1em",color:"currentColor"}}));return D(G.div,{ref:r,className:V("ui-select__icon",l),__css:n,...u,children:Be(c)?v:D(Fe,{})})}),xt=({className:l,children:c,...a})=>{const u=s.useRef(null),{styles:r}=j(),m=a.disabled,n=Ie({ref:u,isDisabled:m,...a});return D(qe,{"aria-label":"Clear value",className:V("ui-select__clear-icon",l),__css:r.clearIcon,...n,children:c??D(we,{w:"0.5em",h:"0.5em"})})},Ct=q(({className:l,w:c,width:a,minW:u,minWidth:r,...m},n)=>{var y,k,o,f;const{styles:d}=j(),{getListProps:v}=Ye();c=c??a??((y=d.list)==null?void 0:y.w)??((k=d.list)==null?void 0:k.width),u=u??r??((o=d.list)==null?void 0:o.minW)??((f=d.list)==null?void 0:f.minWidth);const g={...d.list};return D(He,{className:V("ui-select__list",l),w:c,minW:u,__css:g,...v(m,n)})}),bt=q(({className:l,color:c,h:a,height:u,minH:r,minHeight:m,children:n,...d},v)=>{const{styles:g}=j(),{label:y,getContainerProps:k,getGroupProps:o}=Ze(d);return a??(a=u),r??(r=m),Ce(G.li,{className:V("ui-select__item","ui-select__item--group",l),__css:{w:"100%",h:"fit-content",color:c},...k(),children:[D(G.span,{className:"ui-select__item__group-label",__css:g.groupLabel,lineClamp:1,children:y}),D(G.ul,{...o({},v),className:"ui-select__item__group",__css:{h:a,minH:r,...g.group},children:n})]})}),ht=q(({className:l,icon:c,...a},u)=>{const{styles:r}=j(),{isSelected:m,customIcon:n,children:d,getOptionProps:v}=$e(u,a);c??(c=n);const g={textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,gap:"0.75rem",...r.item};return Ce(G.li,{className:V("ui-select__item",l),__css:g,...v(),children:[c!==null?D(Je,{opacity:m?1:0,children:c||D(Qe,{})}):null,c?D(G.span,{style:{pointerEvents:"none",flex:1},lineClamp:1,children:d}):d]})}),Je=q(({className:l,...c},a)=>{const{styles:u}=j(),r={flexShrink:0,display:"inline-flex",justifyContent:"center",alignItems:"center",fontSize:"0.85em",...u.itemIcon};return D(G.span,{ref:a,className:V("ui-select__item__icon",l),__css:r,...c})}),Qe=()=>D("svg",{viewBox:"0 0 14 14",width:"1em",height:"1em",children:D("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})});export{ht as O,ft as S,bt as a,pt as b,qe as c,Ct as d,j as e,xt as f,mt as u};
