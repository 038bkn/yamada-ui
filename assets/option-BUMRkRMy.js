import{j as I}from"./jsx-runtime-Nms4Y4qS.js";import{u as Oe}from"./index-mMbOwMyI.js";import{r as n}from"./index-BwDkhjyp.js";import{c as we,a as Re}from"./icon-SoeERY4p.js";import{f as X}from"./forward-ref-BmTAT9U5.js";import{l as Te,T as Ee,a1 as ye,a2 as Se,R as Ae,s as G,a9 as Le,U as Ne,q as He,f as Me,S as Be,a as ce,h as Q,d as ae,x as ke,aK as Ke,V as le,t as Ue,b as W,c as $,j as Ve}from"./factory-CEsHZeW8.js";import{b as Ge}from"./popover-content-CYV3XEV7.js";import{u as We}from"./index-AEOZ2ZJT.js";import{c as $e}from"./index-eSD88g-m.js";import{u as qe}from"./index-B0VytHna.js";import{u as ze}from"./index-BC2fJpjq.js";import{u as Ye,f as Je}from"./form-control-C8wk9nRT.js";const Qe=t=>{var i;return Ke(t)&&!!((i=t==null?void 0:t.getAttribute("role"))!=null&&i.startsWith("option"))},{DescendantsContextProvider:ht,useDescendantsContext:Ie,useDescendants:Xe,useDescendant:Ze}=$e(),[gt,H]=Te({strict:!1,name:"SelectContext"}),vt=({placeholder:t,closeOnBlur:i=!0,closeOnEsc:o=!0,closeOnSelect:r=!0,placeholderInOptions:a=!0,omitSelectedValues:l=!1,maxSelectValues:p,isEmpty:d,placement:m="bottom-start",duration:g=.2,isOpen:v,defaultIsOpen:_,onOpen:j,onClose:D,optionProps:b,...u})=>{u=Ye(u);const{"aria-readonly":k,...w}=Ee(u,Je),[q,Z]=ye(Ae(u,["value","defaultValue","onChange","aria-readonly"]),Se),c=Xe(),[P,C]=n.useState(-1),[ee,M]=n.useState(!1),U=n.useRef(null),te=n.useRef(null),ie=n.useRef(null),L=n.useRef(new Set([])),[y,z]=We({value:u.value,defaultValue:u.defaultValue,onChange:u.onChange}),[O,V]=n.useState(void 0),B=P>-1,x=G(y),E=(x?!y.length:!y)&&!(t&&a),N=c.values(({node:e})=>x&&y.includes(e.dataset.value??"")).map(({index:e})=>e),A=c.enabledValues(({index:e})=>!N.includes(e)),se=n.useCallback(()=>{const e=setTimeout(()=>{const s=c.enabledFirstValue();if(s)if(!x||!l)C(s.index);else if(N.includes(s.index)){const h=A[0];C(h.index)}else C(s.index)});L.current.add(e)},[c,A,x,l,N]),ne=n.useCallback(()=>{const e=setTimeout(()=>{const s=c.enabledLastValue();if(s)if(!x||!l)C(s.index);else if(N.includes(s.index)){const h=A.reverse()[0];C(h.index)}else C(s.index)});L.current.add(e)},[c,A,x,l,N]),re=n.useCallback(()=>{const e=setTimeout(()=>{const h=c.enabledValues().find(({node:F})=>x?y.includes(F.dataset.value??""):F.dataset.value===y);h&&C(h.index)});L.current.add(e)},[c,x,y]),Y=n.useCallback(()=>{const e=setTimeout(()=>{const s=c.enabledNextValue(P);if(s)if(!x||!l)C(s.index);else if(N.includes(s.index)){const h=A.find(({index:F})=>s.index<F)??A[0];C(h.index)}else C(s.index)});L.current.add(e)},[c,A,P,x,l,N,C]),ue=n.useCallback(()=>{const e=setTimeout(()=>{const s=c.enabledPrevValue(P);if(s)if(!x||!l)C(s.index);else if(N.includes(s.index)){const h=A.reverse().find(({index:F})=>F<s.index)??A[0];C(h.index)}else C(s.index)});L.current.add(e)},[c,A,P,x,l,N,C]),K=E||l?se:re,be=E||l?ne:re,de=n.useCallback((e,s=!0)=>{const h=c.values();if(!h.length)return;const F=h.filter(({node:S})=>S.dataset.value===e).map(({node:S,index:J})=>{if(!(t&&a)||J!==0){const oe=Array.from(S.children).find(xe=>xe.getAttribute("data-label")!==null);return(oe==null?void 0:oe.innerHTML)??""}else return});V(S=>x?(F.forEach(J=>{G(S)&&S.includes(J??"")?s&&(S=G(S)?S.filter(xe=>xe!==J):void 0):S=[...G(S)?S:[],J]}),S):F[0])},[c,x,t,a]),fe=n.useCallback(e=>{z(s=>G(s)?s.includes(e)?s.filter(F=>F!==e):[...s,e]:e),de(e)},[de,z]),Pe=n.useCallback(e=>{e.stopPropagation(),z([]),V(void 0)},[V,z]),{isOpen:f,onOpen:Ce,onClose:R}=qe({isOpen:v,defaultIsOpen:_,onOpen:j,onClose:D}),T=n.useCallback(()=>{w.disabled||w.readOnly||d||ee||Ce()},[w,d,ee,Ce]),pe=n.useCallback(()=>{let e=c.value(P);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const s=e.node.dataset.value??"";fe(s),r&&R(),l&&Y()},[r,c,P,l,fe,R,Y]),he=n.useCallback(()=>{f||(T(),K())},[f,K,T]),ge=n.useCallback(()=>{f||(T(),K())},[f,K,T]),ve=n.useCallback(e=>{const s=Le(e);Ne(U.current,s)||i&&f&&R()},[i,f,R]),_e=n.useCallback(e=>{if(e.key===" "&&(e.key=e.code),w.disabled||w.readOnly)return;const h={ArrowDown:B?()=>Y():f?void 0:le(T,K),ArrowUp:B?()=>ue():f?void 0:le(T,be),Space:B?pe:f?void 0:le(T,K),Enter:B?pe:f?void 0:le(T,K),Home:f?se:void 0,End:f?ne:void 0,Escape:o?R:void 0}[e.key];h&&(e.preventDefault(),e.stopPropagation(),h())},[w.disabled,w.readOnly,B,f,T,K,be,pe,se,ne,o,R,Y,ue]);ze({ref:U,handler:R,enabled:f&&i}),n.useEffect(()=>{if(!x||!l&&He(p))return;const e=y.length>0&&y.length===c.count(),s=y.length===p;e||s?(R(),M(!0)):M(!1)},[l,y,c,x,R,p]),Me(()=>{f||C(-1)},[f]),Be(()=>{L.current.forEach(e=>clearTimeout(e)),L.current.clear()});const Fe=n.useCallback(e=>({matchWidth:!0,...u,...e,isOpen:f,onOpen:T,onClose:R,placement:m,duration:g,trigger:"never",closeOnButton:!1,closeOnBlur:i}),[g,i,R,T,m,u,f]),je=n.useCallback((e={},s=null)=>({ref:ce(U,s),...q,...e,...w,onClick:Q(e.onClick,u.onClick,he),onBlur:Q(e.onBlur,u.onBlur,ve)}),[q,w,ve,he,u]),De=n.useCallback(({"aria-label":e,...s}={},h=null)=>{var F,S;return e??(e=t??`Select ${x?"one or more options.":"an option."}`),{"aria-label":e,role:"combobox",ref:ce(te,h),tabIndex:0,...Z,...s,"data-active":ae(f),"data-placeholder":ae(x?!(O!=null&&O.length):O===void 0),"aria-controls":(F=ie.current)==null?void 0:F.id,"aria-activedescendant":(S=c.value(P))==null?void 0:S.node.id,"aria-expanded":f,onFocus:Q(s.onFocus,u.onFocus,ge),onKeyDown:Q(s.onKeyDown,u.onKeyDown,_e)}},[c,Z,P,f,x,O,t,u,ge,_e]);return{descendants:c,value:y,label:O,focusedIndex:P,placeholder:t,placeholderInOptions:a,omitSelectedValues:l,closeOnSelect:r,isOpen:f,containerRef:U,fieldRef:te,listRef:ie,optionProps:b,formControlProps:w,onChangeLabel:de,onChange:fe,onClear:Pe,onOpen:T,onClose:R,onFocusFirst:se,onFocusLast:ne,onFocusSelected:re,onFocusNext:Y,onFocusPrev:ue,setFocusedIndex:C,getPopoverProps:Fe,getContainerProps:je,getFieldProps:De}},et=()=>{const{listRef:t,focusedIndex:i}=H(),o=Ie(),r=n.useRef(-1),a=o.value(i);n.useEffect(()=>{if(!t.current||!a||r.current===a.index)return;const d=t.current,m=a.node,g=d.clientHeight,v=d.scrollTop,_=v+g,j=m.clientHeight,D=m.offsetTop,b=D+j,u=v<=D&&b<=_,k=r.current<a.index;u||(b<=g?t.current.scrollTo({top:0}):k?t.current.scrollTo({top:b-g}):t.current.scrollTo({top:D+1})),r.current=a.index},[t,a]);const l=n.useId();return{getListProps:n.useCallback((d={},m=null)=>({id:l,as:"ul",ref:ce(t,m),role:"listbox",tabIndex:-1,...d}),[l,t])}},tt=({label:t,...i})=>{const{value:o,omitSelectedValues:r}=H(),a=G(o),l=Ie(),p=l.values(),m=(a&&r?l.values(({node:b})=>o.includes(b.dataset.value??"")):[]).map(({index:b})=>b),v=!p.filter(({node:b,index:u})=>{var k;return((k=b.parentElement)==null?void 0:k.dataset.label)===t&&!m.includes(u)}).length,_=ye(i,Se),j=n.useCallback((b={},u=null)=>{const k={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};return{ref:u,...b,..._[0],style:v?k:void 0}},[_,v]),D=n.useCallback(({"aria-label":b,...u}={},k=null)=>(b??(b=t),{"aria-label":b,ref:k,role:"group",...u,..._[1],"data-label":t}),[_,t]);return{label:t,getContainerProps:j,getGroupProps:D}},st=(t,i)=>{const{fieldRef:o,value:r,placeholder:a,placeholderInOptions:l,omitSelectedValues:p,closeOnSelect:d,focusedIndex:m,optionProps:g,onChange:v,onChangeLabel:_,onFocusNext:j,onClose:D,setFocusedIndex:b}=H();let{icon:u,isDisabled:k,isFocusable:w,closeOnSelect:q,children:Z,value:c,...P}={...g,...i};const C=!!k&&!w,ee=n.useRef(null),{index:M,register:U,descendants:te}=Ze({disabled:C}),L=te.values().slice(0,M),y=G(r),O=!(y?!1:L.some(({node:E})=>E.dataset.value===(c??"")))&&(y?r.includes(c??""):(c??"")===r),V=M===m;a&&M>0&&l&&!c&&console.warn(`${y?"MultiSelect":"Select"}: If placeholders are present, All options must be set value. If want to set an empty value, either don't set the placeholder or set 'placeholderInOptions' to false.`);const B=n.useCallback(E=>{if(E.preventDefault(),E.stopPropagation(),k){o.current&&o.current.focus();return}if(!Qe(E.currentTarget)){o.current&&o.current.focus();return}b(M),v(c??""),o.current&&o.current.focus(),(q??d)&&D(),p&&j()},[k,b,M,v,c,o,q,d,D,p,j]);n.useEffect(()=>{O&&_(c??"",!1)},[c,O,_]);const x=n.useCallback((E={})=>{const me={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};return{role:"option",ref:ce(ee,t,U),...P,...E,tabIndex:-1,style:p&&O?me:void 0,"data-value":c??"","data-focus":ae(V),"data-disabled":ae(k),"aria-checked":ke(O),"aria-disabled":ke(k),onClick:Q(P.onClick,E.onClick,B)}},[c,P,k,V,O,p,B,t,U]);return{isSelected:O,isFocused:V,customIcon:u,children:Z,getOptionProps:x}},nt=X(({className:t,children:i,__css:o,...r},a)=>{const{styles:l}=H(),p={position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",cursor:"pointer",...l.icon,...o},m=Ue(i).map(g=>n.cloneElement(g,{focusable:!1,"aria-hidden":!0,style:{maxWidth:"1em",maxHeight:"1em",color:"currentColor"}}));return I.jsx(W.div,{ref:a,className:$("ui-select__icon",t),__css:p,...r,children:Ve(i)?m:I.jsx(we,{})})}),_t=({className:t,children:i,...o})=>{const r=n.useRef(null),{styles:a}=H(),l=o.disabled,p=Oe({ref:r,isDisabled:l,...o});return I.jsx(nt,{"aria-label":"Clear value",className:$("ui-select__clear-icon",t),__css:a.clearIcon,...p,children:i??I.jsx(Re,{w:"0.5em",h:"0.5em"})})},kt=X(({className:t,w:i,width:o,minW:r,minWidth:a,...l},p)=>{var v,_,j,D;const{styles:d}=H(),{getListProps:m}=et();o??(o=i),o??(o=((v=d.list)==null?void 0:v.width)??((_=d.list)==null?void 0:_.w)),a??(a=r),a??(a=((j=d.list)==null?void 0:j.minWidth)??((D=d.list)==null?void 0:D.minW));const g={...d.list,width:o,minWidth:a};return I.jsx(Ge,{className:$("ui-select__list",t),width:o,minWidth:a,__css:g,...m(l,p)})}),yt=X(({className:t,color:i,h:o,height:r,minH:a,minHeight:l,children:p,...d},m)=>{const{styles:g}=H(),{label:v,getContainerProps:_,getGroupProps:j}=tt(d);return o??(o=r),a??(a=l),I.jsxs(W.li,{className:$("ui-select__item","ui-select__item--group",t),__css:{w:"100%",h:"fit-content",color:i},..._(),children:[I.jsx(W.span,{className:"ui-select__item__group-label",__css:g.groupLabel,lineClamp:1,children:v}),I.jsx(W.ul,{...j({},m),className:"ui-select__item__group",__css:{h:o,minH:a,...g.group},children:p})]})}),St=X(({id:t,className:i,icon:o,...r},a)=>{const{styles:l}=H(),{isSelected:p,customIcon:d,children:m,getOptionProps:g}=st(a,r);t??(t=n.useId()),o??(o=d);const v={textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,gap:"0.75rem",...l.item};return I.jsxs(W.li,{id:t,className:$("ui-select__item",i),__css:v,...g(),children:[o!==null?I.jsx(ot,{opacity:p?1:0,children:o||I.jsx(lt,{})}):null,I.jsx(W.span,{style:{flex:1},"data-label":!0,children:m})]})}),ot=X(({className:t,...i},o)=>{const{styles:r}=H(),a={flexShrink:0,display:"inline-flex",justifyContent:"center",alignItems:"center",fontSize:"0.85em",...r.itemIcon};return I.jsx(W.span,{ref:o,className:$("ui-select__item__icon",t),__css:a,...i})}),lt=()=>I.jsx("svg",{viewBox:"0 0 14 14",width:"1em",height:"1em",children:I.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})});export{St as O,ht as S,yt as a,gt as b,nt as c,kt as d,H as e,_t as f,vt as u};
