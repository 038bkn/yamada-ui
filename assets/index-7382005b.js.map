{"version":3,"file":"index-7382005b.js","sources":["../../packages/hooks/use-animation/src/index.ts"],"sourcesContent":["import type { AnimationStyle, Theme } from \"@yamada-ui/core\"\nimport { useTheme, generateAnimation } from \"@yamada-ui/core\"\nimport { useBoolean } from \"@yamada-ui/use-boolean\"\nimport { useEventListener } from \"@yamada-ui/use-event-listener\"\nimport {\n  isArray,\n  isUndefined,\n  runIfFunc,\n  getOwnerWindow,\n} from \"@yamada-ui/utils\"\nimport { useCallback, useEffect, useRef, useState } from \"react\"\n\ntype Styles =\n  | AnimationStyle\n  | Theme[\"animations\"]\n  | (AnimationStyle | Theme[\"animations\"])[]\n\nexport const useAnimation = (styles: Styles): string => {\n  const { theme } = useTheme()\n\n  if (isArray(styles)) {\n    return styles.map((style) => generateAnimation(style, theme)).join(\", \")\n  } else {\n    return generateAnimation(styles, theme)\n  }\n}\n\nexport const useDynamicAnimation = <\n  T extends (AnimationStyle | Theme[\"animations\"])[] | Record<string, Styles>,\n>(\n  arrayOrObj: T,\n  init?: keyof T | (keyof T)[],\n): [\n  string | undefined,\n  (\n    key:\n      | keyof T\n      | (keyof T)[]\n      | ((key: keyof T | (keyof T)[] | undefined) => keyof T | (keyof T)[]),\n  ) => void,\n] => {\n  const { theme } = useTheme()\n\n  const keys = useRef<string | string[] | undefined>(\n    !isUndefined(init)\n      ? isArray(init)\n        ? init.map(String)\n        : String(init)\n      : undefined,\n  )\n  const cache = useRef<Map<string, string>>(new Map<string, string>())\n\n  const [animations, setAnimations] = useState<string | undefined>(() => {\n    for (const [key, styles] of Object.entries(arrayOrObj)) {\n      if (cache.current.has(key)) return\n\n      if (isArray(styles)) {\n        cache.current.set(\n          key,\n          styles.map((style) => generateAnimation(style, theme)).join(\", \"),\n        )\n      } else {\n        cache.current.set(key, generateAnimation(styles, theme))\n      }\n    }\n\n    if (isArray(keys.current)) {\n      return keys.current.map((key) => cache.current.get(key)).join(\", \")\n    } else {\n      return cache.current.get(keys.current ?? \"\")\n    }\n  })\n\n  const setAnimation = useCallback(\n    (\n      keysOrFunc:\n        | keyof T\n        | (keyof T)[]\n        | ((key: keyof T | (keyof T)[] | undefined) => keyof T | (keyof T)[]),\n    ) => {\n      const args = (() => {\n        if (!isUndefined(keys.current) && isArray(arrayOrObj)) {\n          return isArray(keys.current)\n            ? keys.current.map(Number)\n            : Number(keys.current)\n        } else {\n          return keys.current\n        }\n      })() as keyof T | (keyof T)[] | undefined\n\n      const keyOrArray = runIfFunc(keysOrFunc, args)\n\n      keys.current = isArray(keyOrArray)\n        ? keyOrArray.map(String)\n        : String(keyOrArray)\n\n      if (isArray(keys.current)) {\n        setAnimations(\n          keys.current.map((key) => cache.current.get(key)).join(\", \"),\n        )\n      } else {\n        setAnimations(cache.current.get(keys.current ?? \"\"))\n      }\n    },\n    [arrayOrObj],\n  )\n\n  return [animations, setAnimation]\n}\n\nexport type UseAnimationObserverProps = {\n  isOpen: boolean\n  ref: React.RefObject<HTMLElement>\n}\n\nexport const useAnimationObserver = ({\n  isOpen,\n  ref,\n}: UseAnimationObserverProps) => {\n  const [mounted, setMounted] = useState(isOpen)\n  const [flg, { on }] = useBoolean()\n\n  useEffect(() => {\n    if (flg) return\n\n    setMounted(isOpen)\n    on()\n  }, [isOpen, flg, on])\n\n  useEventListener(\n    () => ref.current,\n    \"animationend\",\n    () => setMounted(isOpen),\n  )\n\n  const hidden = isOpen ? false : !mounted\n\n  return {\n    present: !hidden,\n    onAnimationComplete() {\n      const ownerWindow = getOwnerWindow(ref.current)\n      const ev = new ownerWindow.CustomEvent(\"animationend\", {\n        bubbles: true,\n      })\n\n      ref.current?.dispatchEvent(ev)\n    },\n  }\n}\n\nexport type ReturnUseAnimationObserver = ReturnType<typeof useAnimationObserver>\n"],"names":["useAnimation","styles","theme","useTheme","isArray","style","generateAnimation","useDynamicAnimation","arrayOrObj","init","keys","useRef","isUndefined","cache","animations","setAnimations","useState","key","setAnimation","useCallback","keysOrFunc","args","keyOrArray","runIfFunc","useAnimationObserver","isOpen","ref","mounted","setMounted","flg","on","useBoolean","useEffect","useEventListener","ownerWindow","getOwnerWindow","ev","_a"],"mappings":"+OAiBa,MAAAA,EAAgBC,GAA2B,CAChD,KAAA,CAAE,MAAAC,GAAUC,IAEd,OAAAC,EAAQH,CAAM,EACTA,EAAO,IAAKI,GAAUC,EAAkBD,EAAOH,CAAK,CAAC,EAAE,KAAK,IAAI,EAEhEI,EAAkBL,EAAQC,CAAK,CAE1C,EAEaK,EAAsB,CAGjCC,EACAC,IASG,CACG,KAAA,CAAE,MAAAP,GAAUC,IAEZO,EAAOC,EAAA,OACVC,EAAYH,CAAI,EAIb,OAHAL,EAAQK,CAAI,EACVA,EAAK,IAAI,MAAM,EACf,OAAOA,CAAI,CACb,EAEAI,EAAQF,EAAAA,OAAgC,IAAA,GAAqB,EAE7D,CAACG,EAAYC,CAAa,EAAIC,WAA6B,IAAM,CACrE,SAAW,CAACC,EAAKhB,CAAM,IAAK,OAAO,QAAQO,CAAU,EAAG,CAClD,GAAAK,EAAM,QAAQ,IAAII,CAAG,EAAG,OAExBb,EAAQH,CAAM,EAChBY,EAAM,QAAQ,IACZI,EACAhB,EAAO,IAAKI,GAAUC,EAAkBD,EAAOH,CAAK,CAAC,EAAE,KAAK,IAAI,CAAA,EAGlEW,EAAM,QAAQ,IAAII,EAAKX,EAAkBL,EAAQC,CAAK,CAAC,CAE3D,CAEI,OAAAE,EAAQM,EAAK,OAAO,EACfA,EAAK,QAAQ,IAAKO,GAAQJ,EAAM,QAAQ,IAAII,CAAG,CAAC,EAAE,KAAK,IAAI,EAE3DJ,EAAM,QAAQ,IAAIH,EAAK,SAAW,EAAE,CAC7C,CACD,EAEKQ,EAAeC,EAAA,YAEjBC,GAIG,CACH,MAAMC,GAAQ,IACR,CAACT,EAAYF,EAAK,OAAO,GAAKN,EAAQI,CAAU,EAC3CJ,EAAQM,EAAK,OAAO,EACvBA,EAAK,QAAQ,IAAI,MAAM,EACvB,OAAOA,EAAK,OAAO,EAEhBA,EAAK,WAIVY,EAAaC,EAAUH,EAAYC,CAAI,EAExCX,EAAA,QAAUN,EAAQkB,CAAU,EAC7BA,EAAW,IAAI,MAAM,EACrB,OAAOA,CAAU,EAEjBlB,EAAQM,EAAK,OAAO,EACtBK,EACEL,EAAK,QAAQ,IAAKO,GAAQJ,EAAM,QAAQ,IAAII,CAAG,CAAC,EAAE,KAAK,IAAI,CAAA,EAG7DF,EAAcF,EAAM,QAAQ,IAAIH,EAAK,SAAW,EAAE,CAAC,CAEvD,EACA,CAACF,CAAU,CAAA,EAGN,MAAA,CAACM,EAAYI,CAAY,CAClC,EAOaM,EAAuB,CAAC,CACnC,OAAAC,EACA,IAAAC,CACF,IAAiC,CAC/B,KAAM,CAACC,EAASC,CAAU,EAAIZ,WAASS,CAAM,EACvC,CAACI,EAAK,CAAE,GAAAC,CAAG,CAAC,EAAIC,EAAW,EAEjCC,OAAAA,EAAAA,UAAU,IAAM,CACVH,IAEJD,EAAWH,CAAM,EACdK,IACF,EAAA,CAACL,EAAQI,EAAKC,CAAE,CAAC,EAEpBG,EACE,IAAMP,EAAI,QACV,eACA,IAAME,EAAWH,CAAM,CAAA,EAKlB,CACL,QAAS,EAHIA,EAAS,GAAQ,CAACE,GAI/B,qBAAsB,OACd,MAAAO,EAAcC,EAAeT,EAAI,OAAO,EACxCU,EAAK,IAAIF,EAAY,YAAY,eAAgB,CACrD,QAAS,EAAA,CACV,GAEGG,EAAAX,EAAA,UAAA,MAAAW,EAAS,cAAcD,EAC7B,CAAA,CAEJ"}