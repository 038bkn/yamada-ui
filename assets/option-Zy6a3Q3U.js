import{j as k}from"./emotion-use-insertion-effect-with-fallbacks.browser.esm-CIjPhCfQ.js";import{u as De}from"./index-CrebD9Bq.js";import{r as n}from"./index-BwDkhjyp.js";import{c as Oe,a as Re}from"./icon-bEgKfv7t.js";import{f as Z}from"./forward-ref-BmTAT9U5.js";import{l as Te,T as Ee,a0 as ke,a1 as Pe,R as Ae,s as K,ab as Le,U as Ne,q as He,f as Me,S as Be,a as ae,h as Q,d as X,y as ye,af as Ue,V as ce,t as Ve,b as W,c as q,j as Ge}from"./factory-BrsV2ztw.js";import{b as Ke}from"./popover-content-BDOAG20m.js";import{u as We}from"./index-BCwor68u.js";import{c as qe}from"./index-UjJCRxfq.js";import{u as ze}from"./index-Dl3F70TH.js";import{u as Ye}from"./index-BL4_Hm1h.js";import{u as $e,f as Je}from"./form-control-Cz6JKnCW.js";const Qe=s=>{var o;return Ue(s)&&!!((o=s==null?void 0:s.getAttribute("role"))!=null&&o.startsWith("select-item"))},{DescendantsContextProvider:ht,useDescendantsContext:Se,useDescendants:Xe,useDescendant:Ze}=qe(),[gt,H]=Te({strict:!1,name:"SelectContext"}),vt=({placeholder:s,closeOnBlur:o=!0,closeOnEsc:a=!0,closeOnSelect:r=!0,placeholderInOptions:i=!0,omitSelectedValues:l=!1,maxSelectValues:u,isEmpty:f,placement:C="bottom-start",duration:b=.2,isOpen:P,defaultIsOpen:g,onOpen:y,onClose:S,optionProps:v,...d})=>{d=$e(d);const{"aria-readonly":j,...w}=Ee(d,Je),[z,ee]=ke(Ae(d,["value","defaultValue","onChange","aria-readonly"]),Pe),c=Xe(),[D,m]=n.useState(-1),[te,M]=n.useState(!1),V=n.useRef(null),se=n.useRef(null),xe=n.useRef(null),L=n.useRef(new Set([])),[_,Y]=We({value:d.value,defaultValue:d.defaultValue,onChange:d.onChange}),[I,G]=n.useState(void 0),B=D>-1,x=K(_),T=(x?!_.length:!_)&&!(s&&i),N=c.values(({node:e})=>x&&_.includes(e.dataset.value??"")).map(({index:e})=>e),A=c.enabledValues(({index:e})=>!N.includes(e)),ne=n.useCallback(()=>{const e=setTimeout(()=>{const t=c.enabledFirstValue();if(t)if(!x||!l)m(t.index);else if(N.includes(t.index)){const h=A[0];m(h.index)}else m(t.index)});L.current.add(e)},[c,A,x,l,N]),oe=n.useCallback(()=>{const e=setTimeout(()=>{const t=c.enabledLastValue();if(t)if(!x||!l)m(t.index);else if(N.includes(t.index)){const h=A.reverse()[0];m(h.index)}else m(t.index)});L.current.add(e)},[c,A,x,l,N]),ie=n.useCallback(()=>{const e=setTimeout(()=>{const h=c.enabledValues().find(({node:E})=>x?_.includes(E.dataset.value??""):E.dataset.value===_);h&&m(h.index)});L.current.add(e)},[c,x,_]),$=n.useCallback(()=>{const e=setTimeout(()=>{const t=c.enabledNextValue(D);if(t)if(!x||!l)m(t.index);else if(N.includes(t.index)){const h=A.find(({index:E})=>t.index<E)??A[0];m(h.index)}else m(t.index)});L.current.add(e)},[c,A,D,x,l,N,m]),re=n.useCallback(()=>{const e=setTimeout(()=>{const t=c.enabledPrevValue(D);if(t)if(!x||!l)m(t.index);else if(N.includes(t.index)){const h=A.reverse().find(({index:E})=>E<t.index)??A[0];m(h.index)}else m(t.index)});L.current.add(e)},[c,A,D,x,l,N,m]),U=T||l?ne:ie,Ce=T||l?oe:ie,ue=n.useCallback((e,t=!0)=>{const h=c.values();if(!h.length)return;const E=h.filter(({node:F})=>F.dataset.value===e).map(({node:F,index:J})=>{if(!(s&&i)||J!==0){const le=Array.from(F.children).find(pe=>pe.getAttribute("data-label")!==null);return(le==null?void 0:le.innerHTML)??""}else return});G(F=>x?(E.forEach(J=>{K(F)&&F.includes(J??"")?t&&(F=K(F)?F.filter(pe=>pe!==J):void 0):F=[...K(F)?F:[],J]}),F):E[0])},[c,x,s,i]),de=n.useCallback(e=>{Y(t=>K(t)?t.includes(e)?t.filter(E=>E!==e):[...t,e]:e),ue(e)},[ue,Y]),Ie=n.useCallback(e=>{e.stopPropagation(),Y([]),G(void 0)},[G,Y]),{isOpen:p,onOpen:be,onClose:O}=ze({isOpen:P,defaultIsOpen:g,onOpen:y,onClose:S}),R=n.useCallback(()=>{w.disabled||w.readOnly||f||te||be()},[w,f,te,be]),fe=n.useCallback(()=>{let e=c.value(D);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const t=e.node.dataset.value??"";de(t),r&&O(),l&&$()},[r,c,D,l,de,O,$]),he=n.useCallback(()=>{p||(R(),U())},[p,U,R]),ge=n.useCallback(()=>{p||(R(),U())},[p,U,R]),ve=n.useCallback(e=>{const t=Le(e);Ne(V.current,t)||o&&p&&O()},[o,p,O]),_e=n.useCallback(e=>{if(e.key===" "&&(e.key=e.code),w.disabled||w.readOnly)return;const h={ArrowDown:B?()=>$():p?void 0:ce(R,U),ArrowUp:B?()=>re():p?void 0:ce(R,Ce),Space:B?fe:p?void 0:ce(R,U),Enter:B?fe:p?void 0:ce(R,U),Home:p?ne:void 0,End:p?oe:void 0,Escape:a?O:void 0}[e.key];h&&(e.preventDefault(),e.stopPropagation(),h())},[w.disabled,w.readOnly,B,p,R,U,Ce,fe,ne,oe,a,O,$,re]);Ye({ref:V,handler:O,enabled:p&&o}),n.useEffect(()=>{if(!x||!l&&He(u))return;const e=_.length>0&&_.length===c.count(),t=_.length===u;e||t?(O(),M(!0)):M(!1)},[l,_,c,x,O,u]),Me(()=>{p||m(-1)},[p]),Be(()=>{L.current.forEach(e=>clearTimeout(e)),L.current.clear()});const Fe=n.useCallback(e=>({matchWidth:!0,...d,...e,isOpen:p,onOpen:R,onClose:O,placement:C,duration:b,trigger:"never",closeOnButton:!1,closeOnBlur:o}),[b,o,O,R,C,d,p]),je=n.useCallback((e={},t=null)=>({ref:ae(V,t),...z,...e,...w,onClick:Q(e.onClick,d.onClick,he),onBlur:Q(e.onBlur,d.onBlur,ve)}),[z,w,ve,he,d]),we=n.useCallback((e={},t=null)=>({ref:ae(se,t),tabIndex:0,...ee,...e,"data-active":X(p),"data-placeholder":X(x?!(I!=null&&I.length):I===void 0),"aria-expanded":X(p),onFocus:Q(e.onFocus,d.onFocus,ge),onKeyDown:Q(e.onKeyDown,d.onKeyDown,_e)}),[ee,p,x,I,d,ge,_e]);return{descendants:c,value:_,label:I,focusedIndex:D,placeholder:s,placeholderInOptions:i,omitSelectedValues:l,closeOnSelect:r,isOpen:p,containerRef:V,fieldRef:se,listRef:xe,optionProps:v,formControlProps:w,onChangeLabel:ue,onChange:de,onClear:Ie,onOpen:R,onClose:O,onFocusFirst:ne,onFocusLast:oe,onFocusSelected:ie,onFocusNext:$,onFocusPrev:re,setFocusedIndex:m,getPopoverProps:Fe,getContainerProps:je,getFieldProps:we}},et=()=>{const{listRef:s,focusedIndex:o}=H(),a=Se(),r=n.useRef(-1),i=a.value(o);return n.useEffect(()=>{if(!s.current||!i||r.current===i.index)return;const u=s.current,f=i.node,C=u.clientHeight,b=u.scrollTop,P=b+C,g=f.clientHeight,y=f.offsetTop,S=y+g,v=b<=y&&S<=P,d=r.current<i.index;v||(S<=C?s.current.scrollTo({top:0}):d?s.current.scrollTo({top:S-C}):s.current.scrollTo({top:y+1})),r.current=i.index},[s,i]),{getListProps:n.useCallback((u={},f=null)=>({as:"ul",ref:ae(s,f),role:"select",tabIndex:-1,...u}),[s])}},tt=({label:s,...o})=>{const{value:a,omitSelectedValues:r}=H(),i=K(a),l=Se(),u=l.values(),C=(i&&r?l.values(({node:v})=>a.includes(v.dataset.value??"")):[]).map(({index:v})=>v),P=!u.filter(({node:v,index:d})=>{var j;return((j=v.parentElement)==null?void 0:j.dataset.label)===s&&!C.includes(d)}).length,g=ke(o,Pe),y=n.useCallback((v={},d=null)=>{const j={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};return{ref:d,...v,...g[0],style:P?j:void 0}},[g,P]),S=n.useCallback((v={},d=null)=>({ref:d,...v,...g[1],"data-label":s}),[g,s]);return{label:s,getContainerProps:y,getGroupProps:S}},st=(s,o)=>{const{fieldRef:a,value:r,placeholder:i,placeholderInOptions:l,omitSelectedValues:u,closeOnSelect:f,focusedIndex:C,optionProps:b,onChange:P,onChangeLabel:g,onFocusNext:y,onClose:S,setFocusedIndex:v}=H();let{icon:d,isDisabled:j,isFocusable:w,closeOnSelect:z,children:ee,value:c,...D}={...b,...o};const m=!!j&&!w,te=n.useRef(null),{index:M,register:V,descendants:se}=Ze({disabled:m}),L=se.values().slice(0,M),_=K(r),I=!(_?!1:L.some(({node:T})=>T.dataset.value===(c??"")))&&(_?r.includes(c??""):(c??"")===r),G=M===C;i&&M>0&&l&&!c&&console.warn(`${_?"MultiSelect":"Select"}: If placeholders are present, All options must be set value. If want to set an empty value, either don't set the placeholder or set 'placeholderInOptions' to false.`);const B=n.useCallback(T=>{if(T.preventDefault(),T.stopPropagation(),j){a.current&&a.current.focus();return}if(!Qe(T.currentTarget)){a.current&&a.current.focus();return}v(M),P(c??""),a.current&&a.current.focus(),(z??f)&&S(),u&&y()},[j,v,M,P,c,a,z,f,S,u,y]);n.useEffect(()=>{I&&g(c??"",!1)},[c,I,g]);const x=n.useCallback((T={})=>{const me={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};return{ref:ae(te,s,V),...D,...T,role:"select-item",tabIndex:-1,style:u&&I?me:void 0,"data-value":c??"","data-focus":X(G),"data-disabled":X(j),"aria-checked":ye(I),"aria-disabled":ye(j),onClick:Q(D.onClick,T.onClick,B)}},[c,D,j,G,I,u,B,s,V]);return{isSelected:I,isFocused:G,customIcon:d,children:ee,getOptionProps:x}},nt=Z(({className:s,children:o,__css:a,...r},i)=>{const{styles:l}=H(),u={position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",cursor:"pointer",...l.icon,...a},C=Ve(o).map(b=>n.cloneElement(b,{focusable:!1,"aria-hidden":!0,style:{maxWidth:"1em",maxHeight:"1em",color:"currentColor"}}));return k.jsx(W.div,{ref:i,className:q("ui-select__icon",s),__css:u,...r,children:Ge(o)?C:k.jsx(Oe,{})})}),_t=({className:s,children:o,...a})=>{const r=n.useRef(null),{styles:i}=H(),l=a.disabled,u=De({ref:r,isDisabled:l,...a});return k.jsx(nt,{"aria-label":"Clear value",className:q("ui-select__clear-icon",s),__css:i.clearIcon,...u,children:o??k.jsx(Re,{w:"0.5em",h:"0.5em"})})},yt=Z(({className:s,w:o,width:a,minW:r,minWidth:i,...l},u)=>{var P,g,y,S;const{styles:f}=H(),{getListProps:C}=et();o=o??a??((P=f.list)==null?void 0:P.w)??((g=f.list)==null?void 0:g.width),r=r??i??((y=f.list)==null?void 0:y.minW)??((S=f.list)==null?void 0:S.minWidth);const b={...f.list};return k.jsx(Ke,{className:q("ui-select__list",s),w:o,minW:r,__css:b,...C(l,u)})}),kt=Z(({className:s,color:o,h:a,height:r,minH:i,minHeight:l,children:u,...f},C)=>{const{styles:b}=H(),{label:P,getContainerProps:g,getGroupProps:y}=tt(f);return a??(a=r),i??(i=l),k.jsxs(W.li,{className:q("ui-select__item","ui-select__item--group",s),__css:{w:"100%",h:"fit-content",color:o},...g(),children:[k.jsx(W.span,{className:"ui-select__item__group-label",__css:b.groupLabel,lineClamp:1,children:P}),k.jsx(W.ul,{...y({},C),className:"ui-select__item__group",__css:{h:a,minH:i,...b.group},children:u})]})}),Pt=Z(({className:s,icon:o,...a},r)=>{const{styles:i}=H(),{isSelected:l,customIcon:u,children:f,getOptionProps:C}=st(r,a);o??(o=u);const b={textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,gap:"0.75rem",...i.item};return k.jsxs(W.li,{className:q("ui-select__item",s),__css:b,...C(),children:[o!==null?k.jsx(ot,{opacity:l?1:0,children:o||k.jsx(lt,{})}):null,k.jsx(W.span,{style:{flex:1},"data-label":!0,children:f})]})}),ot=Z(({className:s,...o},a)=>{const{styles:r}=H(),i={flexShrink:0,display:"inline-flex",justifyContent:"center",alignItems:"center",fontSize:"0.85em",...r.itemIcon};return k.jsx(W.span,{ref:a,className:q("ui-select__item__icon",s),__css:i,...o})}),lt=()=>k.jsx("svg",{viewBox:"0 0 14 14",width:"1em",height:"1em",children:k.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})});export{Pt as O,ht as S,kt as a,gt as b,nt as c,yt as d,H as e,_t as f,vt as u};
