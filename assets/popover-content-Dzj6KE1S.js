import{r as n}from"./index-CBqU2yxZ.js";import{j as P}from"./jsx-runtime-CKrituN3.js";import{b as re}from"./index-DD9eRhK7.js";import{u as ie,a as ce}from"./index-C-D6xzpN.js";import{u as ae,a as le,b as ue}from"./index-CrNYDEDJ.js";import{u as fe,p as me}from"./index-ormjCxW4.js";import{p as pe,v as X,h as i,D as de,a8 as Y,R as L,c as Z,t as ve,x as ge,C as Pe,u as Q,aa as he}from"./factory-D1MzC1Q2.js";import{a as Ce}from"./use-component-style-i7T2CPTB.js";import{o as ye}from"./theme-provider-LCtE2tbw.js";import{m as be}from"./motion-JgkBPv6g.js";import{s as z}from"./slide-fade-DJiINvtX.js";import{s as Re}from"./scale-fade-BDJIhGhc.js";import{C as xe}from"./close-button-CIKMrptQ.js";import{f as $}from"./forward-ref-DuAegr0M.js";const Se=[...me,"isOpen","defaultIsOpen","onOpen","onClose","initialFocusRef","restoreFocus","autoFocus","closeOnBlur","closeOnEsc","closeOnButton","trigger","openDelay","closeDelay","isLazy","lazyBehavior","animation","duration"],[Be,N]=pe({strict:!1,name:"PopoverContext"}),Xe=f=>{const[c,t]=Ce("Popover",f),{children:d,initialFocusRef:v,restoreFocus:g=!0,autoFocus:R=!0,closeOnBlur:m=!0,closeOnEsc:w=!0,closeOnButton:k=!0,trigger:p="click",openDelay:x=200,closeDelay:h=200,isLazy:I,lazyBehavior:V="unmount",animation:K="scale",duration:D,...S}=ye(t),{isOpen:e,onOpen:B,onClose:s,onToggle:j}=ie(t),O=n.useRef(null),C=n.useRef(null),l=n.useRef(null),{present:M,onAnimationComplete:A}=re({isOpen:e,ref:l}),u=n.useRef(void 0),y=n.useRef(void 0),T=n.useRef(!1),H=n.useRef(!1);e&&(H.current=!0);const{referenceRef:_,getPopperProps:ee,forceUpdate:U,transformOrigin:q}=fe({...S,enabled:e});n.useEffect(()=>()=>{u.current&&clearTimeout(u.current),y.current&&clearTimeout(y.current)},[]),ae({enabled:e,ref:C}),le(l,{focusRef:C,visible:e,shouldFocus:g&&p==="click"}),ue(l,{focusRef:v,visible:e,shouldFocus:R&&p==="click"});const G=ce({wasSelected:H.current,enabled:I,mode:V,isSelected:M}),oe=n.useCallback((o={},F=null)=>{const r={...o,style:{...o.style,transformOrigin:q},ref:X(l,F),children:G?o.children:null,tabIndex:-1,onKeyDown:i(o.onKeyDown,a=>{w&&a.key==="Escape"&&s()}),onBlur:i(o.onBlur,a=>{const b=Y(a),E=L(l.current,b),se=L(C.current,b);e&&m&&(!E&&!se)&&s()})};return p==="hover"&&(r.onMouseEnter=i(o.onMouseEnter,()=>{T.current=!0}),r.onMouseLeave=i(o.onMouseLeave,a=>{a.nativeEvent.relatedTarget!==null&&(T.current=!1,setTimeout(s,h))})),r},[h,m,w,e,s,G,q,p]),J=n.useCallback(o=>{O.current==null&&_(o)},[_]),te=n.useCallback((o={},F=null)=>{const r={...o,ref:X(C,F,J)};return p==="click"&&(r.onClick=i(o.onClick,j),r.onBlur=i(o.onBlur,a=>{const b=Y(a),E=!L(l.current,b);e&&m&&E&&s()})),p==="hover"&&(r.onFocus=i(o.onFocus,()=>{u.current===void 0&&B()}),r.onBlur=i(o.onBlur,a=>{const b=Y(a),E=!L(l.current,b);e&&m&&E&&s()}),r.onKeyDown=i(o.onKeyDown,a=>{a.key==="Escape"&&s()}),r.onMouseEnter=i(o.onMouseEnter,()=>{T.current=!0,u.current=window.setTimeout(B,x)}),r.onMouseLeave=i(o.onMouseLeave,()=>{T.current=!1,u.current&&(clearTimeout(u.current),u.current=void 0),y.current=window.setTimeout(()=>{T.current===!1&&s()},h)})),r},[h,m,e,J,s,B,j,x,p]),ne=n.useCallback((o={},F=null)=>({...o,ref:X(F,O,_)}),[O,_]);return P.jsx(Be,{value:{isOpen:e,onClose:s,closeOnButton:k,onAnimationComplete:A,forceUpdate:U,getTriggerProps:te,getAnchorProps:ne,getPopperProps:ee,getPopoverProps:oe,animation:K,duration:D,styles:c},children:de(d,{isOpen:e,onClose:s,forceUpdate:U})})},Ye=({children:f})=>{const c=n.Children.only(f),{getTriggerProps:t}=N();return n.cloneElement(c,t(c.props,c.ref))},W=$(({onClick:f,...c},t)=>{const{styles:d,onClose:v}=N(),g={position:"absolute",...d.closeButton};return P.jsx(xe,{ref:t,className:Z("ui-popover__close-button"),__css:g,onClick:i(f,R=>{R.stopPropagation(),v==null||v()}),size:"sm",...c})}),Oe=(f="scale",c)=>{const t={reverse:!0,duration:c,enter:{visibility:"visible"},transitionEnd:{exit:{visibility:"hidden"}}};switch(f){case"scale":return{...Re,custom:{...t,scale:.95}};case"top":return{...z,custom:{...t,offsetX:0,offsetY:-16}};case"right":return{...z,custom:{...t,offsetX:16,offsetY:0}};case"left":return{...z,custom:{...t,offsetX:-16,offsetY:0}};case"bottom":return{...z,custom:{...t,offsetX:0,offsetY:16}}}},Ne=$(({as:f="section",className:c,children:t,w:d,width:v,minW:g,minWidth:R,zIndex:m,__css:w,...k},p)=>{var l,M,A,u,y;const{isOpen:x,closeOnButton:h,getPopperProps:I,getPopoverProps:V,onAnimationComplete:K,animation:D,duration:S,styles:e}=N(),B=ve(t),[s,...j]=ge(B,W),O=()=>P.jsxs(P.Fragment,{children:[s??(h?P.jsx(W,{}):null),j]}),C={position:"relative",w:"100%",display:"flex",flexDirection:"column",outline:0,...Pe(w??e.container,["zIndex"])};return d=d??v??((l=e.container)==null?void 0:l.w)??((M=e.container)==null?void 0:M.width),g=g??R??((A=e.container)==null?void 0:A.minW)??((u=e.container)==null?void 0:u.minWidth),m=m??((y=e.container)==null?void 0:y.zIndex),P.jsx(Q.div,{...I({style:{visibility:x?"visible":"hidden"}}),className:"ui-popover",w:d,minW:g,zIndex:m,children:P.jsx(Q.section,{as:be[f],className:Z("ui-popover__content",c),...D!=="none"?Oe(D,S):{},...V({...k,children:O()},p),initial:"exit",animate:x?"enter":"exit",exit:"exit",onAnimationComplete:he(K,k.onAnimationComplete),__css:C})})});export{Xe as P,Ye as a,Ne as b,W as c,Se as p,N as u};
