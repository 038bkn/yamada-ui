import{r as n}from"./index-4g5l5LRQ.js";import{j as w,a as re,F as ie}from"./jsx-runtime-5BUNAZ9W.js";import{b as ce}from"./index-CEN7zzqH.js";import{u as ae,a as le}from"./index-DKVjicNd.js";import{u as ue,a as fe,b as me}from"./index-oP9DpoIE.js";import{u as pe,p as de}from"./index-64PqjCnR.js";import{c as ve,z as S,h as i,B as ge,a2 as X,P as z,a as Z,v as Pe,L as he,o as Ce,u as Q,Y as ye}from"./factory-Ei-jEUJK.js";import{u as be}from"./use-component-style-eekTqtz5.js";import{o as Be}from"./theme-provider-PZSzWP7q.js";import{m as Re}from"./motion-ukEXpwwk.js";import{s as I}from"./slide-fade-dFRQP4gj.js";import{s as Oe}from"./scale-fade-0tTCXgSM.js";import{C as Te}from"./close-button-BXkEl4RT.js";import{f as $}from"./forward-ref-A-8Arhkk.js";const Xe=[...de,"isOpen","defaultIsOpen","onOpen","onClose","initialFocusRef","restoreFocus","autoFocus","closeOnBlur","closeOnEsc","closeOnButton","trigger","openDelay","closeDelay","isLazy","lazyBehavior","animation","duration"],[Fe,N]=ve({strict:!1,name:"PopoverContext"}),Ne=f=>{const[c,t]=be("Popover",f),{children:d,initialFocusRef:v,restoreFocus:g=!0,autoFocus:b=!0,closeOnBlur:m=!0,closeOnEsc:E=!0,closeOnButton:k=!0,trigger:p="click",openDelay:B=200,closeDelay:P=200,isLazy:V,lazyBehavior:Y="unmount",animation:j="scale",duration:D,...K}=Be(t),{isOpen:e,onOpen:R,onClose:s,onToggle:M}=ae(t),O=n.useRef(null),h=n.useRef(null),l=n.useRef(null),{present:A,onAnimationComplete:L}=ce({isOpen:e,ref:l}),u=n.useRef(void 0),C=n.useRef(void 0),T=n.useRef(!1),H=n.useRef(!1);e&&(H.current=!0);const{referenceRef:_,getPopperProps:ee,forceUpdate:U,transformOrigin:q}=pe({...K,enabled:e});n.useEffect(()=>()=>{u.current&&clearTimeout(u.current),C.current&&clearTimeout(C.current)},[]),ue({enabled:e,ref:h}),fe(l,{focusRef:h,visible:e,shouldFocus:g&&p==="click"}),me(l,{focusRef:v,visible:e,shouldFocus:b&&p==="click"});const G=le({wasSelected:H.current,enabled:V,mode:Y,isSelected:A}),oe=n.useCallback((o={},F=null)=>{const r={...o,style:{...o.style,transformOrigin:q},ref:S(l,F),children:G?o.children:null,tabIndex:-1,onKeyDown:i(o.onKeyDown,a=>{E&&a.key==="Escape"&&s()}),onBlur:i(o.onBlur,a=>{const y=X(a),x=z(l.current,y),se=z(h.current,y);e&&m&&(!x&&!se)&&s()})};return p==="hover"&&(r.onMouseEnter=i(o.onMouseEnter,()=>{T.current=!0}),r.onMouseLeave=i(o.onMouseLeave,a=>{a.nativeEvent.relatedTarget!==null&&(T.current=!1,setTimeout(s,P))})),r},[P,m,E,e,s,G,q,p]),J=n.useCallback(o=>{O.current==null&&_(o)},[_]),te=n.useCallback((o={},F=null)=>{const r={...o,ref:S(h,F,J)};return p==="click"&&(r.onClick=i(o.onClick,M),r.onBlur=i(o.onBlur,a=>{const y=X(a),x=!z(l.current,y);e&&m&&x&&s()})),p==="hover"&&(r.onFocus=i(o.onFocus,()=>{u.current===void 0&&R()}),r.onBlur=i(o.onBlur,a=>{const y=X(a),x=!z(l.current,y);e&&m&&x&&s()}),r.onKeyDown=i(o.onKeyDown,a=>{a.key==="Escape"&&s()}),r.onMouseEnter=i(o.onMouseEnter,()=>{T.current=!0,u.current=window.setTimeout(R,B)}),r.onMouseLeave=i(o.onMouseLeave,()=>{T.current=!1,u.current&&(clearTimeout(u.current),u.current=void 0),C.current=window.setTimeout(()=>{T.current===!1&&s()},P)})),r},[P,m,e,J,s,R,M,B,p]),ne=n.useCallback((o={},F=null)=>({...o,ref:S(F,O,_)}),[O,_]);return w(Fe,{value:{isOpen:e,onClose:s,closeOnButton:k,onAnimationComplete:L,forceUpdate:U,getTriggerProps:te,getAnchorProps:ne,getPopperProps:ee,getPopoverProps:oe,animation:j,duration:D,styles:c},children:ge(d,{isOpen:e,onClose:s,forceUpdate:U})})},He=({children:f})=>{const c=n.Children.only(f),{getTriggerProps:t}=N();return n.cloneElement(c,t(c.props,c.ref))},W=$(({onClick:f,...c},t)=>{const{styles:d,onClose:v}=N(),g={position:"absolute",...d.closeButton};return w(Te,{ref:t,className:Z("ui-popover__close-button"),__css:g,onClick:i(f,b=>{b.stopPropagation(),v==null||v()}),size:"sm",...c})}),xe=(f="scale",c)=>{const t={reverse:!0,duration:c,enter:{visibility:"visible"},transitionEnd:{exit:{visibility:"hidden"}}};switch(f){case"scale":return{...Oe,custom:{...t,scale:.95}};case"top":return{...I,custom:{...t,offsetX:0,offsetY:-16}};case"right":return{...I,custom:{...t,offsetX:16,offsetY:0}};case"left":return{...I,custom:{...t,offsetX:-16,offsetY:0}};case"bottom":return{...I,custom:{...t,offsetX:0,offsetY:16}}}},Ue=$(({as:f="section",className:c,children:t,w:d,width:v,minW:g,minWidth:b,zIndex:m,__css:E,...k},p)=>{var l,A,L,u,C;const{isOpen:B,closeOnButton:P,getPopperProps:V,getPopoverProps:Y,onAnimationComplete:j,animation:D,duration:K,styles:e}=N(),R=Pe(t),[s,...M]=he(R,W),O=()=>re(ie,{children:[s??(P?w(W,{}):null),M]}),h={position:"relative",w:"100%",display:"flex",flexDirection:"column",outline:0,...Ce(E??e.container,["zIndex"])};return d=d??v??((l=e.container)==null?void 0:l.w)??((A=e.container)==null?void 0:A.width),g=g??b??((L=e.container)==null?void 0:L.minW)??((u=e.container)==null?void 0:u.minWidth),m=m??((C=e.container)==null?void 0:C.zIndex),w(Q.div,{...V({style:{visibility:B?"visible":"hidden"}}),className:"ui-popover",w:d,minW:g,zIndex:m,children:w(Q.section,{as:Re[f],className:Z("ui-popover__content",c),...D!=="none"?xe(D,K):{},...Y({...k,children:O()},p),initial:"exit",animate:B?"enter":"exit",exit:"exit",onAnimationComplete:ye(j,k.onAnimationComplete),__css:h})})});export{Ne as P,He as a,Ue as b,W as c,Xe as p,N as u};
