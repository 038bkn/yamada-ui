import{r as n}from"./index-uCp2LrAq.js";import{j as b}from"./jsx-runtime-X2b_N9AH.js";import{b as ce}from"./index-CnGadzrd.js";import{u as le,a as ue}from"./index-BBt5KR5O.js";import{u as ae,a as fe,b as me}from"./index-kKcgrWTG.js";import{u as de,p as pe}from"./index-CfyBxFcd.js";import{l as ve,a as N,h as i,B as ge,a9 as H,T as D,c as $,t as Pe,x as he,u as Q,ab as Ce}from"./factory-DcjttzXA.js";import{a as ye}from"./use-component-style-Bt4oJcRH.js";import{o as xe}from"./theme-provider-blvefFsb.js";import{m as be}from"./motion-BNFRb361.js";import{s as M}from"./slide-fade-BCrKcD4j.js";import{s as Be}from"./scale-fade-DdhoTvDk.js";import{C as Re}from"./close-button--PP8EEnm.js";import{f as ee}from"./forward-ref-Dr5Hqd9a.js";const Xe=[...pe,"isOpen","defaultIsOpen","onOpen","onClose","initialFocusRef","restoreFocus","autoFocus","closeOnBlur","closeOnEsc","closeOnButton","trigger","openDelay","closeDelay","isLazy","lazyBehavior","animation","duration"],[Te,U]=ve({strict:!1,name:"PopoverContext"}),Ye=a=>{const[c,t]=ye("Popover",a),{children:g,initialFocusRef:P,restoreFocus:h=!0,autoFocus:T=!0,closeOnBlur:d=!0,closeOnEsc:_=!0,closeOnButton:j=!0,trigger:u="click",openDelay:z=200,closeDelay:C=200,isLazy:A,lazyBehavior:L="unmount",animation:V="scale",duration:K,relatedRef:p,...S}=xe(t),{isOpen:o,onOpen:O,onClose:s,onToggle:I}=le(t),F=n.useRef(null),B=n.useRef(null),f=n.useRef(null),{present:X,onAnimationComplete:Y}=ce({isOpen:o,ref:f}),m=n.useRef(void 0),R=n.useRef(void 0),v=n.useRef(!1),E=n.useRef(!1);o&&(E.current=!0);const{referenceRef:y,getPopperProps:oe,forceUpdate:Z,transformOrigin:q}=de({...S,enabled:o});n.useEffect(()=>()=>{m.current&&clearTimeout(m.current),R.current&&clearTimeout(R.current)},[]),ae({enabled:o,ref:B}),fe(f,{focusRef:B,visible:o,shouldFocus:h&&u==="click"}),me(f,{focusRef:P,visible:o,shouldFocus:T&&u==="click"});const G=ue({wasSelected:E.current,enabled:A,mode:L,isSelected:X}),te=n.useCallback((e={},w=null)=>{const r={...e,style:{...e.style,transformOrigin:q},ref:N(f,w),children:G?e.children:null,tabIndex:-1,onKeyDown:i(e.onKeyDown,l=>{_&&l.key==="Escape"&&s()}),onBlur:i(e.onBlur,l=>{const x=H(l),k=D(f.current,x),re=D(B.current,x),ie=p!=null&&p.current?D(p.current,x):!1;o&&d&&(!k&&!re&&!ie)&&s()})};return u==="hover"&&(r.onMouseEnter=i(e.onMouseEnter,()=>{v.current=!0}),r.onMouseLeave=i(e.onMouseLeave,l=>{l.nativeEvent.relatedTarget!==null&&(v.current=!1,d&&setTimeout(s,C))})),r},[C,d,_,o,s,G,q,u,p]),J=n.useCallback(e=>{F.current==null&&y(e)},[y]),ne=n.useCallback((e={},w=null)=>{const r={...e,ref:N(B,w,J)};return u==="click"&&(r.onClick=i(e.onClick,I),r.onBlur=i(e.onBlur,l=>{const x=H(l),k=!D(f.current,x);o&&d&&k&&s()})),u==="hover"&&(r.onFocus=i(e.onFocus,()=>{m.current===void 0&&O()}),r.onBlur=i(e.onBlur,l=>{const x=H(l),k=!D(f.current,x);o&&d&&k&&s()}),r.onKeyDown=i(e.onKeyDown,l=>{l.key==="Escape"&&s()}),r.onMouseEnter=i(e.onMouseEnter,()=>{v.current=!0,m.current=window.setTimeout(O,z)}),r.onMouseLeave=i(e.onMouseLeave,()=>{v.current=!1,m.current&&(clearTimeout(m.current),m.current=void 0),R.current=window.setTimeout(()=>{v.current||s()},C)})),r},[C,d,o,J,s,O,I,z,u]),se=n.useCallback((e={},w=null)=>({...e,ref:N(w,F,y)}),[F,y]);return b.jsx(Te,{value:{isOpen:o,onClose:s,closeOnButton:j,onAnimationComplete:Y,forceUpdate:Z,getTriggerProps:ne,getAnchorProps:se,getPopperProps:oe,getPopoverProps:te,animation:V,duration:K,styles:c},children:ge(g,{isOpen:o,onClose:s,forceUpdate:Z})})},Ne=({children:a})=>{const c=n.Children.only(a),{getTriggerProps:t}=U();return n.cloneElement(c,t(c.props,c.ref))},W=ee(({onClick:a,...c},t)=>{const{styles:g,onClose:P}=U(),h={position:"absolute",...g.closeButton};return b.jsx(Re,{ref:t,className:$("ui-popover__close-button"),__css:h,onClick:i(a,T=>{T.stopPropagation(),P==null||P()}),size:"sm",...c})}),Oe=(a="scale",c)=>{const t={reverse:!0,duration:c,enter:{visibility:"visible"},transitionEnd:{exit:{visibility:"hidden"}}};switch(a){case"scale":return{...Be,custom:{...t,scale:.95}};case"top":return{...M,custom:{...t,offsetX:0,offsetY:-16}};case"right":return{...M,custom:{...t,offsetX:16,offsetY:0}};case"left":return{...M,custom:{...t,offsetX:-16,offsetY:0}};case"bottom":return{...M,custom:{...t,offsetX:0,offsetY:16}}}},He=ee(({as:a="section",className:c,children:t,w:g,width:P,minW:h,minWidth:T,z:d,zIndex:_,__css:j,...u},z)=>{var R,v,E,y;const{isOpen:C,closeOnButton:A,getPopperProps:L,getPopoverProps:V,onAnimationComplete:K,animation:p,duration:S,styles:o}=U(),O=Pe(t),[s,...I]=he(O,W),F=()=>b.jsxs(b.Fragment,{children:[s??(A?b.jsx(W,{}):null),I]}),{z:B,zIndex:f,...X}=j??o.container??{},Y={position:"relative",w:"100%",display:"flex",flexDirection:"column",outline:0,...X};g=g??P??((R=o.container)==null?void 0:R.w)??((v=o.container)==null?void 0:v.width),h=h??T??((E=o.container)==null?void 0:E.minW)??((y=o.container)==null?void 0:y.minWidth);const m=_??d??f??B;return b.jsx(Q.div,{...L({style:{visibility:C?"visible":"hidden"}}),className:"ui-popover",w:g,minW:h,zIndex:m,children:b.jsx(Q.section,{as:be[a],className:$("ui-popover__content",c),...p!=="none"?Oe(p,S):{},...V({...u,children:F()},z),initial:"exit",animate:C?"enter":"exit",exit:"exit",onAnimationComplete:Ce(K,u.onAnimationComplete),__css:Y})})});export{Ye as P,Ne as a,He as b,W as c,Xe as p,U as u};
