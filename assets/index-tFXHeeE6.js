import"./index-CBqU2yxZ.js";import{i as p}from"./factory-DKdOmnTE.js";let a=!1,r=null,t=!1,u=!1;const i=new Set,d=(e,n)=>i.forEach(s=>s(e,n)),f=e=>!(e.metaKey||!p&&e.altKey||e.ctrlKey||e.key==="Control"||e.key==="Shift"||e.key==="Meta"),c=e=>{t=!0,f(e)&&(r="keyboard",d("keyboard",e))},o=e=>{if(r="pointer",e.type==="mousedown"||e.type==="pointerdown"||e.type==="pointerup"){if(t=!0,(e.composedPath?e.composedPath()[0]:e.target).matches(":focus-visible"))return;d("pointer",e)}},m=e=>e.mozInputSource===0&&e.isTrusted?!0:e.detail===0&&!e.pointerType,y=e=>{m(e)&&(t=!0,r="virtual")},E=e=>{e.target===window||e.target===document||(!t&&!u&&(r="virtual",d("virtual",e)),t=!1,u=!1)},w=()=>{t=!1,u=!0},l=()=>r!=="pointer",L=()=>{if(typeof window>"u"||a)return;const{focus:e}=HTMLElement.prototype;HTMLElement.prototype.focus=function(...s){t=!0,this&&e.apply(this,s)},document.addEventListener("keydown",c,!0),document.addEventListener("keyup",c,!0),document.addEventListener("click",y,!0),window.addEventListener("focus",E,!0),window.addEventListener("blur",w,!1),typeof PointerEvent<"u"?(document.addEventListener("pointerdown",o,!0),document.addEventListener("pointermove",o,!0),document.addEventListener("pointerup",o,!0)):(document.addEventListener("mousedown",o,!0),document.addEventListener("mousemove",o,!0),document.addEventListener("mouseup",o,!0)),a=!0},b=e=>{L(),e(l());const n=()=>e(l());return i.add(n),()=>{i.delete(n)}};export{b as t};
