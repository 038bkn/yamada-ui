import{j as p,a as V}from"./jsx-runtime-5BUNAZ9W.js";import{u as _e}from"./index-JMKbXlj-.js";import{r as C}from"./index-4g5l5LRQ.js";import{b as ke,c as be,g as ne,a6 as ae,e as X,Q as Pe,h as w,o as ye,a as O,u as E,s as Se}from"./factory-Ddmu4EkR.js";import{u as ve,f as we}from"./form-control-oXY4zBAU.js";import{d as xe,h as U,c as oe,e as Ee,r as De,p as Re,f as Ne,g as Me,o as Te}from"./theme-provider-ePNg-PER.js";import{I as Oe}from"./icon-button-E64f5sWr.js";import{b as Ae}from"./icon-R3NodgbI.js";import{f as A}from"./forward-ref-A-8Arhkk.js";import{A as He}from"./alpha-slider-HcXNg6KV.js";import{H as Ve}from"./hue-slider-vKVXokNa.js";import{C as le}from"./color-swatch-de_js36i.js";import{I as je}from"./input-UydR1dcD.js";import{S as Le}from"./saturation-slider-xBvjOYx-.js";import{u as Be}from"./use-component-style-zqeBCG90.js";const We=()=>{const[n,u]=C.useState(!1);ke(()=>{u(typeof window<"u"&&"EyeDropper"in window)},[]);const s=C.useCallback((l={})=>n?new window.EyeDropper().open(l):Promise.resolve(void 0),[n]);return{supported:n,onOpen:s}},se=(n,u)=>{let[s,l,c,i]=Re(n,u)??[0,0,1,1];return i>1&&(i=1),{h:s,s:l,l:c,a:i}},te=(n,u)=>{let[s,l,c,i]=Ne(n,u)??[255,255,255,1];return s>255&&(s=255),l>255&&(l=255),c>255&&(c=255),i>1&&(i=1),{r:s,g:l,b:c,a:i}},Y=(n,u)=>{const[s,l,c,i]=Me(n,u);return{h:s,s:l,v:c,a:i}},[Fe,j]=be({name:"ColorPickerContext",errorMessage:`useColorPickerContext returned is 'undefined'. Seems you forgot to wrap the components in "<ColorPicker />"`}),Ie=({isInvalid:n,...u})=>{let{id:s,name:l,value:c,defaultValue:i,fallbackValue:r,onChange:m,onChangeStart:P,onChangeEnd:y,format:g,required:h,disabled:t,readOnly:d,onSwatchClick:D,...L}=ve({isInvalid:n,...u});const $=ne(P),z=ne(y),{supported:Z,onOpen:G}=We(),[_,q]=_e({value:c,defaultValue:i??r??"#ffffffff",onChange:m}),B=C.useRef(void 0),k=C.useRef(g??xe(_)),W=C.useRef(!1),[T,F]=C.useState(Y(_,r)),{h:x,s:R,v:N,a:I}=T,Q=k.current.endsWith("a"),ce=!(t||d),ie=C.useMemo(()=>{if(_.startsWith("hsl")){const{h:e,s:o,l:a,a:f}=se(_,r);let b=[{label:"H",space:"h",value:Math.round(e),min:0,max:360},{label:"S(%)",space:"s",value:Math.round(o*100),min:0,max:100},{label:"L(%)",space:"l",value:Math.round(a*100),min:0,max:100}];return Q&&(b=[...b,{label:"A(%)",space:"a",value:Math.round(f*100),min:0,max:100}]),b}else{const{r:e,g:o,b:a,a:f}=te(_,r);let b=[{label:"R",space:"r",value:Math.round(e),min:0,max:255},{label:"G",space:"g",value:Math.round(o),min:0,max:255},{label:"B",space:"b",value:Math.round(a),min:0,max:255}];return Q&&(b=[...b,{label:"A(%)",space:"a",value:Math.round(f*100),min:0,max:100}]),b}},[_,Q,r]),S=C.useCallback(e=>{ae(e)?F(Y(e,r)):F(o=>({...o,...e}))},[r]),H=C.useCallback(e=>{window.clearTimeout(B.current),W.current=!0;const{h:o,s:a,v:f,a:b}={...T,...e},M=U([o,a,f,b],r)(k.current);M&&$(M)},[k,$,r,T]),v=C.useCallback(e=>{window.clearTimeout(B.current),B.current=window.setTimeout(()=>{W.current=!1},200);let o;if(ae(e))o=oe(e,r)(k.current);else{const{h:a,s:f,v:b,a:M}={...T,...e};o=U([a,f,b,M],r)(k.current)}o&&z(o)},[k,z,r,T]),ee=C.useCallback((e,o)=>{let a=Math.floor(parseFloat(e.target.value));isNaN(a)&&(a=0),["s","l","a"].includes(o)&&(a=a/100);let f;if(_.startsWith("hsl")){const{h:b,s:M,l:J,a:K}=Object.assign(se(_,r),{[o]:a});f=Ee([b,M,J,K],r)(k.current)}else{const{r:b,g:M,b:J,a:K}=Object.assign(te(_,r),{[o]:a});f=De([b,M,J,K],r)(k.current)}f&&(S(f),v(f))},[_,S,v,k,r]),re=C.useCallback(async()=>{try{const{sRGBHex:e}=await G()??{};if(!e)return;S(e),v(e)}catch{}},[G,S,v]);X(()=>{const e=U([x,R,N,I],r)(k.current);e&&q(e)},[x,R,N,I,r]),X(()=>{W.current||c&&F(Y(c,r))},[c]),X(()=>{if(!g)return;k.current=g;const e=oe(_,r)(g);e&&q(e)},[g,r]);const ue=(e={},o=null)=>({...e,ref:o,...ye(L,["aria-readonly"])}),pe=C.useCallback((e={},o=null)=>({...Pe(L,we),...e,id:s,ref:o,type:"hidden",name:l,value:_,required:h,disabled:t,readOnly:d}),[t,s,l,d,h,L,_]),he=C.useCallback((e={},o=null)=>({required:h,disabled:t,readOnly:d,isInvalid:n,...e,ref:o,value:[x,R,N],onChange:w(e.onChange,([,a,f])=>S({s:a,v:f})),onChangeStart:w(e.onChangeStart,([,a,f])=>H({s:a,v:f})),onChangeEnd:w(e.onChangeEnd,([,a,f])=>v({s:a,v:f}))}),[h,t,d,n,x,R,N,S,H,v]),de=C.useCallback((e={},o=null)=>({required:h,disabled:t,readOnly:d,isInvalid:n,...e,ref:o,value:x,onChange:w(e.onChange,a=>S({h:a})),onChangeStart:w(e.onChangeStart,a=>H({h:a})),onChangeEnd:w(e.onChangeEnd,a=>v({h:a}))}),[h,t,d,n,x,S,H,v]),fe=C.useCallback((e={},o=null)=>({required:h,disabled:t,readOnly:d,isInvalid:n,...e,ref:o,value:I,color:U([x,R,N,I],r)(k.current),onChange:w(e.onChange,a=>S({a})),onChangeStart:w(e.onChangeStart,a=>H({a})),onChangeEnd:w(e.onChangeEnd,a=>v({a}))}),[r,h,t,d,n,k,x,R,N,I,S,H,v]),me=C.useCallback(({space:e,...o},a=null)=>({required:h,disabled:t,readOnly:d,isInvalid:n,...o,ref:a,type:"number",step:1,onChange:w(o.onChange,f=>ee(f,e))}),[h,t,d,n,ee]),Ce=C.useCallback((e={},o=null)=>({disabled:t,"aria-label":"Pick a color",...e,ref:o,onClick:w(e.onClick,re)}),[t,re]),ge=C.useCallback(({color:e,...o}={},a=null)=>({"aria-label":`select ${e} as the color`,disabled:t,readOnly:d,...o,ref:a,color:e,onClick:w(o.onClick,()=>{e&&(D==null||D(e),S(e),v(e))})}),[t,d,D,S,v]);return{value:_,onChange:S,eyeDropperSupported:Z,withAlpha:Q,isInteractive:ce,disabled:t,readOnly:d,channels:ie,getContainerProps:ue,getInputProps:pe,getSaturationSliderProps:he,getHueSliderProps:de,getAlphaSliderProps:fe,getEyeDropperProps:Ce,getChannelProps:me,getSwatchProps:ge}},$e=A(({className:n,...u},s)=>{const{getEyeDropperProps:l,readOnly:c,size:i,styles:r}=j(),m={h:"auto",minW:"auto",pointerEvents:c?"none":void 0,...r.eyeDropper};return p(Oe,{className:O("ui-color-picker__eye-dropper",n),variant:"outline",size:i,__css:m,...l(u,s),children:p(ze,{className:"ui-color-picker__eye-dropper__icon"})})}),ze=({...n})=>V(Ae,{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[p("path",{d:"m2 22 1-1h3l9-9"}),p("path",{d:"M3 21v-3l9-9"}),p("path",{d:"m15 6 3.4-3.4a2.1 2.1 0 1 1 3 3L18 9l.4.4a2.1 2.1 0 1 1-3 3l-3.8-3.8a2.1 2.1 0 1 1 3-3l.4.4Z"})]}),Ge=A(({className:n,hueSliderRef:u,hueSliderProps:s,alphaSliderRef:l,alphaSliderProps:c,...i},r)=>{let{size:m,withAlpha:P,getHueSliderProps:y,getAlphaSliderProps:g,styles:h}=j();m==="full"&&(m="lg");const t={display:"flex",flexDirection:"column",...h.sliders};return V(E.div,{ref:r,className:O("ui-color-picker__sliders",n),__css:t,...i,children:[p(Ve,{size:m,className:"ui-color-picker__hue-slider",__css:{...h.hueSlider},...y(s,u)}),P?p(He,{size:m,className:"ui-color-picker__alpha-slider",__css:{...h.alphaSlider},...g(c,l)}):null]})}),qe=A(({className:n,withEyeDropper:u=!0,withResult:s,eyeDropperRef:l,eyeDropperProps:c,hueSliderRef:i,hueSliderProps:r,alphaSliderRef:m,alphaSliderProps:P,...y},g)=>{const{value:h,eyeDropperSupported:t,styles:d}=j(),D={display:"flex",w:"full",...d.body};return V(E.div,{ref:g,className:O("ui-color-picker__body",n),__css:D,...y,children:[p(Ge,{hueSliderRef:i,hueSliderProps:r,alphaSliderRef:m,alphaSliderProps:P}),u&&t?p($e,{ref:l,...c}):null,s?p(le,{className:"ui-color-picker__result",color:h,__css:{...d.result}}):null]})}),Qe=A(({className:n,channelProps:u,...s},l)=>{const{withAlpha:c,channels:i,getChannelProps:r,styles:m}=j(),P={display:"grid",gridTemplateColumns:`repeat(${c?"4":"3"}, 1fr)`,...m.channels};return p(E.div,{ref:l,className:O("ui-color-picker__channels",n),__css:P,...s,children:i.map(({label:y,space:g,value:h,min:t,max:d})=>p(Ue,{channelLabel:y,...r({...u,space:g,value:h,min:t,max:d})},y))})}),Ue=A(({className:n,channelLabel:u,...s},l)=>{const c=C.useId();let{size:i,disabled:r,readOnly:m,styles:P}=j();i==="full"&&(i="lg");const y={...P.channel};return V(E.div,{className:O("ui-color-picker__channel",n),children:[u?p(E.label,{htmlFor:c,style:{cursor:r?"not-allowed":void 0},__css:{display:"block",pointerEvents:m?"none":void 0,...P.channelLabel},children:u}):null,p(je,{ref:l,id:c,size:i,__css:y,...s})]})}),Ze=A(({className:n,swatchesLabel:u,swatches:s,swatchesContainerProps:l,swatchProps:c,swatchesColumns:i,...r},m)=>{const{getSwatchProps:P,readOnly:y,styles:g}=j(),h={display:"grid",gridTemplateColumns:Se(i,t=>t!=null?`repeat(${t}, minmax(0, 1fr))`:void 0),...g.swatches};return s!=null&&s.length?V(E.div,{...l,children:[u?p(E.p,{className:"ui-color-picker__swatches__label",__css:{...g.swatchesLabel},children:u}):null,p(E.div,{ref:m,className:O("ui-color-picker__swatches",n),__css:h,...r,children:s.map(t=>p(le,{as:"button",__css:{boxSize:"full",pointerEvents:y?"none":void 0,...g.swatch},...P({color:t,...c})},t))})]}):null}),pr=A(({size:n,...u},s)=>{const[l,c]=Be("ColorPicker",{size:n,...u}),{className:i,withResult:r=!0,withPicker:m=!0,withChannel:P=!0,swatches:y,swatchesColumns:g=7,inputProps:h,withEyeDropper:t,eyeDropperRef:d,eyeDropperProps:D,saturationSliderRef:L,saturationSliderProps:$,hueSliderRef:z,hueSliderProps:Z,alphaSliderRef:G,alphaSliderProps:_,swatchesLabel:q,swatchProps:B,swatchesProps:k,...W}=Te(c),{getContainerProps:T,getInputProps:F,getSaturationSliderProps:x,...R}=Ie(W),N={display:"flex",flexDirection:"column",...l.container};return p(Fe,{value:{styles:l,size:n,...R},children:V(E.div,{ref:s,className:O("ui-color-picker",i),__css:N,...T(),children:[p(E.input,{...F(h,s)}),m?p(Le,{size:n,className:"ui-color-picker__saturation-slider",__css:{...l.saturationSlider},...x($,L)}):null,m?p(qe,{withResult:r,withEyeDropper:t,eyeDropperRef:d,eyeDropperProps:D,hueSliderRef:z,hueSliderProps:Z,alphaSliderRef:G,alphaSliderProps:_}):null,m&&P?p(Qe,{}):null,p(Ze,{swatchesLabel:q,swatches:y,swatchesColumns:g,swatchProps:B,...k})]})})});export{pr as C,ze as E,We as u};
