import{j as w,a as he}from"./jsx-runtime-5BUNAZ9W.js";import{r as s}from"./index-4g5l5LRQ.js";import{t as De,c as Se,a as Me}from"./number-T9-jc1Pg.js";import{g as O,h as I,e as Ve,b as Oe,Q as Y,o as Ee,z as Q,I as Te,c as Fe,u as G,a as T}from"./factory-Ei-jEUJK.js";import{u as Le}from"./index-Dy1R3NZX.js";import{u as je}from"./index-HG00gWUH.js";import{u as Ke,f as $}from"./form-control-l7lnk72n.js";import{c as Pe}from"./icon-UdJ0z_jp.js";import{f as F}from"./forward-ref-A-8Arhkk.js";import{u as Ue}from"./use-component-style-eekTqtz5.js";import{o as Be}from"./theme-provider-PZSzWP7q.js";const We=({min:t=Number.MIN_SAFE_INTEGER,max:r=Number.MAX_SAFE_INTEGER,keepWithinRange:a=!0,...n}={})=>{const l=O(n.onChange),[c,d]=s.useState(()=>n.defaultValue==null?"":J(n.defaultValue,n.step??1,n.precision)??""),f=typeof n.value<"u",u=f?n.value:c,D=ye(_(u),n.step??1),g=n.precision??D,C=s.useCallback(p=>{p!==u&&(f||d(p.toString()),l(p.toString(),_(p)))},[l,f,u]),b=s.useCallback(p=>{let m=p;return a&&(m=Me(m,t,r)),De(m,g)},[g,a,r,t]),h=s.useCallback((p=n.step??1)=>{let m;u===""?m=_(p):m=_(u)+p,m=b(m),C(m)},[b,n.step,C,u]),M=s.useCallback((p=n.step??1)=>{let m;u===""?m=_(-p):m=_(u)-p,m=b(m),C(m)},[b,n.step,C,u]),R=s.useCallback(()=>{let p;c==null?p="":p=J(c,n.step??1,n.precision)??t,C(p)},[c,n.precision,n.step,C,t]),o=s.useCallback(p=>{const m=J(p,n.step??1,g)??t;C(m)},[g,n.step,C,t]),k=_(u);return{isOut:k<t||r<k,isMax:k===r,isMin:k===t,precision:g,value:u,valueAsNumber:k,update:C,reset:R,increment:h,decrement:M,clamp:b,cast:o,setValue:d}},_=t=>parseFloat(t.toString().replace(/[^\w.-]+/g,"")),ye=(t,r)=>Math.max(Se(r),Se(t)),J=(t,r,a)=>(t=_(t),Number.isNaN(t)?void 0:De(t,a??ye(t,r))),qe=t=>/^[Ee0-9+\-.]$/.test(t),ze=({key:t,ctrlKey:r,altKey:a,metaKey:n},l)=>{if(t==null)return!0;const c=r||a||n;return!(t.length===1)||c?!0:l(t)},Ne=({ctrlKey:t,shiftKey:r,metaKey:a})=>{let n=1;return(a||t)&&(n=.1),r&&(n=10),n},Ge=(t={})=>{const{id:r,name:a,inputMode:n="decimal",pattern:l="[0-9]*(.[0-9]+)?",required:c,disabled:d,readOnly:f,focusInputOnChange:u=!0,clampValueOnBlur:D=!0,keepWithinRange:g=!0,allowMouseWheel:C,min:b=Number.MIN_SAFE_INTEGER,max:h=Number.MAX_SAFE_INTEGER,precision:M,"aria-invalid":R,...o}=Ke(t),k=c,Z=f,ee=d,[te,p]=s.useState(!1),m=!(f||d),E=s.useRef(null),L=s.useRef(null),ne=s.useRef(null),se=s.useRef(null),re=O(I(o.onFocus,e=>{var i;p(!0),L.current&&(e.target.selectionStart=L.current.start??((i=e.currentTarget.value)==null?void 0:i.length),e.currentTarget.selectionEnd=L.current.end??e.currentTarget.selectionStart)})),oe=O(I(o.onBlur,()=>{p(!1),D&&ke()})),x=O(o.onInvalid),j=O(o.isValidCharacter??qe),{isMin:ae,isMax:ce,isOut:ue,value:S,valueAsNumber:v,setValue:X,update:V,cast:ie,...K}=We({min:b,max:h,precision:M,keepWithinRange:g,...o}),U=s.useCallback(e=>e.split("").filter(j).join(""),[j]),B=s.useCallback(e=>{var i;return((i=o.parse)==null?void 0:i.call(o,e))??e},[o]),A=s.useCallback(e=>{var i;return(((i=o.format)==null?void 0:i.call(o,e))??e).toString()},[o]),W=s.useCallback((e=o.step??1)=>{m&&K.increment(e)},[m,K,o.step]),q=s.useCallback((e=o.step??1)=>{m&&K.decrement(e)},[m,K,o.step]),ke=s.useCallback(()=>{let e=S;if(S==="")return;/^[eE]/.test(S.toString())?X(""):(v<b&&(e=b),v>h&&(e=h),ie(e))},[ie,h,b,X,S,v]),le=s.useCallback(e=>{if(e.nativeEvent.isComposing)return;const i=B(e.currentTarget.value);V(U(i)),L.current={start:e.currentTarget.selectionStart,end:e.currentTarget.selectionEnd}},[B,V,U]),fe=s.useCallback(e=>{if(e.nativeEvent.isComposing)return;ze(e,j)||e.preventDefault();const i=Ne(e)*(o.step??1),N={ArrowUp:()=>W(i),ArrowDown:()=>q(i),Home:()=>V(b),End:()=>V(h)}[e.key];N&&(e.preventDefault(),N(e))},[q,W,j,h,b,o.step,V]),{up:me,down:de,stop:P,isSpinning:pe}=Xe(W,q);ve(ne,["disabled"],pe,P),ve(se,["disabled"],pe,P);const z=s.useCallback(()=>{u&&requestAnimationFrame(()=>{var e;(e=E.current)==null||e.focus()})},[u]),be=s.useCallback(e=>{e.preventDefault(),me(),z()},[z,me]),Ce=s.useCallback(e=>{e.preventDefault(),de(),z()},[z,de]);Ve(()=>{(v>h||v<b)&&(x==null||x("rangeOverflow",A(S),v))},[v,S,A,x]),Oe(()=>{if(!E.current||!(E.current.value!=S))return;const i=B(E.current.value);X(U(i))},[B,U]),Le(()=>E.current,"wheel",e=>{var Ie;const y=(((Ie=E.current)==null?void 0:Ie.ownerDocument)??document).activeElement===E.current;if(!C||!y)return;e.preventDefault();const N=Ne(e)*(o.step??1),ge=Math.sign(e.deltaY);ge===-1?W(N):ge===1&&q(N)},{passive:!1});const xe=s.useCallback((e={},i=null)=>({id:r,name:a,type:"text",inputMode:n,pattern:l,required:c,disabled:d,readOnly:f,...Y(o,$),...Ee(e,["defaultValue"]),ref:Q(E,i),value:A(S),"aria-invalid":Te(R??ue),autoComplete:"off",autoCorrect:"off",onChange:I(e.onChange,le),onKeyDown:I(e.onKeyDown,fe),onFocus:I(e.onFocus,re),onBlur:I(e.onBlur,oe)}),[r,a,n,l,c,d,f,o,A,S,R,ue,le,fe,re,oe]),Re=s.useCallback((e={},i=null)=>{const y=e.disabled||g&&ce;return{required:c,readOnly:f,disabled:y,...Y(o,$),...e,ref:Q(i,ne),role:"button",tabIndex:-1,cursor:f?"not-allowed":e.cursor,onPointerDown:I(e.onPointerDown,N=>{N.button===0&&!y&&be(N)}),onPointerLeave:I(e.onPointerLeave,P),onPointerUp:I(e.onPointerUp,P)}},[g,ce,c,f,o,P,be]),Ae=s.useCallback((e={},i=null)=>{const y=e.disabled||g&&ae;return{required:c,readOnly:f,disabled:y,...Y(o,$),...e,ref:Q(i,se),role:"button",tabIndex:-1,cursor:f?"not-allowed":e.cursor,onPointerDown:I(e.onPointerDown,N=>{N.button===0&&!y&&Ce(N)}),onPointerLeave:I(e.onPointerLeave,P),onPointerUp:I(e.onPointerUp,P)}},[g,ae,c,f,o,P,Ce]);return{value:A(S),valueAsNumber:v,isFocused:te,isRequired:k,isReadOnly:Z,isDisabled:ee,getInputProps:xe,getIncrementProps:Re,getDecrementProps:Ae}},He=50,we=300,Xe=(t,r)=>{const[a,n]=s.useState(!1),[l,c]=s.useState(null),[d,f]=s.useState(!0),u=s.useRef(null),D=()=>clearTimeout(u.current);je(()=>{l==="increment"&&t(),l==="decrement"&&r()},a?He:null);const g=s.useCallback(()=>{d&&t(),u.current=setTimeout(()=>{f(!1),n(!0),c("increment")},we)},[t,d]),C=s.useCallback(()=>{d&&r(),u.current=setTimeout(()=>{f(!1),n(!0),c("decrement")},we)},[r,d]),b=s.useCallback(()=>{f(!0),n(!1),D()},[]);return s.useEffect(()=>()=>D(),[]),{up:g,down:C,stop:b,isSpinning:a}},ve=(t,r,a,n)=>{s.useEffect(()=>{if(!t.current||!a)return;const l=t.current.ownerDocument.defaultView??window,c=new l.MutationObserver(d=>{for(const{type:f,attributeName:u}of d)f==="attributes"&&u&&r.includes(u)&&n()});return c.observe(t.current,{attributes:!0,attributeFilter:r}),()=>c.disconnect()})},[Ye,H]=Fe({strict:!1,name:"NumberInputContext"}),ft=F((t,r)=>{const[a,n]=Ue("NumberInput",t),{className:l,isStepper:c=!0,containerProps:d,addonProps:f,incrementProps:u,decrementProps:D,onChange:g,...C}=Be(n),{getInputProps:b,getIncrementProps:h,getDecrementProps:M}=Ge({onChange:g,...C}),R={position:"relative",zIndex:0,...a.container};return w(Ye,{value:{getInputProps:b,getIncrementProps:h,getDecrementProps:M,styles:a},children:he(G.div,{className:T("ui-number-input",l),__css:R,...d,children:[w(Qe,{...b(Ee(C,["keepWithinRange","clampValueOnBlur","isDisabled","isReadOnly","isRequired","isInvalid","allowMouseWheel","onInvalid","getAriaValueText","isValidCharacter","parse","format"]),r)}),c?he($e,{...f,children:[w(Je,{...u}),w(Ze,{...D})]}):null]})})}),Qe=F(({className:t,...r},a)=>{const{styles:n}=H(),l={width:"100%",...n.field};return w(G.input,{ref:a,className:T("ui-number-input__field",t),__css:l,...r})}),$e=F(({className:t,...r},a)=>{const{styles:n}=H(),l={display:"flex",flexDirection:"column",position:"absolute",top:"0",insetEnd:"0px",margin:"1px",height:"calc(100% - 2px)",zIndex:"yamcha",...n.addon};return w(G.div,{ref:a,className:T("ui-number-input__addon",t),"aria-hidden":!0,__css:l,...r})}),_e=G("div",{baseStyle:{display:"flex",justifyContent:"center",alignItems:"center",flex:1,transitionProperty:"common",transitionDuration:"normal",userSelect:"none",cursor:"pointer",lineHeight:"normal"}}),Je=F(({className:t,children:r,...a},n)=>{const{getIncrementProps:l,styles:c}=H(),d={...c.stepper};return w(_e,{className:T("ui-number-input__stepper--up",t),...l(a,n),__css:d,children:r??w(Pe,{__css:{transform:"rotate(180deg)"}})})}),Ze=F(({className:t,children:r,...a},n)=>{const{getDecrementProps:l,styles:c}=H(),d={...c.stepper};return w(_e,{className:T("ui-number-input__stepper--down",t),...l(a,n),__css:d,children:r??w(Pe,{})})});export{ft as N,Ge as u};
