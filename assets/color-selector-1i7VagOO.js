import{j as l}from"./jsx-runtime-Nms4Y4qS.js";import{u as Se}from"./index-DsxzWwQ3.js";import{r as f}from"./index-BwDkhjyp.js";import{u as xe,l as _e,k as ae,Y as X,f as ee,T as be,h as j,R as ve,c as O,b as k,r as ye,B as Pe}from"./factory-R2Y4PRbz.js";import{u as je,f as we}from"./form-control-PnKEaoct.js";import{e as ke,c as se,h as Y,g as Ee,r as De,p as Re,i as Ne,j as Me,o as Te}from"./theme-provider-DgHPuWDh.js";import{I as Ve}from"./icon-button-B9mp7f_7.js";import{b as Oe}from"./icon-Cag4izmS.js";import{f as A}from"./forward-ref-BmTAT9U5.js";import{A as Ae}from"./alpha-slider-CSkecdiF.js";import{H as He}from"./hue-slider-BGxuGhTu.js";import{C as ce}from"./color-swatch-CBXOh_Zz.js";import{I as Le}from"./input-CULoLG38.js";import{S as Be}from"./saturation-slider-BzTl18eF.js";import{a as Fe}from"./use-component-style-DhC_P_n8.js";const We=()=>{const[s,h]=f.useState(!1);xe(()=>{h(typeof window<"u"&&"EyeDropper"in window)},[]);const a=f.useCallback((c={})=>s?new window.EyeDropper().open(c):Promise.resolve(void 0),[s]);return{supported:s,onOpen:a}},ne=(s,h)=>{let[a,c,i,u]=Re(s,h)??[0,0,1,1];return u>1&&(u=1),{h:a,s:c,l:i,a:u}},le=(s,h)=>{let[a,c,i,u]=Ne(s,h)??[255,255,255,1];return a>255&&(a=255),c>255&&(c=255),i>255&&(i=255),u>1&&(u=1),{r:a,g:c,b:i,a:u}},oe=(s,h)=>{const[a,c,i,u]=Me(s,h);return{h:a,s:c,v:i,a:u}},[Ie,B]=_e({name:"ColorSelectorContext",errorMessage:`useColorSelectorContext returned is 'undefined'. Seems you forgot to wrap the components in "<ColorSelector />"`}),$e=({isInvalid:s,...h})=>{let{id:a,name:c,value:i,defaultValue:u,fallbackValue:o,onChange:C,onChangeStart:S,onChangeEnd:_,format:b,required:p,disabled:n,readOnly:d,onSwatchClick:E,...F}=je({isInvalid:s,...h});const z=ae(S),G=ae(_),{supported:Z,onOpen:q}=We(),[M,U]=Se({value:i,defaultValue:u??o,onChange:C}),g=f.useMemo(()=>b??ke(M??"#ffffff"),[M,b]),v=se(M,"#ffffff")(g),W=f.useRef(void 0),I=f.useRef(!1),[T,$]=f.useState(oe(v,o)),{h:w,s:D,v:R,a:V}=T,H=g.endsWith("a"),J=!(n||d),ie=f.useMemo(()=>{if(v.startsWith("hsl")){const{h:e,s:t,l:r,a:m}=ne(v,o);let x=[{label:"H",space:"h",value:Math.round(e),min:0,max:360},{label:"S(%)",space:"s",value:Math.round(t*100),min:0,max:100},{label:"L(%)",space:"l",value:Math.round(r*100),min:0,max:100}];return H&&(x=[...x,{label:"A(%)",space:"a",value:Math.round(m*100),min:0,max:100}]),x}else{const{r:e,g:t,b:r,a:m}=le(v,o);let x=[{label:"R",space:"r",value:Math.round(e),min:0,max:255},{label:"G",space:"g",value:Math.round(t),min:0,max:255},{label:"B",space:"b",value:Math.round(r),min:0,max:255}];return H&&(x=[...x,{label:"A(%)",space:"a",value:Math.round(m*100),min:0,max:100}]),x}},[v,H,o]),y=f.useCallback(e=>{X(e)?$(oe(e,o)):$(t=>({...t,...e}))},[o]),L=f.useCallback(e=>{window.clearTimeout(W.current),I.current=!0;const{h:t,s:r,v:m,a:x}={...T,...e},N=Y([t,r,m,x],o)(g);N&&z(N)},[z,o,T,g]),P=f.useCallback(e=>{window.clearTimeout(W.current),W.current=window.setTimeout(()=>{I.current=!1},200);let t;if(X(e))t=se(e,o)(g);else{const{h:r,s:m,v:x,a:N}={...T,...e};t=Y([r,m,x,N],o)(g)}t&&G(t)},[G,o,T,g]),re=f.useCallback((e,t)=>{let r=Math.floor(parseFloat(e.target.value));isNaN(r)&&(r=0),["s","l","a"].includes(t)&&(r=r/100);let m;if(v.startsWith("hsl")){const{h:x,s:N,l:K,a:Q}=Object.assign(ne(v,o),{[t]:r});m=Ee([x,N,K,Q],o)(g)}else{const{r:x,g:N,b:K,a:Q}=Object.assign(le(v,o),{[t]:r});m=De([x,N,K,Q],o)(g)}m&&(y(m),P(m))},[v,y,P,o,g]),te=f.useCallback(async()=>{try{const{sRGBHex:e}=await q()??{};if(!e)return;y(e),P(e)}catch{}},[q,y,P]);ee(()=>{const e=Y([w,D,R,V],o)(g);e&&U(e)},[w,D,R,V]),ee(()=>{I.current||i&&$(oe(i,o))},[i]),ee(()=>{if(!g||!M)return;const e=se(M,o)(g);e&&U(e)},[g]);const ue=(e={},t=null)=>({...e,ref:t,...ve(F,["aria-readonly"])}),he=f.useCallback((e={},t=null)=>({...be(F,we),...e,id:a,ref:t,type:"hidden",name:c,value:v,required:p,disabled:n,readOnly:d}),[n,a,c,d,p,F,v]),pe=f.useCallback((e={},t=null)=>({required:p,disabled:n,readOnly:d,isInvalid:s,...e,ref:t,value:[w,D,R],onChange:j(e.onChange,([,r,m])=>y({s:r,v:m})),onChangeStart:j(e.onChangeStart,([,r,m])=>L({s:r,v:m})),onChangeEnd:j(e.onChangeEnd,([,r,m])=>P({s:r,v:m}))}),[p,n,d,s,w,D,R,y,L,P]),de=f.useCallback((e={},t=null)=>({required:p,disabled:n,readOnly:d,isInvalid:s,...e,ref:t,value:w,onChange:j(e.onChange,r=>y({h:r})),onChangeStart:j(e.onChangeStart,r=>L({h:r})),onChangeEnd:j(e.onChangeEnd,r=>P({h:r}))}),[p,n,d,s,w,y,L,P]),me=f.useCallback((e={},t=null)=>({required:p,disabled:n,readOnly:d,isInvalid:s,...e,ref:t,value:V,color:Y([w,D,R,V],o)(g),onChange:j(e.onChange,r=>y({a:r})),onChangeStart:j(e.onChangeStart,r=>L({a:r})),onChangeEnd:j(e.onChangeEnd,r=>P({a:r}))}),[o,p,n,d,s,g,w,D,R,V,y,L,P]),fe=f.useCallback(({space:e,...t},r=null)=>({required:p,disabled:n,readOnly:d,isInvalid:s,...t,ref:r,type:"number",step:1,onChange:j(t.onChange,m=>re(m,e))}),[p,n,d,s,re]),Ce=f.useCallback((e={},t=null)=>({disabled:n,"aria-label":"Pick a color",...e,ref:t,onClick:j(e.onClick,te)}),[n,te]),ge=f.useCallback(({color:e,...t}={},r=null)=>({"aria-label":`Select ${e} as the color`,disabled:n,readOnly:d,...t,ref:r,color:e,onClick:j(t.onClick,()=>{X(e)&&(E==null||E(e),y(e),P(e))})}),[n,d,E,y,P]);return{value:v,onChange:y,eyeDropperSupported:Z,withAlpha:H,isInteractive:J,disabled:n,readOnly:d,channels:ie,getContainerProps:ue,getInputProps:he,getSaturationSliderProps:pe,getHueSliderProps:de,getAlphaSliderProps:me,getEyeDropperProps:Ce,getChannelProps:fe,getSwatchProps:ge}},ze=A(({className:s,...h},a)=>{const{getEyeDropperProps:c,readOnly:i,size:u,styles:o}=B(),C={h:"auto",minW:"auto",pointerEvents:i?"none":void 0,...o.eyeDropper};return l.jsx(Ve,{className:O("ui-color-selector__eye-dropper",s),variant:"outline",size:u,__css:C,...c(h,a),children:l.jsx(Ge,{className:"ui-color-selector__eye-dropper__icon"})})}),Ge=({...s})=>l.jsxs(Oe,{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[l.jsx("path",{d:"m2 22 1-1h3l9-9"}),l.jsx("path",{d:"M3 21v-3l9-9"}),l.jsx("path",{d:"m15 6 3.4-3.4a2.1 2.1 0 1 1 3 3L18 9l.4.4a2.1 2.1 0 1 1-3 3l-3.8-3.8a2.1 2.1 0 1 1 3-3l.4.4Z"})]}),qe=A(({className:s,hueSliderRef:h,hueSliderProps:a,alphaSliderRef:c,alphaSliderProps:i,...u},o)=>{let{size:C,withAlpha:S,getHueSliderProps:_,getAlphaSliderProps:b,styles:p}=B();C==="full"&&(C="lg");const n={display:"flex",flexDirection:"column",...p.sliders};return l.jsxs(k.div,{ref:o,className:O("ui-color-selector__sliders",s),__css:n,...u,children:[l.jsx(He,{size:C,className:"ui-color-selector__hue-slider",__css:{...p.hueSlider},..._(a,h)}),S?l.jsx(Ae,{size:C,className:"ui-color-selector__alpha-slider",__css:{...p.alphaSlider},...b(i,c)}):null]})}),Ue=A(({className:s,withEyeDropper:h=!0,withResult:a,eyeDropperRef:c,eyeDropperProps:i,hueSliderRef:u,hueSliderProps:o,alphaSliderRef:C,alphaSliderProps:S,..._},b)=>{const{value:p,eyeDropperSupported:n,styles:d}=B(),E={display:"flex",w:"100%",...d.body};return l.jsxs(k.div,{ref:b,className:O("ui-color-selector__body",s),__css:E,..._,children:[l.jsx(qe,{hueSliderRef:u,hueSliderProps:o,alphaSliderRef:C,alphaSliderProps:S}),h&&n?l.jsx(ze,{ref:c,...i}):null,a?l.jsx(ce,{className:"ui-color-selector__result",color:p,__css:{...d.result}}):null]})}),Ye=A(({className:s,channelProps:h,...a},c)=>{const{withAlpha:i,channels:u,getChannelProps:o,styles:C}=B(),S={display:"grid",gridTemplateColumns:`repeat(${i?"4":"3"}, 1fr)`,...C.channels};return l.jsx(k.div,{ref:c,className:O("ui-color-selector__channels",s),__css:S,...a,children:u.map(({label:_,space:b,value:p,min:n,max:d})=>l.jsx(Ze,{channelLabel:_,...o({...h,space:b,value:p,min:n,max:d})},_))})}),Ze=A(({className:s,channelLabel:h,...a},c)=>{const i=f.useId();let{size:u,disabled:o,readOnly:C,styles:S}=B();u==="full"&&(u="lg");const _={...S.channel};return l.jsxs(k.div,{className:O("ui-color-selector__channel",s),children:[h?l.jsx(k.label,{htmlFor:i,style:{cursor:o?"not-allowed":void 0},__css:{display:"block",pointerEvents:C?"none":void 0,...S.channelLabel},children:h}):null,l.jsx(Le,{ref:c,id:i,size:u,__css:_,...a})]})}),Je=A(({className:s,swatchesLabel:h,swatches:a,swatchesContainerProps:c,swatchProps:i,swatchesColumns:u,...o},C)=>{const{getSwatchProps:S,readOnly:_,styles:b}=B(),p={display:"grid",gridTemplateColumns:ye(u,n=>n!=null?`repeat(${n}, minmax(0, 1fr))`:void 0),...b.swatches};return a!=null&&a.length?l.jsxs(k.div,{...c,children:[h?l.jsx(k.p,{className:"ui-color-selector__swatches__label",__css:{...b.swatchesLabel},children:h}):null,l.jsx(k.div,{ref:C,className:O("ui-color-selector__swatches",s),__css:p,...o,children:a.map(n=>l.jsx(ce,{as:"button",__css:{boxSize:"100%",pointerEvents:_?"none":void 0,...b.swatch},...S({color:n,...i})},n))})]}):null}),ps=A(({size:s,...h},a)=>{const[c,i]=Fe("ColorSelector",{size:s,...h}),{className:u,children:o,withResult:C=!0,withPicker:S=!0,withChannel:_=!0,swatches:b,swatchesColumns:p=7,inputProps:n,withEyeDropper:d,eyeDropperRef:E,eyeDropperProps:F,saturationSliderRef:z,saturationSliderProps:G,hueSliderRef:Z,hueSliderProps:q,alphaSliderRef:M,alphaSliderProps:U,swatchesLabel:g,swatchProps:v,swatchesProps:W,channelsProps:I,channelProps:T,...$}=Te(i),{value:w,getContainerProps:D,getInputProps:R,getSaturationSliderProps:V,...H}=$e($),J={display:"flex",flexDirection:"column",...c.container};return l.jsx(Ie,{value:{styles:c,size:s,value:w,...H},children:l.jsxs(k.div,{ref:a,className:O("ui-color-selector",u),__css:J,...D(),children:[l.jsx(k.input,{...R(n,a)}),S?l.jsx(Be,{size:s,className:"ui-color-selector__saturation-slider",__css:{...c.saturationSlider},...V(G,z)}):null,S?l.jsx(Ue,{withResult:C,withEyeDropper:d,eyeDropperRef:E,eyeDropperProps:F,hueSliderRef:Z,hueSliderProps:q,alphaSliderRef:M,alphaSliderProps:U}):null,S&&_?l.jsx(Ye,{channelProps:T,...I}):null,l.jsx(Je,{swatchesLabel:g,swatches:b,swatchesColumns:p,swatchProps:v,...W}),Pe(o,{value:w})]})})});export{ps as C,Ge as E,We as u};
