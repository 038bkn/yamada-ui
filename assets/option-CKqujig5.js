import{j as g}from"./jsx-runtime-Nms4Y4qS.js";import{u as $e}from"./index-BtctO16n.js";import{r as n}from"./index-BwDkhjyp.js";import{c as qe,a as Xe}from"./icon-Bq_LsFku.js";import{f as se}from"./forward-ref-DKTvpK5d.js";import{l as Ye,T as Je,S as He,a2 as Me,X as Qe,s as K,af as Ze,U as et,q as tt,f as st,R as nt,a as xe,h as te,d as be,x as Be,aj as ot,V as me,t as lt,b as L,c as X,j as ct}from"./factory-CKqVSKj1.js";import{b as at}from"./popover-content-CugxI10r.js";import{u as it}from"./index-Yk47zk-U.js";import{c as rt}from"./index-azatzDXB.js";import{u as ut}from"./index-DeN1XzU7.js";import{u as dt}from"./index-D3Ssu5BV.js";import{u as ft,f as pt}from"./form-control-CqkY70re.js";const mt=o=>{var c;return ot(o)&&!!((c=o==null?void 0:o.getAttribute("role"))!=null&&c.startsWith("option"))},{DescendantsContextProvider:At,useDescendantsContext:Ue,useDescendants:xt,useDescendant:bt}=rt(),[Lt,H]=Ye({strict:!1,name:"SelectContext"}),Nt=o=>{const{placeholder:c,closeOnSelect:l=!0,placeholderInOptions:a=!0,omitSelectedValues:t=!1,maxSelectValues:u,isEmpty:d,value:C,defaultValue:v,onChange:S,optionProps:y,isOpen:p,defaultIsOpen:P,onOpen:I,onClose:j,closeOnBlur:i=!0,closeOnEsc:m=!0,openDelay:T,closeDelay:Y,isLazy:ne,lazyBehavior:D,animation:z,duration:oe=.2,offset:le,gutter:M,preventOverflow:J,flip:ce,matchWidth:he=!0,boundary:ae,eventListeners:W,strategy:Ce,placement:N="bottom-start",modifiers:$,...V}=ft(o),{"aria-readonly":Pe,...x}=Je(V,pt),[ie,Ie]=He(Qe(V,["aria-readonly"]),Me),f=xt(),[R,_]=n.useState(-1),[je,De]=n.useState(!1),re=n.useRef(null),Fe=n.useRef(null),we=n.useRef(null),G=n.useRef(new Set([])),[F,ue]=it({value:C,defaultValue:v,onChange:S}),[q,ve]=n.useState(void 0),Q=R>-1,b=K(F),Ee=(b?!F.length:!F)&&!(c&&a),B=f.values(({node:e})=>b&&F.includes(e.dataset.value??"")).map(({index:e})=>e),A=f.enabledValues(({index:e})=>!B.includes(e)),de=n.useCallback(()=>{const e=setTimeout(()=>{const s=f.enabledFirstValue();if(s)if(!b||!t)_(s.index);else if(B.includes(s.index)){const h=A[0];_(h.index)}else _(s.index)});G.current.add(e)},[f,A,b,t,B]),fe=n.useCallback(()=>{const e=setTimeout(()=>{const s=f.enabledLastValue();if(s)if(!b||!t)_(s.index);else if(B.includes(s.index)){const h=A.reverse()[0];_(h.index)}else _(s.index)});G.current.add(e)},[f,A,b,t,B]),ge=n.useCallback(()=>{const e=setTimeout(()=>{const h=f.enabledValues().find(({node:k})=>b?F.includes(k.dataset.value??""):k.dataset.value===F);h&&_(h.index)});G.current.add(e)},[f,b,F]),Z=n.useCallback(()=>{const e=setTimeout(()=>{const s=f.enabledNextValue(R);if(s)if(!b||!t)_(s.index);else if(B.includes(s.index)){const h=A.find(({index:k})=>s.index<k)??A[0];_(h.index)}else _(s.index)});G.current.add(e)},[f,A,R,b,t,B,_]),Se=n.useCallback(()=>{const e=setTimeout(()=>{const s=f.enabledPrevValue(R);if(s)if(!b||!t)_(s.index);else if(B.includes(s.index)){const h=A.reverse().find(({index:k})=>k<s.index)??A[0];_(h.index)}else _(s.index)});G.current.add(e)},[f,A,R,b,t,B,_]),U=Ee||t?de:ge,Ve=Ee||t?fe:ge,_e=n.useCallback((e,s=!0)=>{const h=f.values();if(!h.length)return;const k=h.filter(({node:O})=>O.dataset.value===e).map(({node:O,index:ee})=>{if(!(c&&a)||ee!==0){const pe=Array.from(O.children).find(ke=>ke.getAttribute("data-label")!==null);return(pe==null?void 0:pe.innerHTML)??""}else return});ve(O=>b?(k.forEach(ee=>{K(O)&&O.includes(ee??"")?s&&(O=K(O)?O.filter(ke=>ke!==ee):void 0):O=[...K(O)?O:[],ee]}),O):k[0])},[f,b,c,a]),ye=n.useCallback(e=>{ue(s=>K(s)?s.includes(e)?s.filter(k=>k!==e):[...s,e]:e),_e(e)},[_e,ue]),Ge=n.useCallback(e=>{e.stopPropagation(),ue([]),ve(void 0)},[ve,ue]),{isOpen:r,onOpen:Te,onClose:w}=ut({isOpen:p,defaultIsOpen:P,onOpen:I,onClose:j}),E=n.useCallback(()=>{x.disabled||x.readOnly||d||je||Te()},[x,d,je,Te]),Oe=n.useCallback(()=>{let e=f.value(R);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const s=e.node.dataset.value??"";ye(s),l&&w(),t&&Z()},[l,f,R,t,ye,w,Z]),Re=n.useCallback(()=>{r||(E(),U())},[r,U,E]),Ae=n.useCallback(()=>{r||(E(),U())},[r,U,E]),Le=n.useCallback(e=>{const s=Ze(e);et(re.current,s)||i&&r&&w()},[i,r,w]),Ne=n.useCallback(e=>{if(e.key===" "&&(e.key=e.code),x.disabled||x.readOnly)return;const h={ArrowDown:Q?()=>Z():r?void 0:me(E,U),ArrowUp:Q?()=>Se():r?void 0:me(E,Ve),Space:Q?Oe:r?void 0:me(E,U),Enter:Q?Oe:r?void 0:me(E,U),Home:r?de:void 0,End:r?fe:void 0,Escape:m?w:void 0}[e.key];h&&(e.preventDefault(),e.stopPropagation(),h())},[x.disabled,x.readOnly,Q,r,E,U,Ve,Oe,de,fe,m,w,Z,Se]);dt({ref:re,handler:w,enabled:r&&i}),n.useEffect(()=>{if(!b||!t&&tt(u))return;const e=F.length>0&&F.length===f.count(),s=F.length===u;e||s?(w(),De(!0)):De(!1)},[t,F,f,b,w,u]),st(()=>{r||_(-1)},[r]),nt(()=>{G.current.forEach(e=>clearTimeout(e)),G.current.clear()});const Ke=n.useCallback(e=>({closeOnBlur:i,openDelay:T,closeDelay:Y,isLazy:ne,lazyBehavior:D,animation:z,duration:oe,offset:le,gutter:M,preventOverflow:J,flip:ce,matchWidth:he,boundary:ae,eventListeners:W,strategy:Ce,placement:N,modifiers:$,...e,trigger:"never",closeOnButton:!1,isOpen:r,onOpen:E,onClose:w}),[i,T,Y,ne,D,z,oe,le,M,J,ce,he,ae,W,Ce,N,$,r,E,w]),ze=n.useCallback((e={},s=null)=>({ref:xe(re,s),...ie,...e,...x,onClick:te(e.onClick,V.onClick,Re),onBlur:te(e.onBlur,V.onBlur,Le)}),[ie,x,Le,Re,V]),We=n.useCallback(({"aria-label":e,...s}={},h=null)=>{var k,O;return e??(e=c??`Select ${b?"one or more options.":"an option."}`),{"aria-label":e,role:"combobox",ref:xe(Fe,h),tabIndex:0,...Ie,...s,"data-active":be(r),"data-placeholder":be(b?!(q!=null&&q.length):q===void 0),"aria-controls":(k=we.current)==null?void 0:k.id,"aria-activedescendant":(O=f.value(R))==null?void 0:O.node.id,"aria-expanded":r,onFocus:te(s.onFocus,V.onFocus,Ae),onKeyDown:te(s.onKeyDown,V.onKeyDown,Ne)}},[f,Ie,R,r,b,q,c,V,Ae,Ne]);return{descendants:f,value:F,label:q,focusedIndex:R,placeholder:c,placeholderInOptions:a,omitSelectedValues:t,closeOnSelect:l,isOpen:r,containerRef:re,fieldRef:Fe,listRef:we,optionProps:y,formControlProps:x,onChangeLabel:_e,onChange:ye,onClear:Ge,onOpen:E,onClose:w,onFocusFirst:de,onFocusLast:fe,onFocusSelected:ge,onFocusNext:Z,onFocusPrev:Se,setFocusedIndex:_,getPopoverProps:Ke,getContainerProps:ze,getFieldProps:We}},ht=()=>{const{listRef:o,focusedIndex:c}=H(),l=Ue(),a=n.useRef(-1),t=l.value(c);n.useEffect(()=>{if(!o.current||!t||a.current===t.index)return;const C=o.current,v=t.node,S=C.clientHeight,y=C.scrollTop,p=y+S,P=v.clientHeight,I=v.offsetTop,j=I+P,i=y<=I&&j<=p,m=a.current<t.index;i||(j<=S?o.current.scrollTo({top:0}):m?o.current.scrollTo({top:j-S}):o.current.scrollTo({top:I+1})),a.current=t.index},[o,t]);const u=n.useId();return{getListProps:n.useCallback((C={},v=null)=>({id:u,ref:xe(o,v),role:"listbox",tabIndex:-1,position:"relative",...C}),[u,o])}},Ct=({label:o,...c})=>{const{value:l,omitSelectedValues:a}=H(),t=K(l),u=Ue(),d=u.values(),v=(t&&a?u.values(({node:i})=>l.includes(i.dataset.value??"")):[]).map(({index:i})=>i),y=!d.filter(({node:i,index:m})=>{var T;return((T=i.parentElement)==null?void 0:T.dataset.label)===o&&!v.includes(m)}).length,[p,P]=He(c,Me),I=n.useCallback((i={},m=null)=>({ref:m,...i,...p,style:y?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"}:void 0}),[p,y]),j=n.useCallback(({"aria-label":i,...m}={},T=null)=>(i??(i=o),{"aria-label":i,ref:T,role:"group",...m,...P,"data-label":o}),[P,o]);return{label:o,getContainerProps:I,getGroupProps:j}},vt=(o,c)=>{const{fieldRef:l,value:a,placeholder:t,placeholderInOptions:u,omitSelectedValues:d,closeOnSelect:C,focusedIndex:v,optionProps:S,onChange:y,onChangeLabel:p,onFocusNext:P,onClose:I,setFocusedIndex:j}=H();let{icon:i,isDisabled:m,isFocusable:T,closeOnSelect:Y,children:ne,value:D,...z}={...S,...c};const oe=!!m&&!T,le=n.useRef(null),{index:M,register:J,descendants:ce}=bt({disabled:oe}),ae=ce.values().slice(0,M),W=K(a),N=!(W?!1:ae.some(({node:x})=>x.dataset.value===(D??"")))&&(W?a.includes(D??""):(D??"")===a),$=M===v;t&&M>0&&u&&!D&&console.warn(`${W?"MultiSelect":"Select"}: If placeholders are present, All options must be set value. If want to set an empty value, either don't set the placeholder or set 'placeholderInOptions' to false.`);const V=n.useCallback(x=>{if(x.preventDefault(),x.stopPropagation(),m){l.current&&l.current.focus();return}if(!mt(x.currentTarget)){l.current&&l.current.focus();return}j(M),y(D??""),l.current&&l.current.focus(),(Y??C)&&I(),d&&P()},[m,j,M,y,D,l,Y,C,I,d,P]);n.useEffect(()=>{N&&p(D??"",!1)},[D,N,p]);const Pe=n.useCallback((x={})=>{const ie={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};return{role:"option",ref:xe(le,o,J),...z,...x,tabIndex:-1,style:d&&N?ie:void 0,"data-value":D??"","data-focus":be($),"data-disabled":be(m),"aria-checked":Be(N),"aria-disabled":Be(m),onClick:te(z.onClick,x.onClick,V)}},[D,z,m,$,N,d,V,o,J]);return{isSelected:N,isFocused:$,customIcon:i,children:ne,getOptionProps:Pe}},gt=se(({className:o,children:c,__css:l,...a},t)=>{const{styles:u}=H(),d={position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",cursor:"pointer",...u.icon,...l},v=lt(c).map(S=>n.cloneElement(S,{focusable:!1,"aria-hidden":!0,style:{maxWidth:"1em",maxHeight:"1em",color:"currentColor"}}));return g.jsx(L.div,{ref:t,className:X("ui-select__icon",o),__css:d,...a,children:ct(c)?v:g.jsx(qe,{})})}),Bt=({className:o,children:c,...l})=>{const a=n.useRef(null),{styles:t}=H(),u=l.disabled,d=$e({ref:a,isDisabled:u,...l});return g.jsx(gt,{"aria-label":"Clear value",className:X("ui-select__clear-icon",o),__css:t.clearIcon,...d,children:c??g.jsx(Xe,{w:"0.5em",h:"0.5em"})})},Ht=se(({className:o,w:c,width:l,minW:a,minWidth:t,contentProps:u,header:d,footer:C,children:v,...S},y)=>{var I,j,i,m;const{styles:p}=H(),{getListProps:P}=ht();return l??(l=c),l??(l=((I=p.list)==null?void 0:I.width)??((j=p.list)==null?void 0:j.w)),t??(t=a),t??(t=((i=p.list)==null?void 0:i.minWidth)??((m=p.list)==null?void 0:m.minW)),g.jsxs(at,{as:"div",className:"ui-select__content",width:l,minWidth:t,__css:{...p.content,width:l,minWidth:t},...u,children:[d?g.jsx(L.div,{className:"ui-select__header",__css:{...p.header},children:d}):null,g.jsx(L.ul,{className:X("ui-select__list",o),__css:{...p.list},...P(S,y),children:v}),C?g.jsx(L.div,{className:"ui-select__footer",__css:{...p.footer},children:C}):null]})}),Mt=se(({className:o,color:c,h:l,height:a,minH:t,minHeight:u,children:d,...C},v)=>{const{styles:S}=H(),{label:y,getContainerProps:p,getGroupProps:P}=Ct(C);return l??(l=a),t??(t=u),g.jsxs(L.li,{className:X("ui-select__item","ui-select__item--group",o),__css:{w:"100%",h:"fit-content",color:c},...p(),children:[g.jsx(L.span,{className:"ui-select__item__group-label",__css:S.groupLabel,lineClamp:1,children:y}),g.jsx(L.ul,{...P({},v),className:"ui-select__item__group",__css:{h:l,minH:t,...S.group},children:d})]})}),Ut=se(({id:o,className:c,icon:l,...a},t)=>{const{styles:u}=H(),{isSelected:d,customIcon:C,children:v,getOptionProps:S}=vt(t,a);o??(o=n.useId()),l??(l=C);const y={textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,gap:"0.75rem",...u.item};return g.jsxs(L.li,{id:o,className:X("ui-select__item",c),__css:y,...S(),children:[l!==null?g.jsx(St,{opacity:d?1:0,children:l||g.jsx(_t,{})}):null,g.jsx(L.span,{style:{flex:1},"data-label":!0,children:v})]})}),St=se(({className:o,...c},l)=>{const{styles:a}=H(),t={flexShrink:0,display:"inline-flex",justifyContent:"center",alignItems:"center",fontSize:"0.85em",...a.itemIcon};return g.jsx(L.span,{ref:l,className:X("ui-select__item__icon",o),__css:t,...c})}),_t=()=>g.jsx("svg",{viewBox:"0 0 14 14",width:"1em",height:"1em",children:g.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})});export{Ut as O,At as S,Mt as a,Lt as b,gt as c,Ht as d,H as e,Bt as f,Nt as u};
