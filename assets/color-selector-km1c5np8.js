import{j as h,a as L}from"./jsx-runtime-TtYKBvr-.js";import{u as Se}from"./index-EQvUcbnd.js";import{r as f}from"./index-IybTgENJ.js";import{b as _e,c as be,g as se,a6 as ne,e as ee,Q as ye,h as x,o as ve,a as A,u as E,s as Pe,B as we}from"./factory-ilkGXtBr.js";import{u as xe,f as ke}from"./form-control-ZJLHMW15.js";import{d as Ee,h as U,c as ae,f as De,r as Re,p as Ne,g as Me,i as Te,o as Oe}from"./theme-provider-xH9zRqO9.js";import{I as Ae}from"./icon-button-Tmc0BC1V.js";import{b as He}from"./icon-tcOP_kzz.js";import{f as H}from"./forward-ref-6T0UNPU-.js";import{A as Ve}from"./alpha-slider-Y8d8NcHZ.js";import{H as je}from"./hue-slider-oIi5kbLL.js";import{C as ue}from"./color-swatch-jZ07Y2JY.js";import{I as Le}from"./input--uIOUTpt.js";import{S as Be}from"./saturation-slider-rDYPQ5D2.js";import{u as Fe}from"./use-component-style-Ji6G5y4B.js";const We=()=>{const[r,i]=f.useState(!1);_e(()=>{i(typeof window<"u"&&"EyeDropper"in window)},[]);const n=f.useCallback((l={})=>r?new window.EyeDropper().open(l):Promise.resolve(void 0),[r]);return{supported:r,onOpen:n}},le=(r,i)=>{let[n,l,c,u]=Ne(r,i)??[0,0,1,1];return u>1&&(u=1),{h:n,s:l,l:c,a:u}},ce=(r,i)=>{let[n,l,c,u]=Me(r,i)??[255,255,255,1];return n>255&&(n=255),l>255&&(l=255),c>255&&(c=255),u>1&&(u=1),{r:n,g:l,b:c,a:u}},oe=(r,i)=>{const[n,l,c,u]=Te(r,i);return{h:n,s:l,v:c,a:u}},[Ie,B]=be({name:"ColorSelectorContext",errorMessage:`useColorSelectorContext returned is 'undefined'. Seems you forgot to wrap the components in "<ColorSelector />"`}),$e=({isInvalid:r,...i})=>{let{id:n,name:l,value:c,defaultValue:u,fallbackValue:o,onChange:C,onChangeStart:S,onChangeEnd:v,format:g,required:p,disabled:a,readOnly:d,onSwatchClick:R,...F}=xe({isInvalid:r,...i});const z=se(S),G=se(v),{supported:Z,onOpen:q}=We(),[_,Q]=Se({value:c,defaultValue:u??o??"#ffffff",onChange:C}),W=f.useRef(void 0),b=f.useRef(g??Ee(_)),I=f.useRef(!1),[T,$]=f.useState(oe(_,o)),{h:k,s:D,v:N,a:O}=T,V=b.current.endsWith("a"),J=!(a||d),K=f.useMemo(()=>{if(_.startsWith("hsl")){const{h:e,s,l:t,a:m}=le(_,o);let y=[{label:"H",space:"h",value:Math.round(e),min:0,max:360},{label:"S(%)",space:"s",value:Math.round(s*100),min:0,max:100},{label:"L(%)",space:"l",value:Math.round(t*100),min:0,max:100}];return V&&(y=[...y,{label:"A(%)",space:"a",value:Math.round(m*100),min:0,max:100}]),y}else{const{r:e,g:s,b:t,a:m}=ce(_,o);let y=[{label:"R",space:"r",value:Math.round(e),min:0,max:255},{label:"G",space:"g",value:Math.round(s),min:0,max:255},{label:"B",space:"b",value:Math.round(t),min:0,max:255}];return V&&(y=[...y,{label:"A(%)",space:"a",value:Math.round(m*100),min:0,max:100}]),y}},[_,V,o]),P=f.useCallback(e=>{ne(e)?$(oe(e,o)):$(s=>({...s,...e}))},[o]),j=f.useCallback(e=>{window.clearTimeout(W.current),I.current=!0;const{h:s,s:t,v:m,a:y}={...T,...e},M=U([s,t,m,y],o)(b.current);M&&z(M)},[b,z,o,T]),w=f.useCallback(e=>{window.clearTimeout(W.current),W.current=window.setTimeout(()=>{I.current=!1},200);let s;if(ne(e))s=ae(e,o)(b.current);else{const{h:t,s:m,v:y,a:M}={...T,...e};s=U([t,m,y,M],o)(b.current)}s&&G(s)},[b,G,o,T]),re=f.useCallback((e,s)=>{let t=Math.floor(parseFloat(e.target.value));isNaN(t)&&(t=0),["s","l","a"].includes(s)&&(t=t/100);let m;if(_.startsWith("hsl")){const{h:y,s:M,l:X,a:Y}=Object.assign(le(_,o),{[s]:t});m=De([y,M,X,Y],o)(b.current)}else{const{r:y,g:M,b:X,a:Y}=Object.assign(ce(_,o),{[s]:t});m=Re([y,M,X,Y],o)(b.current)}m&&(P(m),w(m))},[_,P,w,b,o]),te=f.useCallback(async()=>{try{const{sRGBHex:e}=await q()??{};if(!e)return;P(e),w(e)}catch{}},[q,P,w]);ee(()=>{const e=U([k,D,N,O],o)(b.current);e&&Q(e)},[k,D,N,O,o]),ee(()=>{I.current||c&&$(oe(c,o))},[c]),ee(()=>{if(!g)return;b.current=g;const e=ae(_,o)(g);e&&Q(e)},[g,o]);const ie=(e={},s=null)=>({...e,ref:s,...ve(F,["aria-readonly"])}),he=f.useCallback((e={},s=null)=>({...ye(F,ke),...e,id:n,ref:s,type:"hidden",name:l,value:_,required:p,disabled:a,readOnly:d}),[a,n,l,d,p,F,_]),pe=f.useCallback((e={},s=null)=>({required:p,disabled:a,readOnly:d,isInvalid:r,...e,ref:s,value:[k,D,N],onChange:x(e.onChange,([,t,m])=>P({s:t,v:m})),onChangeStart:x(e.onChangeStart,([,t,m])=>j({s:t,v:m})),onChangeEnd:x(e.onChangeEnd,([,t,m])=>w({s:t,v:m}))}),[p,a,d,r,k,D,N,P,j,w]),de=f.useCallback((e={},s=null)=>({required:p,disabled:a,readOnly:d,isInvalid:r,...e,ref:s,value:k,onChange:x(e.onChange,t=>P({h:t})),onChangeStart:x(e.onChangeStart,t=>j({h:t})),onChangeEnd:x(e.onChangeEnd,t=>w({h:t}))}),[p,a,d,r,k,P,j,w]),me=f.useCallback((e={},s=null)=>({required:p,disabled:a,readOnly:d,isInvalid:r,...e,ref:s,value:O,color:U([k,D,N,O],o)(b.current),onChange:x(e.onChange,t=>P({a:t})),onChangeStart:x(e.onChangeStart,t=>j({a:t})),onChangeEnd:x(e.onChangeEnd,t=>w({a:t}))}),[o,p,a,d,r,b,k,D,N,O,P,j,w]),fe=f.useCallback(({space:e,...s},t=null)=>({required:p,disabled:a,readOnly:d,isInvalid:r,...s,ref:t,type:"number",step:1,onChange:x(s.onChange,m=>re(m,e))}),[p,a,d,r,re]),Ce=f.useCallback((e={},s=null)=>({disabled:a,"aria-label":"Pick a color",...e,ref:s,onClick:x(e.onClick,te)}),[a,te]),ge=f.useCallback(({color:e,...s}={},t=null)=>({"aria-label":`select ${e} as the color`,disabled:a,readOnly:d,...s,ref:t,color:e,onClick:x(s.onClick,()=>{e&&(R==null||R(e),P(e),w(e))})}),[a,d,R,P,w]);return{value:_,onChange:P,eyeDropperSupported:Z,withAlpha:V,isInteractive:J,disabled:a,readOnly:d,channels:K,getContainerProps:ie,getInputProps:he,getSaturationSliderProps:pe,getHueSliderProps:de,getAlphaSliderProps:me,getEyeDropperProps:Ce,getChannelProps:fe,getSwatchProps:ge}},ze=H(({className:r,...i},n)=>{const{getEyeDropperProps:l,readOnly:c,size:u,styles:o}=B(),C={h:"auto",minW:"auto",pointerEvents:c?"none":void 0,...o.eyeDropper};return h(Ae,{className:A("ui-color-selector__eye-dropper",r),variant:"outline",size:u,__css:C,...l(i,n),children:h(Ge,{className:"ui-color-selector__eye-dropper__icon"})})}),Ge=({...r})=>L(He,{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[h("path",{d:"m2 22 1-1h3l9-9"}),h("path",{d:"M3 21v-3l9-9"}),h("path",{d:"m15 6 3.4-3.4a2.1 2.1 0 1 1 3 3L18 9l.4.4a2.1 2.1 0 1 1-3 3l-3.8-3.8a2.1 2.1 0 1 1 3-3l.4.4Z"})]}),qe=H(({className:r,hueSliderRef:i,hueSliderProps:n,alphaSliderRef:l,alphaSliderProps:c,...u},o)=>{let{size:C,withAlpha:S,getHueSliderProps:v,getAlphaSliderProps:g,styles:p}=B();C==="full"&&(C="lg");const a={display:"flex",flexDirection:"column",...p.sliders};return L(E.div,{ref:o,className:A("ui-color-selector__sliders",r),__css:a,...u,children:[h(je,{size:C,className:"ui-color-selector__hue-slider",__css:{...p.hueSlider},...v(n,i)}),S?h(Ve,{size:C,className:"ui-color-selector__alpha-slider",__css:{...p.alphaSlider},...g(c,l)}):null]})}),Qe=H(({className:r,withEyeDropper:i=!0,withResult:n,eyeDropperRef:l,eyeDropperProps:c,hueSliderRef:u,hueSliderProps:o,alphaSliderRef:C,alphaSliderProps:S,...v},g)=>{const{value:p,eyeDropperSupported:a,styles:d}=B(),R={display:"flex",w:"full",...d.body};return L(E.div,{ref:g,className:A("ui-color-selector__body",r),__css:R,...v,children:[h(qe,{hueSliderRef:u,hueSliderProps:o,alphaSliderRef:C,alphaSliderProps:S}),i&&a?h(ze,{ref:l,...c}):null,n?h(ue,{className:"ui-color-selector__result",color:p,__css:{...d.result}}):null]})}),Ue=H(({className:r,channelProps:i,...n},l)=>{const{withAlpha:c,channels:u,getChannelProps:o,styles:C}=B(),S={display:"grid",gridTemplateColumns:`repeat(${c?"4":"3"}, 1fr)`,...C.channels};return h(E.div,{ref:l,className:A("ui-color-selector__channels",r),__css:S,...n,children:u.map(({label:v,space:g,value:p,min:a,max:d})=>h(Ze,{channelLabel:v,...o({...i,space:g,value:p,min:a,max:d})},v))})}),Ze=H(({className:r,channelLabel:i,...n},l)=>{const c=f.useId();let{size:u,disabled:o,readOnly:C,styles:S}=B();u==="full"&&(u="lg");const v={...S.channel};return L(E.div,{className:A("ui-color-selector__channel",r),children:[i?h(E.label,{htmlFor:c,style:{cursor:o?"not-allowed":void 0},__css:{display:"block",pointerEvents:C?"none":void 0,...S.channelLabel},children:i}):null,h(Le,{ref:l,id:c,size:u,__css:v,...n})]})}),Je=H(({className:r,swatchesLabel:i,swatches:n,swatchesContainerProps:l,swatchProps:c,swatchesColumns:u,...o},C)=>{const{getSwatchProps:S,readOnly:v,styles:g}=B(),p={display:"grid",gridTemplateColumns:Pe(u,a=>a!=null?`repeat(${a}, minmax(0, 1fr))`:void 0),...g.swatches};return n!=null&&n.length?L(E.div,{...l,children:[i?h(E.p,{className:"ui-color-selector__swatches__label",__css:{...g.swatchesLabel},children:i}):null,h(E.div,{ref:C,className:A("ui-color-selector__swatches",r),__css:p,...o,children:n.map(a=>h(ue,{as:"button",__css:{boxSize:"full",pointerEvents:v?"none":void 0,...g.swatch},...S({color:a,...c})},a))})]}):null}),po=H(({size:r,...i},n)=>{const[l,c]=Fe("ColorSelector",{size:r,...i}),{className:u,children:o,withResult:C=!0,withPicker:S=!0,withChannel:v=!0,swatches:g,swatchesColumns:p=7,inputProps:a,withEyeDropper:d,eyeDropperRef:R,eyeDropperProps:F,saturationSliderRef:z,saturationSliderProps:G,hueSliderRef:Z,hueSliderProps:q,alphaSliderRef:_,alphaSliderProps:Q,swatchesLabel:W,swatchProps:b,swatchesProps:I,channelsProps:T,channelProps:$,...k}=Oe(c),{value:D,getContainerProps:N,getInputProps:O,getSaturationSliderProps:V,...J}=$e(k),K={display:"flex",flexDirection:"column",...l.container};return h(Ie,{value:{styles:l,size:r,value:D,...J},children:L(E.div,{ref:n,className:A("ui-color-selector",u),__css:K,...N(),children:[h(E.input,{...O(a,n)}),S?h(Be,{size:r,className:"ui-color-selector__saturation-slider",__css:{...l.saturationSlider},...V(G,z)}):null,S?h(Qe,{withResult:C,withEyeDropper:d,eyeDropperRef:R,eyeDropperProps:F,hueSliderRef:Z,hueSliderProps:q,alphaSliderRef:_,alphaSliderProps:Q}):null,S&&v?h(Ue,{channelProps:$,...T}):null,h(Je,{swatchesLabel:W,swatches:g,swatchesColumns:p,swatchProps:b,...I}),we(o,{value:D})]})})});export{po as C,Ge as E,We as u};
