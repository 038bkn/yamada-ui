import{j as k}from"./jsx-runtime-Nms4Y4qS.js";import{u as Oe}from"./index-ysbLwl4-.js";import{r as n}from"./index-BwDkhjyp.js";import{c as we,a as Re}from"./icon-qNXYSgNB.js";import{f as X}from"./forward-ref-BmTAT9U5.js";import{l as Te,T as Ee,a1 as ye,a2 as Se,R as Ae,s as W,a9 as Ne,U as Le,q as He,f as Me,S as Be,a as ce,h as Q,d as ae,x as ke,aK as Ke,V as le,t as Ue,b as N,c as $,j as Ve}from"./factory-CZghEhwx.js";import{b as Ge}from"./popover-content-BLbldcgF.js";import{u as We}from"./index-CYOgy8MG.js";import{c as $e}from"./index-DE_xQ764.js";import{u as qe}from"./index-BRM0DfdX.js";import{u as ze}from"./index-BjTN0Jfs.js";import{u as Ye,f as Je}from"./form-control-C3CMmeFy.js";const Qe=t=>{var r;return Ke(t)&&!!((r=t==null?void 0:t.getAttribute("role"))!=null&&r.startsWith("option"))},{DescendantsContextProvider:ht,useDescendantsContext:Ie,useDescendants:Xe,useDescendant:Ze}=$e(),[gt,M]=Te({strict:!1,name:"SelectContext"}),vt=({placeholder:t,closeOnBlur:r=!0,closeOnEsc:o=!0,closeOnSelect:u=!0,placeholderInOptions:a=!0,omitSelectedValues:l=!1,maxSelectValues:d,isEmpty:b,placement:C="bottom-start",duration:_=.2,isOpen:y,defaultIsOpen:f,onOpen:O,onClose:F,optionProps:p,...i})=>{i=Ye(i);const{"aria-readonly":h,...w}=Ee(i,Je),[q,Z]=ye(Ae(i,["value","defaultValue","onChange","aria-readonly"]),Se),c=Xe(),[P,g]=n.useState(-1),[ee,B]=n.useState(!1),V=n.useRef(null),te=n.useRef(null),ie=n.useRef(null),L=n.useRef(new Set([])),[S,z]=We({value:i.value,defaultValue:i.defaultValue,onChange:i.onChange}),[D,G]=n.useState(void 0),K=P>-1,m=W(S),E=(m?!S.length:!S)&&!(t&&a),H=c.values(({node:e})=>m&&S.includes(e.dataset.value??"")).map(({index:e})=>e),A=c.enabledValues(({index:e})=>!H.includes(e)),se=n.useCallback(()=>{const e=setTimeout(()=>{const s=c.enabledFirstValue();if(s)if(!m||!l)g(s.index);else if(H.includes(s.index)){const v=A[0];g(v.index)}else g(s.index)});L.current.add(e)},[c,A,m,l,H]),ne=n.useCallback(()=>{const e=setTimeout(()=>{const s=c.enabledLastValue();if(s)if(!m||!l)g(s.index);else if(H.includes(s.index)){const v=A.reverse()[0];g(v.index)}else g(s.index)});L.current.add(e)},[c,A,m,l,H]),re=n.useCallback(()=>{const e=setTimeout(()=>{const v=c.enabledValues().find(({node:j})=>m?S.includes(j.dataset.value??""):j.dataset.value===S);v&&g(v.index)});L.current.add(e)},[c,m,S]),Y=n.useCallback(()=>{const e=setTimeout(()=>{const s=c.enabledNextValue(P);if(s)if(!m||!l)g(s.index);else if(H.includes(s.index)){const v=A.find(({index:j})=>s.index<j)??A[0];g(v.index)}else g(s.index)});L.current.add(e)},[c,A,P,m,l,H,g]),ue=n.useCallback(()=>{const e=setTimeout(()=>{const s=c.enabledPrevValue(P);if(s)if(!m||!l)g(s.index);else if(H.includes(s.index)){const v=A.reverse().find(({index:j})=>j<s.index)??A[0];g(v.index)}else g(s.index)});L.current.add(e)},[c,A,P,m,l,H,g]),U=E||l?se:re,be=E||l?ne:re,de=n.useCallback((e,s=!0)=>{const v=c.values();if(!v.length)return;const j=v.filter(({node:I})=>I.dataset.value===e).map(({node:I,index:J})=>{if(!(t&&a)||J!==0){const oe=Array.from(I.children).find(xe=>xe.getAttribute("data-label")!==null);return(oe==null?void 0:oe.innerHTML)??""}else return});G(I=>m?(j.forEach(J=>{W(I)&&I.includes(J??"")?s&&(I=W(I)?I.filter(xe=>xe!==J):void 0):I=[...W(I)?I:[],J]}),I):j[0])},[c,m,t,a]),fe=n.useCallback(e=>{z(s=>W(s)?s.includes(e)?s.filter(j=>j!==e):[...s,e]:e),de(e)},[de,z]),Pe=n.useCallback(e=>{e.stopPropagation(),z([]),G(void 0)},[G,z]),{isOpen:x,onOpen:Ce,onClose:R}=qe({isOpen:y,defaultIsOpen:f,onOpen:O,onClose:F}),T=n.useCallback(()=>{w.disabled||w.readOnly||b||ee||Ce()},[w,b,ee,Ce]),pe=n.useCallback(()=>{let e=c.value(P);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const s=e.node.dataset.value??"";fe(s),u&&R(),l&&Y()},[u,c,P,l,fe,R,Y]),he=n.useCallback(()=>{x||(T(),U())},[x,U,T]),ge=n.useCallback(()=>{x||(T(),U())},[x,U,T]),ve=n.useCallback(e=>{const s=Ne(e);Le(V.current,s)||r&&x&&R()},[r,x,R]),_e=n.useCallback(e=>{if(e.key===" "&&(e.key=e.code),w.disabled||w.readOnly)return;const v={ArrowDown:K?()=>Y():x?void 0:le(T,U),ArrowUp:K?()=>ue():x?void 0:le(T,be),Space:K?pe:x?void 0:le(T,U),Enter:K?pe:x?void 0:le(T,U),Home:x?se:void 0,End:x?ne:void 0,Escape:o?R:void 0}[e.key];v&&(e.preventDefault(),e.stopPropagation(),v())},[w.disabled,w.readOnly,K,x,T,U,be,pe,se,ne,o,R,Y,ue]);ze({ref:V,handler:R,enabled:x&&r}),n.useEffect(()=>{if(!m||!l&&He(d))return;const e=S.length>0&&S.length===c.count(),s=S.length===d;e||s?(R(),B(!0)):B(!1)},[l,S,c,m,R,d]),Me(()=>{x||g(-1)},[x]),Be(()=>{L.current.forEach(e=>clearTimeout(e)),L.current.clear()});const je=n.useCallback(e=>({matchWidth:!0,...i,...e,isOpen:x,onOpen:T,onClose:R,placement:C,duration:_,trigger:"never",closeOnButton:!1,closeOnBlur:r}),[_,r,R,T,C,i,x]),Fe=n.useCallback((e={},s=null)=>({ref:ce(V,s),...q,...e,...w,onClick:Q(e.onClick,i.onClick,he),onBlur:Q(e.onBlur,i.onBlur,ve)}),[q,w,ve,he,i]),De=n.useCallback(({"aria-label":e,...s}={},v=null)=>{var j,I;return e??(e=t??`Select ${m?"one or more options.":"an option."}`),{"aria-label":e,role:"combobox",ref:ce(te,v),tabIndex:0,...Z,...s,"data-active":ae(x),"data-placeholder":ae(m?!(D!=null&&D.length):D===void 0),"aria-controls":(j=ie.current)==null?void 0:j.id,"aria-activedescendant":(I=c.value(P))==null?void 0:I.node.id,"aria-expanded":x,onFocus:Q(s.onFocus,i.onFocus,ge),onKeyDown:Q(s.onKeyDown,i.onKeyDown,_e)}},[c,Z,P,x,m,D,t,i,ge,_e]);return{descendants:c,value:S,label:D,focusedIndex:P,placeholder:t,placeholderInOptions:a,omitSelectedValues:l,closeOnSelect:u,isOpen:x,containerRef:V,fieldRef:te,listRef:ie,optionProps:p,formControlProps:w,onChangeLabel:de,onChange:fe,onClear:Pe,onOpen:T,onClose:R,onFocusFirst:se,onFocusLast:ne,onFocusSelected:re,onFocusNext:Y,onFocusPrev:ue,setFocusedIndex:g,getPopoverProps:je,getContainerProps:Fe,getFieldProps:De}},et=()=>{const{listRef:t,focusedIndex:r}=M(),o=Ie(),u=n.useRef(-1),a=o.value(r);n.useEffect(()=>{if(!t.current||!a||u.current===a.index)return;const b=t.current,C=a.node,_=b.clientHeight,y=b.scrollTop,f=y+_,O=C.clientHeight,F=C.offsetTop,p=F+O,i=y<=F&&p<=f,h=u.current<a.index;i||(p<=_?t.current.scrollTo({top:0}):h?t.current.scrollTo({top:p-_}):t.current.scrollTo({top:F+1})),u.current=a.index},[t,a]);const l=n.useId();return{getListProps:n.useCallback((b={},C=null)=>({id:l,ref:ce(t,C),role:"listbox",tabIndex:-1,position:"relative",...b}),[l,t])}},tt=({label:t,...r})=>{const{value:o,omitSelectedValues:u}=M(),a=W(o),l=Ie(),d=l.values(),C=(a&&u?l.values(({node:p})=>o.includes(p.dataset.value??"")):[]).map(({index:p})=>p),y=!d.filter(({node:p,index:i})=>{var h;return((h=p.parentElement)==null?void 0:h.dataset.label)===t&&!C.includes(i)}).length,f=ye(r,Se),O=n.useCallback((p={},i=null)=>{const h={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};return{ref:i,...p,...f[0],style:y?h:void 0}},[f,y]),F=n.useCallback(({"aria-label":p,...i}={},h=null)=>(p??(p=t),{"aria-label":p,ref:h,role:"group",...i,...f[1],"data-label":t}),[f,t]);return{label:t,getContainerProps:O,getGroupProps:F}},st=(t,r)=>{const{fieldRef:o,value:u,placeholder:a,placeholderInOptions:l,omitSelectedValues:d,closeOnSelect:b,focusedIndex:C,optionProps:_,onChange:y,onChangeLabel:f,onFocusNext:O,onClose:F,setFocusedIndex:p}=M();let{icon:i,isDisabled:h,isFocusable:w,closeOnSelect:q,children:Z,value:c,...P}={..._,...r};const g=!!h&&!w,ee=n.useRef(null),{index:B,register:V,descendants:te}=Ze({disabled:g}),L=te.values().slice(0,B),S=W(u),D=!(S?!1:L.some(({node:E})=>E.dataset.value===(c??"")))&&(S?u.includes(c??""):(c??"")===u),G=B===C;a&&B>0&&l&&!c&&console.warn(`${S?"MultiSelect":"Select"}: If placeholders are present, All options must be set value. If want to set an empty value, either don't set the placeholder or set 'placeholderInOptions' to false.`);const K=n.useCallback(E=>{if(E.preventDefault(),E.stopPropagation(),h){o.current&&o.current.focus();return}if(!Qe(E.currentTarget)){o.current&&o.current.focus();return}p(B),y(c??""),o.current&&o.current.focus(),(q??b)&&F(),d&&O()},[h,p,B,y,c,o,q,b,F,d,O]);n.useEffect(()=>{D&&f(c??"",!1)},[c,D,f]);const m=n.useCallback((E={})=>{const me={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};return{role:"option",ref:ce(ee,t,V),...P,...E,tabIndex:-1,style:d&&D?me:void 0,"data-value":c??"","data-focus":ae(G),"data-disabled":ae(h),"aria-checked":ke(D),"aria-disabled":ke(h),onClick:Q(P.onClick,E.onClick,K)}},[c,P,h,G,D,d,K,t,V]);return{isSelected:D,isFocused:G,customIcon:i,children:Z,getOptionProps:m}},nt=X(({className:t,children:r,__css:o,...u},a)=>{const{styles:l}=M(),d={position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",cursor:"pointer",...l.icon,...o},C=Ue(r).map(_=>n.cloneElement(_,{focusable:!1,"aria-hidden":!0,style:{maxWidth:"1em",maxHeight:"1em",color:"currentColor"}}));return k.jsx(N.div,{ref:a,className:$("ui-select__icon",t),__css:d,...u,children:Ve(r)?C:k.jsx(we,{})})}),_t=({className:t,children:r,...o})=>{const u=n.useRef(null),{styles:a}=M(),l=o.disabled,d=Oe({ref:u,isDisabled:l,...o});return k.jsx(nt,{"aria-label":"Clear value",className:$("ui-select__clear-icon",t),__css:a.clearIcon,...d,children:r??k.jsx(Re,{w:"0.5em",h:"0.5em"})})},kt=X(({className:t,w:r,width:o,minW:u,minWidth:a,contentProps:l,header:d,footer:b,children:C,..._},y)=>{var F,p,i,h;const{styles:f}=M(),{getListProps:O}=et();return o??(o=r),o??(o=((F=f.list)==null?void 0:F.width)??((p=f.list)==null?void 0:p.w)),a??(a=u),a??(a=((i=f.list)==null?void 0:i.minWidth)??((h=f.list)==null?void 0:h.minW)),k.jsxs(Ge,{as:"div",className:"ui-select__content",width:o,minWidth:a,__css:{...f.content,width:o,minWidth:a},...l,children:[d?k.jsx(N.div,{className:"ui-select__header",__css:{...f.header},children:d}):null,k.jsx(N.ul,{className:$("ui-select__list",t),__css:{...f.list},...O(_,y),children:C}),b?k.jsx(N.div,{className:"ui-select__footer",__css:{...f.footer},children:b}):null]})}),yt=X(({className:t,color:r,h:o,height:u,minH:a,minHeight:l,children:d,...b},C)=>{const{styles:_}=M(),{label:y,getContainerProps:f,getGroupProps:O}=tt(b);return o??(o=u),a??(a=l),k.jsxs(N.li,{className:$("ui-select__item","ui-select__item--group",t),__css:{w:"100%",h:"fit-content",color:r},...f(),children:[k.jsx(N.span,{className:"ui-select__item__group-label",__css:_.groupLabel,lineClamp:1,children:y}),k.jsx(N.ul,{...O({},C),className:"ui-select__item__group",__css:{h:o,minH:a,..._.group},children:d})]})}),St=X(({id:t,className:r,icon:o,...u},a)=>{const{styles:l}=M(),{isSelected:d,customIcon:b,children:C,getOptionProps:_}=st(a,u);t??(t=n.useId()),o??(o=b);const y={textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,gap:"0.75rem",...l.item};return k.jsxs(N.li,{id:t,className:$("ui-select__item",r),__css:y,..._(),children:[o!==null?k.jsx(ot,{opacity:d?1:0,children:o||k.jsx(lt,{})}):null,k.jsx(N.span,{style:{flex:1},"data-label":!0,children:C})]})}),ot=X(({className:t,...r},o)=>{const{styles:u}=M(),a={flexShrink:0,display:"inline-flex",justifyContent:"center",alignItems:"center",fontSize:"0.85em",...u.itemIcon};return k.jsx(N.span,{ref:o,className:$("ui-select__item__icon",t),__css:a,...r})}),lt=()=>k.jsx("svg",{viewBox:"0 0 14 14",width:"1em",height:"1em",children:k.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})});export{St as O,ht as S,yt as a,gt as b,nt as c,kt as d,M as e,_t as f,vt as u};
