import{r as l}from"./index-BwDkhjyp.js";import{j as y}from"./jsx-runtime-Nms4Y4qS.js";import{b as se}from"./index-h-jaBLlY.js";import{u as ie,a as ue}from"./index-L9vzVe9v.js";import{u as le,a as ce,b as ae}from"./index-saVY_WUS.js";import{u as fe,p as me}from"./index-sUCUwg6n.js";import{l as pe,a as Y,h as u,B as de,a9 as j,U as R,c as W,t as ve,w as ge,b as Pe,V as Ce}from"./factory-CUXX-tpD.js";import{a as he}from"./use-component-style-D81cq1tY.js";import{o as ye}from"./theme-provider-C2d9AdUa.js";import{m as Be,M as xe}from"./motion-C3RdzhNH.js";import{s as A}from"./slide-fade-DeVOIWwT.js";import{s as be}from"./scale-fade-B6OBiK2G.js";import{C as Re}from"./close-button-BnfcvOVP.js";import{f as Te}from"./forward-ref-BmTAT9U5.js";const Ye=[...me,"isOpen","defaultIsOpen","onOpen","onClose","initialFocusRef","restoreFocus","autoFocus","closeOnBlur","closeOnEsc","closeOnButton","trigger","openDelay","closeDelay","isLazy","lazyBehavior","animation","duration"],[Oe,N]=pe({strict:!1,name:"PopoverContext"}),Ne=f=>{const[a,r]=he("Popover",f),{children:T,initialFocusRef:m,restoreFocus:O=!0,autoFocus:g=!0,closeOnBlur:p=!0,closeOnEsc:B=!0,closeOnButton:_=!0,trigger:c="click",openDelay:E=200,closeDelay:P=200,isLazy:L,lazyBehavior:V="unmount",animation:z="scale",duration:S,relatedRef:v,...I}=ye(r),{isOpen:t,onOpen:x,onClose:s,onToggle:k}=ie(r),D=l.useRef(null),b=l.useRef(null),e=l.useRef(null),{present:K,onAnimationComplete:Z}=se({isOpen:t,ref:e}),C=l.useRef(void 0),X=l.useRef(void 0),F=l.useRef(!1),H=l.useRef(!1);t&&(H.current=!0);const{referenceRef:M,getPopperProps:$,forceUpdate:U,transformOrigin:q}=fe({...I,enabled:t});l.useEffect(()=>()=>{C.current&&clearTimeout(C.current),X.current&&clearTimeout(X.current)},[]),le({enabled:t,ref:b}),ce(e,{focusRef:b,visible:t,shouldFocus:O&&(c==="click"||c==="contextmenu")}),ae(e,{focusRef:m,visible:t,shouldFocus:g&&(c==="click"||c==="contextmenu")});const G=ue({wasSelected:H.current,enabled:L,mode:V,isSelected:K}),ee=l.useCallback((o={},w=null)=>{const i={...o,style:{...o.style,transformOrigin:q},ref:Y(e,w),children:G?o.children:null,tabIndex:-1,onKeyDown:u(o.onKeyDown,n=>{B&&n.key==="Escape"&&s()}),onBlur:u(o.onBlur,n=>{const d=j(n),h=R(e.current,d),ne=R(b.current,d),re=v!=null&&v.current?R(v.current,d):!1;t&&p&&(!h&&!ne&&!re)&&s()})};return c==="hover"&&(i.onMouseEnter=u(o.onMouseEnter,()=>{F.current=!0}),i.onMouseLeave=u(o.onMouseLeave,n=>{n.nativeEvent.relatedTarget!==null&&(F.current=!1,p&&setTimeout(s,P))})),i},[P,p,B,t,s,G,q,c,v]),J=l.useCallback(o=>{D.current==null&&M(o)},[M]),oe=l.useCallback((o={},w=null)=>{const i={...o,ref:Y(b,w,J)};return c==="click"&&(i.onClick=u(o.onClick,k),i.onBlur=u(o.onBlur,n=>{const d=j(n),h=!R(e.current,d);t&&p&&h&&s()})),c==="contextmenu"&&(i.onContextMenu=u(o.onContextMenu,n=>{n.preventDefault(),x()}),i.onBlur=u(o.onBlur,n=>{const d=j(n),h=!R(e.current,d);t&&p&&h&&s()})),c==="hover"&&(i.onFocus=u(o.onFocus,()=>{C.current===void 0&&x()}),i.onBlur=u(o.onBlur,n=>{const d=j(n),h=!R(e.current,d);t&&p&&h&&s()}),i.onKeyDown=u(o.onKeyDown,n=>{n.key==="Escape"&&s()}),i.onMouseEnter=u(o.onMouseEnter,()=>{F.current=!0,C.current=window.setTimeout(x,E)}),i.onMouseLeave=u(o.onMouseLeave,()=>{F.current=!1,C.current&&(clearTimeout(C.current),C.current=void 0),X.current=window.setTimeout(()=>{F.current||s()},P)})),i},[P,p,t,J,s,x,k,E,c]),te=l.useCallback((o={},w=null)=>({...o,ref:Y(w,D,M)}),[D,M]);return y.jsx(Oe,{value:{isOpen:t,onClose:s,closeOnButton:_,onAnimationComplete:Z,forceUpdate:U,getTriggerProps:oe,getAnchorProps:te,getPopperProps:$,getPopoverProps:ee,animation:z,duration:S,styles:a},children:de(T,{isOpen:t,onClose:s,forceUpdate:U})})},He=({children:f})=>{const a=l.Children.only(f),{getTriggerProps:r}=N();return l.cloneElement(a,r(a.props,a.ref))},Q=Te(({onClick:f,...a},r)=>{const{styles:T,onClose:m}=N(),O={position:"absolute",...T.closeButton};return y.jsx(Re,{ref:r,className:W("ui-popover__close-button"),__css:O,onClick:u(f,g=>{g.stopPropagation(),m==null||m()}),size:"sm",...a})}),Fe=(f="scale",a)=>{const r={reverse:!0,duration:a,enter:{visibility:"visible"},transitionEnd:{exit:{visibility:"hidden"}}};switch(f){case"scale":return{...be,custom:{...r,scale:.95}};case"top":return{...A,custom:{...r,offsetX:0,offsetY:-16}};case"right":return{...A,custom:{...r,offsetX:16,offsetY:0}};case"left":return{...A,custom:{...r,offsetX:-16,offsetY:0}};case"bottom":return{...A,custom:{...r,offsetX:0,offsetY:16}}}},Ue=Be(({className:f,containerProps:a,children:r,w:T,width:m,minW:O,minWidth:g,z:p,zIndex:B,__css:_,...c},E)=>{const{isOpen:P,closeOnButton:L,getPopperProps:V,getPopoverProps:z,onAnimationComplete:S,animation:v,duration:I,styles:t}=N(),x=ve(r),[s,...k]=ge(x,Q),b={...c,children:y.jsxs(y.Fragment,{children:[s??(L?y.jsx(Q,{}):null),k]})},e=_??t.container??{},K={position:"relative",w:"100%",display:"flex",flexDirection:"column",outline:0,...e};return m??(m=T),m??(m=(e==null?void 0:e.width)??(e==null?void 0:e.w)),g??(g=O),g??(g=(e==null?void 0:e.minWidth)??(e==null?void 0:e.minW)),B??(B=p),B??(B=(e==null?void 0:e.zIndex)??(e==null?void 0:e.z)),y.jsx(Pe.div,{...V({style:{visibility:P?"visible":"hidden"}}),className:"ui-popover",width:m,minWidth:g,zIndex:B,...a,children:y.jsx(xe,{as:"section",className:W("ui-popover__content",f),...v!=="none"?Fe(v,I):{},...z(b,E),initial:"exit",animate:P?"enter":"exit",exit:"exit",onAnimationComplete:Ce(S,c.onAnimationComplete),__css:K})})});export{Ne as P,He as a,Ue as b,Q as c,Ye as p,N as u};
