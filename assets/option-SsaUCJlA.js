import{j as I}from"./jsx-runtime-Nms4Y4qS.js";import{u as De}from"./index-DCjskD-V.js";import{r as n}from"./index-BwDkhjyp.js";import{c as Oe,a as Re}from"./icon-BiToCgiA.js";import{f as X}from"./forward-ref-BmTAT9U5.js";import{l as Te,T as Ee,a0 as ye,a1 as Se,R as Ae,s as K,ad as Le,U as Ne,q as He,f as Me,S as Be,a as ce,h as Q,d as ae,x as ke,ah as Ue,V as le,t as Ve,b as W,c as $,j as Ge}from"./factory-CSM9sPSx.js";import{b as Ke}from"./popover-content-DFdHmdvF.js";import{u as We}from"./index-DtwaELu4.js";import{c as $e}from"./index-DCuOK1Fs.js";import{u as qe}from"./index-CvfKnqoV.js";import{u as ze}from"./index-D5mciU3Y.js";import{u as Ye,f as Je}from"./form-control-Cp0a3Pr6.js";const Qe=t=>{var a;return Ue(t)&&!!((a=t==null?void 0:t.getAttribute("role"))!=null&&a.startsWith("option"))},{DescendantsContextProvider:ht,useDescendantsContext:Ie,useDescendants:Xe,useDescendant:Ze}=$e(),[gt,H]=Te({strict:!1,name:"SelectContext"}),vt=({placeholder:t,closeOnBlur:a=!0,closeOnEsc:c=!0,closeOnSelect:r=!0,placeholderInOptions:i=!0,omitSelectedValues:o=!1,maxSelectValues:p,isEmpty:d,placement:m="bottom-start",duration:g=.2,isOpen:v,defaultIsOpen:_,onOpen:j,onClose:w,optionProps:b,...u})=>{u=Ye(u);const{"aria-readonly":k,...O}=Ee(u,Je),[q,Z]=ye(Ae(u,["value","defaultValue","onChange","aria-readonly"]),Se),l=Xe(),[P,C]=n.useState(-1),[ee,M]=n.useState(!1),V=n.useRef(null),te=n.useRef(null),ie=n.useRef(null),L=n.useRef(new Set([])),[y,z]=We({value:u.value,defaultValue:u.defaultValue,onChange:u.onChange}),[D,G]=n.useState(void 0),B=P>-1,x=K(y),E=(x?!y.length:!y)&&!(t&&i),N=l.values(({node:e})=>x&&y.includes(e.dataset.value??"")).map(({index:e})=>e),A=l.enabledValues(({index:e})=>!N.includes(e)),se=n.useCallback(()=>{const e=setTimeout(()=>{const s=l.enabledFirstValue();if(s)if(!x||!o)C(s.index);else if(N.includes(s.index)){const h=A[0];C(h.index)}else C(s.index)});L.current.add(e)},[l,A,x,o,N]),ne=n.useCallback(()=>{const e=setTimeout(()=>{const s=l.enabledLastValue();if(s)if(!x||!o)C(s.index);else if(N.includes(s.index)){const h=A.reverse()[0];C(h.index)}else C(s.index)});L.current.add(e)},[l,A,x,o,N]),re=n.useCallback(()=>{const e=setTimeout(()=>{const h=l.enabledValues().find(({node:F})=>x?y.includes(F.dataset.value??""):F.dataset.value===y);h&&C(h.index)});L.current.add(e)},[l,x,y]),Y=n.useCallback(()=>{const e=setTimeout(()=>{const s=l.enabledNextValue(P);if(s)if(!x||!o)C(s.index);else if(N.includes(s.index)){const h=A.find(({index:F})=>s.index<F)??A[0];C(h.index)}else C(s.index)});L.current.add(e)},[l,A,P,x,o,N,C]),ue=n.useCallback(()=>{const e=setTimeout(()=>{const s=l.enabledPrevValue(P);if(s)if(!x||!o)C(s.index);else if(N.includes(s.index)){const h=A.reverse().find(({index:F})=>F<s.index)??A[0];C(h.index)}else C(s.index)});L.current.add(e)},[l,A,P,x,o,N,C]),U=E||o?se:re,be=E||o?ne:re,de=n.useCallback((e,s=!0)=>{const h=l.values();if(!h.length)return;const F=h.filter(({node:S})=>S.dataset.value===e).map(({node:S,index:J})=>{if(!(t&&i)||J!==0){const oe=Array.from(S.children).find(xe=>xe.getAttribute("data-label")!==null);return(oe==null?void 0:oe.innerHTML)??""}else return});G(S=>x?(F.forEach(J=>{K(S)&&S.includes(J??"")?s&&(S=K(S)?S.filter(xe=>xe!==J):void 0):S=[...K(S)?S:[],J]}),S):F[0])},[l,x,t,i]),fe=n.useCallback(e=>{z(s=>K(s)?s.includes(e)?s.filter(F=>F!==e):[...s,e]:e),de(e)},[de,z]),Pe=n.useCallback(e=>{e.stopPropagation(),z([]),G(void 0)},[G,z]),{isOpen:f,onOpen:Ce,onClose:R}=qe({isOpen:v,defaultIsOpen:_,onOpen:j,onClose:w}),T=n.useCallback(()=>{O.disabled||O.readOnly||d||ee||Ce()},[O,d,ee,Ce]),pe=n.useCallback(()=>{let e=l.value(P);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const s=e.node.dataset.value??"";fe(s),r&&R(),o&&Y()},[r,l,P,o,fe,R,Y]),he=n.useCallback(()=>{f||(T(),U())},[f,U,T]),ge=n.useCallback(()=>{f||(T(),U())},[f,U,T]),ve=n.useCallback(e=>{const s=Le(e);Ne(V.current,s)||a&&f&&R()},[a,f,R]),_e=n.useCallback(e=>{if(e.key===" "&&(e.key=e.code),O.disabled||O.readOnly)return;const h={ArrowDown:B?()=>Y():f?void 0:le(T,U),ArrowUp:B?()=>ue():f?void 0:le(T,be),Space:B?pe:f?void 0:le(T,U),Enter:B?pe:f?void 0:le(T,U),Home:f?se:void 0,End:f?ne:void 0,Escape:c?R:void 0}[e.key];h&&(e.preventDefault(),e.stopPropagation(),h())},[O.disabled,O.readOnly,B,f,T,U,be,pe,se,ne,c,R,Y,ue]);ze({ref:V,handler:R,enabled:f&&a}),n.useEffect(()=>{if(!x||!o&&He(p))return;const e=y.length>0&&y.length===l.count(),s=y.length===p;e||s?(R(),M(!0)):M(!1)},[o,y,l,x,R,p]),Me(()=>{f||C(-1)},[f]),Be(()=>{L.current.forEach(e=>clearTimeout(e)),L.current.clear()});const Fe=n.useCallback(e=>({matchWidth:!0,...u,...e,isOpen:f,onOpen:T,onClose:R,placement:m,duration:g,trigger:"never",closeOnButton:!1,closeOnBlur:a}),[g,a,R,T,m,u,f]),je=n.useCallback((e={},s=null)=>({ref:ce(V,s),...q,...e,...O,onClick:Q(e.onClick,u.onClick,he),onBlur:Q(e.onBlur,u.onBlur,ve)}),[q,O,ve,he,u]),we=n.useCallback(({"aria-label":e,...s}={},h=null)=>{var F,S;return e??(e=t??`Select ${x?"one or more options.":"an option."}`),{"aria-label":e,role:"combobox",ref:ce(te,h),tabIndex:0,...Z,...s,"data-active":ae(f),"data-placeholder":ae(x?!(D!=null&&D.length):D===void 0),"aria-controls":(F=ie.current)==null?void 0:F.id,"aria-activedescendant":(S=l.value(P))==null?void 0:S.node.id,"aria-expanded":f,onFocus:Q(s.onFocus,u.onFocus,ge),onKeyDown:Q(s.onKeyDown,u.onKeyDown,_e)}},[l,Z,P,f,x,D,t,u,ge,_e]);return{descendants:l,value:y,label:D,focusedIndex:P,placeholder:t,placeholderInOptions:i,omitSelectedValues:o,closeOnSelect:r,isOpen:f,containerRef:V,fieldRef:te,listRef:ie,optionProps:b,formControlProps:O,onChangeLabel:de,onChange:fe,onClear:Pe,onOpen:T,onClose:R,onFocusFirst:se,onFocusLast:ne,onFocusSelected:re,onFocusNext:Y,onFocusPrev:ue,setFocusedIndex:C,getPopoverProps:Fe,getContainerProps:je,getFieldProps:we}},et=()=>{const{listRef:t,focusedIndex:a}=H(),c=Ie(),r=n.useRef(-1),i=c.value(a);n.useEffect(()=>{if(!t.current||!i||r.current===i.index)return;const d=t.current,m=i.node,g=d.clientHeight,v=d.scrollTop,_=v+g,j=m.clientHeight,w=m.offsetTop,b=w+j,u=v<=w&&b<=_,k=r.current<i.index;u||(b<=g?t.current.scrollTo({top:0}):k?t.current.scrollTo({top:b-g}):t.current.scrollTo({top:w+1})),r.current=i.index},[t,i]);const o=n.useId();return{getListProps:n.useCallback((d={},m=null)=>({id:o,as:"ul",ref:ce(t,m),role:"listbox",tabIndex:-1,...d}),[o,t])}},tt=({label:t,...a})=>{const{value:c,omitSelectedValues:r}=H(),i=K(c),o=Ie(),p=o.values(),m=(i&&r?o.values(({node:b})=>c.includes(b.dataset.value??"")):[]).map(({index:b})=>b),v=!p.filter(({node:b,index:u})=>{var k;return((k=b.parentElement)==null?void 0:k.dataset.label)===t&&!m.includes(u)}).length,_=ye(a,Se),j=n.useCallback((b={},u=null)=>{const k={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};return{ref:u,...b,..._[0],style:v?k:void 0}},[_,v]),w=n.useCallback(({"aria-label":b,...u}={},k=null)=>(b??(b=t),{"aria-label":b,ref:k,role:"group",...u,..._[1],"data-label":t}),[_,t]);return{label:t,getContainerProps:j,getGroupProps:w}},st=(t,a)=>{const{fieldRef:c,value:r,placeholder:i,placeholderInOptions:o,omitSelectedValues:p,closeOnSelect:d,focusedIndex:m,optionProps:g,onChange:v,onChangeLabel:_,onFocusNext:j,onClose:w,setFocusedIndex:b}=H();let{icon:u,isDisabled:k,isFocusable:O,closeOnSelect:q,children:Z,value:l,...P}={...g,...a};const C=!!k&&!O,ee=n.useRef(null),{index:M,register:V,descendants:te}=Ze({disabled:C}),L=te.values().slice(0,M),y=K(r),D=!(y?!1:L.some(({node:E})=>E.dataset.value===(l??"")))&&(y?r.includes(l??""):(l??"")===r),G=M===m;i&&M>0&&o&&!l&&console.warn(`${y?"MultiSelect":"Select"}: If placeholders are present, All options must be set value. If want to set an empty value, either don't set the placeholder or set 'placeholderInOptions' to false.`);const B=n.useCallback(E=>{if(E.preventDefault(),E.stopPropagation(),k){c.current&&c.current.focus();return}if(!Qe(E.currentTarget)){c.current&&c.current.focus();return}b(M),v(l??""),c.current&&c.current.focus(),(q??d)&&w(),p&&j()},[k,b,M,v,l,c,q,d,w,p,j]);n.useEffect(()=>{D&&_(l??"",!1)},[l,D,_]);const x=n.useCallback((E={})=>{const me={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};return{role:"option",ref:ce(ee,t,V),...P,...E,tabIndex:-1,style:p&&D?me:void 0,"data-value":l??"","data-focus":ae(G),"data-disabled":ae(k),"aria-checked":ke(D),"aria-disabled":ke(k),onClick:Q(P.onClick,E.onClick,B)}},[l,P,k,G,D,p,B,t,V]);return{isSelected:D,isFocused:G,customIcon:u,children:Z,getOptionProps:x}},nt=X(({className:t,children:a,__css:c,...r},i)=>{const{styles:o}=H(),p={position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",cursor:"pointer",...o.icon,...c},m=Ve(a).map(g=>n.cloneElement(g,{focusable:!1,"aria-hidden":!0,style:{maxWidth:"1em",maxHeight:"1em",color:"currentColor"}}));return I.jsx(W.div,{ref:i,className:$("ui-select__icon",t),__css:p,...r,children:Ge(a)?m:I.jsx(Oe,{})})}),_t=({className:t,children:a,...c})=>{const r=n.useRef(null),{styles:i}=H(),o=c.disabled,p=De({ref:r,isDisabled:o,...c});return I.jsx(nt,{"aria-label":"Clear value",className:$("ui-select__clear-icon",t),__css:i.clearIcon,...p,children:a??I.jsx(Re,{w:"0.5em",h:"0.5em"})})},kt=X(({className:t,w:a,width:c,minW:r,minWidth:i,...o},p)=>{var v,_,j,w;const{styles:d}=H(),{getListProps:m}=et();a=a??c??((v=d.list)==null?void 0:v.w)??((_=d.list)==null?void 0:_.width),r=r??i??((j=d.list)==null?void 0:j.minW)??((w=d.list)==null?void 0:w.minWidth);const g={...d.list};return I.jsx(Ke,{className:$("ui-select__list",t),w:a,minW:r,__css:g,...m(o,p)})}),yt=X(({className:t,color:a,h:c,height:r,minH:i,minHeight:o,children:p,...d},m)=>{const{styles:g}=H(),{label:v,getContainerProps:_,getGroupProps:j}=tt(d);return c??(c=r),i??(i=o),I.jsxs(W.li,{className:$("ui-select__item","ui-select__item--group",t),__css:{w:"100%",h:"fit-content",color:a},..._(),children:[I.jsx(W.span,{className:"ui-select__item__group-label",__css:g.groupLabel,lineClamp:1,children:v}),I.jsx(W.ul,{...j({},m),className:"ui-select__item__group",__css:{h:c,minH:i,...g.group},children:p})]})}),St=X(({id:t,className:a,icon:c,...r},i)=>{const{styles:o}=H(),{isSelected:p,customIcon:d,children:m,getOptionProps:g}=st(i,r);t??(t=n.useId()),c??(c=d);const v={textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,gap:"0.75rem",...o.item};return I.jsxs(W.li,{id:t,className:$("ui-select__item",a),__css:v,...g(),children:[c!==null?I.jsx(ot,{opacity:p?1:0,children:c||I.jsx(lt,{})}):null,I.jsx(W.span,{style:{flex:1},"data-label":!0,children:m})]})}),ot=X(({className:t,...a},c)=>{const{styles:r}=H(),i={flexShrink:0,display:"inline-flex",justifyContent:"center",alignItems:"center",fontSize:"0.85em",...r.itemIcon};return I.jsx(W.span,{ref:c,className:$("ui-select__item__icon",t),__css:i,...a})}),lt=()=>I.jsx("svg",{viewBox:"0 0 14 14",width:"1em",height:"1em",children:I.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})});export{St as O,ht as S,yt as a,gt as b,nt as c,kt as d,H as e,_t as f,vt as u};
